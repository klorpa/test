

;====================
;条件
;====================
@PLAYABLE_COLOSSEUM_0
IF FLAG:DEBUG
	RESULTS = 戦闘テスト
	RETURN 1
ENDIF
RETURN 0


;====================
;内容
;====================
@COLOSSEUM_0

DRAWLINE
PRINTW 戦闘テストを行います
CALL BATTLETEST




@BATTLETEST
CALL SHOW_NOW_FORMATION_E,0,2
DRAWLINE
CALL SHOW_NOW_FORMATION_P,0,2
PRINTL 変更するキャラのポジションを選んでください
PRINTLC [99] 戦闘開始
PRINTLC [100] Return
PRINTLC [101] 固定配置
PRINTL 
$INPUT_LOOP
INPUT
IF RESULT <= 16 && RESULT > 0
	LOCAL = FLAG:(70 + RESULT)
	IF LOCAL >= 0
		CALL CHANGE_TESTCHARA_STATUS(LOCAL,RESULT)
		RESTART
	ELSE
		PRINTL このポジションは空です。配置するキャラを選んでください。
		CALL CHOICE_TESTCHARA(RESULT)
		RESTART
	ENDIF
ELSEIF RESULT == 99
	FLAG:デバッグ戦闘フラグ = 1
	CALL BATTLE_START
	FLAG:デバッグ戦闘フラグ = 0
	FOR LOCAL,0,CHARANUM
		CALL HEALTH_CHARA,LOCAL
	NEXT
	RESTART
ELSEIF RESULT == 100
	RETURN -1
ELSEIF RESULT == 101
	CALL SET_POS_TEST
	RESTART
ELSE
	GOTO INPUT_LOOP
ENDIF
@CHANGE_TESTCHARA_STATUS(ARG,ARG:1)
BASE:ARG:ＭＡＧ = 9999999
CFLAG:ARG:1 = 1
LOCAL:10 = 0
LOCAL:11 = 0
$START
U = ARG
PRINTFORML %NAME:U%　　%GET_ALI1(ABL:U:属性LD),7,LEFT%/%GET_ALI2(ABL:U:属性LC),7,LEFT%　　Loyalty:{BASE:U:忠誠度,6}　　ＭＡＧ:{BASE:U:ＭＡＧ,6}　　ＥＸＰ：{BASE:U:ＥＸＰ,8}/{MAXBASE:U:ＥＸＰ,8}
;1行目にレベル・属性を表示
PRINTFORM LV{MAXBASE:U:LV,3}({BASE:U:LV,3})　　　 
PRINTBUTTON "[↑]",30
PRINTBUTTON "[↓]",40
PRINTBUTTON "[↑↑]",50
PRINTBUTTON "[↓↓]",60
PRINTFORM 　　　
SIF ABL:U:種族 > 0 && ABL:U:種族 < 14
	PRINTFORM 　　ANALYZE: \@FLAG:(20000+NO:U) >= 1000 ? COMPLETE! # {FLAG:(20000+NO:U)/10}％ \@
PRINTL
;2行目にHP・忠誠度を表示
PRINTFORM ＨＰ[{BASE:U:ＨＰ,4}/{MAXBASE:U:ＨＰ,4}]　
PRINTBUTTON "[↑]",88
PRINTBUTTON "[↓]",89
PRINTBUTTON "[↑↑]",90
PRINTBUTTON "[↓↓]",91
PRINTBUTTON "[↑↑↑]",92
PRINTBUTTON "[↓↓↓]",93
PRINTL 
;3行目にＭＰ・ＥＸＰを表示
PRINTFORM ＭＰ[{BASE:U:ＭＰ,4}/
PRINTFORM {MAXBASE:U:ＭＰ,4}]　
PRINTBUTTON "[↑]",94
PRINTBUTTON "[↓]",95
PRINTBUTTON "[↑↑]",96
PRINTBUTTON "[↓↓]",97
PRINTBUTTON "[↑↑↑]",98
PRINTBUTTON "[↓↓↓]",110
PRINTL
;4行目に通常攻撃の性能を表示
PRINTBUTTON "Attack",82
PRINTFORM ：%GET_TYPE_E(ABL:U:攻撃相性),6,LEFT%　
PRINTFORM {ABL:U:最低攻撃回数,2}-

PRINTFORM {ABL:U:最大攻撃回数,2}
PRINT 回
PRINTBUTTON "[+]",83
PRINTBUTTON "[-]",84
PRINTBUTTON "[+]",85
PRINTBUTTON "[-]",86
PRINTBUTTON "[射程]",87
PRINTFORM 　{ABL:U:射程} 
PRINTBUTTON GET_SPHERE(ABL:U:攻撃範囲),500
IF ABL:U:追加効果 > 0
	PRINTFORML 　　　　追加効果：%GET_STATE(ABL:U:追加効果),6,LEFT%　追加効果相性：%GET_TYPE_E(ABL:U:追加効果相性)%
ENDIF

;Humanならばここに銃攻撃の性能と銃攻撃力・銃命中を2行つかって表示
IF EQUIP:U:銃 > 0
	DRAWLINE
	PRINTFORML Gun：攻撃力 {MAXBASE:U:銃攻撃,4} Hit {MAXBASE:U:銃命中}
	CALLFORM 最低攻撃回数_{EQUIP:U:銃}
	PRINTFORM 攻撃回数 {RESULT,2}-
	CALLFORM 最大攻撃回数_{EQUIP:U:銃}
	PRINTFORM {RESULT,2}
	CALLFORM 射程_{EQUIP:U:銃}
	PRINTFORM 　　Range：{RESULT,2}
	CALLFORM 攻撃範囲_{EQUIP:U:銃}
	PRINTFORM 　　%GET_SPHERE(RESULT),4,LEFT%
	PRINTL
ENDIF
IF ARG:1 > 6
	DRAWLINE
	PRINTFORM 強化ランク　　{CFLAG:ARG:強化ランク,4}　
	PRINTBUTTON "[↑]",70
	PRINTBUTTON "[↓]",71
	PRINTBUTTON "[↑↑]",72
	PRINTBUTTON "[↓↓]",73
	PRINTL
	PRINTFORM 速度補正　　　{CFLAG:ARG:速度補正,4}　
	PRINTBUTTON "[↑]",74
	PRINTBUTTON "[↓]",75
	PRINTBUTTON "[↑↑]",76
	PRINTBUTTON "[↓↓]",77
	PRINTL
	PRINTFORM 行動回数　　　{CFLAG:ARG:行動回数,4}　
	PRINTBUTTON "[↑]",80
	PRINTBUTTON "[↓]",81
	PRINTL
	PRINTFORM 思考パターン　%CSTR:ARG:思考パターン,4%　
	IF CSTR:ARG:思考パターン != ""
		PRINTBUTTON "[OFF]",78
	ELSE
		PRINTBUTTON "[ON ]",78
	ENDIF
	PRINT 　
	PRINTBUTTON "[指定]",79
ENDIF
DRAWLINE
;5〜10行目に基本能力値と戦闘能力値を表示
REPEAT 6
	PRINTFORM %GET_BASESTATUS_E(COUNT+1),4%{MAXBASE:U:(GET_BASESTATUS(COUNT+1)),4}({BASE:U:(GET_BASESTATUS(COUNT+1)),4})　
	PRINTBUTTON "[↑]",COUNT+31
	PRINTBUTTON "[↓]",COUNT+41
	PRINTBUTTON "[↑↑]",COUNT+51
	PRINTBUTTON "[↓↓]",COUNT+61
	PRINT 　
	PRINTFORM %GET_BATTLESTATUS_E(COUNT),8,LEFT% 
	PRINTFORM {MAXBASE:U:(GET_BATTLESTATUS(COUNT)),5}
	PRINTBUTTON "[↑]",250 + COUNT * 4
	PRINTBUTTON "[↓]",251 + COUNT * 4
	PRINTBUTTON "[↑↑]",252 + COUNT * 4
	PRINTBUTTON "[↓↓]",253 + COUNT * 4
	PRINTL 
REND
LOCAL = 0
FOR COUNT,31,37
	LOCAL += BASE:U:COUNT
NEXT
LOCAL:1 = 0
FOR COUNT,31,37
	LOCAL:1 += MAXBASE:U:COUNT
NEXT
PRINTFORML 基本能力合計値　{LOCAL,3}　　　基本能力合計基準値　{(BASE:U:30)/2+(BASE:U:30) + 18,3}±5　　　能力値合計　{LOCAL:1}
PRINTFORML ＬＶＵＰ回数　　{LOCAL:10,3}　　　能力ＵＰ回数　　　　{LOCAL:11,3}
DRAWLINE
;11、12行目に被攻撃相性と継承可能表示
FOR LOCAL,0,FLAG:相性数
		PRINTBUTTON BASENAME:(LOCAL+40),LOCAL + 200
		PRINTFORM  \@(MAXBASE:U:(GET_TYPE(LOCAL)) < 0) ? Dr # 　\@
		PRINTFORM \@ ((MAXBASE:U:(GET_TYPE(LOCAL)) != 999)) ? {ABS(MAXBASE:U:(GET_TYPE(LOCAL))),4}％ # %" " *2%Refl \@　
		;PRINTFORM {ABS(MAXBASE:U:(GET_TYPE(LOCAL)),4}％
	SIF LOCAL % 6 == 5
		PRINTL
NEXT
PRINTBUTTON "[ALL-COOPMOOD]",219
PRINTBUTTON "[相性リセット]",220
PRINTL 
DRAWLINE
IF TALENT:U:サマナー == 0
	FOR LOCAL,0,FLAG:スキル数
		LOCALS = スキル{LOCAL+1}
		IF ABL:U:LOCALS
			CALLFORM SKILL_NAME_{ABL:U:LOCALS},U
		ELSE
			RESULTS = EMPTY	
		ENDIF
		PRINTFORM 　[{LOCAL+1}]%RESULTS,20,LEFT%
		SIF LOCAL % 4 == 3
			PRINTL
	NEXT
DRAWLINE
ENDIF
IF ABL:U:種族 == 0 || ABL:U:種族 > 45
	FOR LOCAL,0,7
		PRINTFORM %"[" + GET_EQUIP_E(LOCAL) + "]",14,LEFT%
		IF (EQUIP:U:(GET_EQUIP(LOCAL))) == 0
			SETCOLOR 0x404040
			PRINTFORML [{LOCAL+10}]ＥＭＰＴＹ
			RESETCOLOR
		ELSE
			IF 魔晶装備(EQUIP:U:(GET_EQUIP(LOCAL)))
				PRINTFORML [{LOCAL+10}]%STR:(DC:(EQUIP:U:(GET_EQUIP(LOCAL)) - 2450 - LOCAL*450):49+100)%
			ELSE
				PRINTFORML [{LOCAL+10}]%ITEMNAME_E(EQUIP:U:(GET_EQUIP(LOCAL)))%
			ENDIF
		ENDIF
	NEXT
	DRAWLINE
ENDIF
IF ARG:1 < 7
	PRINTFORM Obedience Lv{ABL:ARG:従順,2}　
	PRINTBUTTON "[↑]",21
	PRINT 　
	PRINTBUTTON "[↓]",22
	PRINTFORM 　Technique Lv{ABL:ARG:技巧,2}　
	PRINTBUTTON "[↑]",23
	PRINT 　
	PRINTBUTTON "[↓]",24
	PRINTFORM 　Desire Lv{ABL:ARG:欲望,2}　
	PRINTBUTTON "[↑]",25
	PRINT 　
	PRINTBUTTON "[↓]",26
	PRINTL 
	LOCAL:12 = 0
	FOR COUNT,3,8
		SIF TALENT:U:COUNT
			LOCAL:12 += 1
	NEXT
	IF LOCAL:12
		PRINT 陥落　○　 
	ELSE 
		PRINT 陥落　×　 
	ENDIF
	IF LOCAL:12
		PRINTBUTTON  "[ON ]",27
	ELSE
		PRINTBUTTON  "[OFF]",27
	ENDIF
	PRINT 　　　 
	IF TALENT:U:妊娠
		PRINT Pregnant　○　 
	ELSE 
		PRINT Pregnant　×　 
	ENDIF
	IF TALENT:U:妊娠
		PRINTBUTTON "[ ON]",28
	ELSE 
		PRINTBUTTON "[OFF]",28
	ENDIF
	
	PRINTL 
DRAWLINE
ENDIF
PRINTL [99] ポジションをあける　　　　[100] Return
INPUT
IF RESULT >= 1 && RESULT <= 8
	IF TALENT:ARG:ペルソナ使い && RESULT == 1
		CALL CHANGE_PERSONA,ARG
	ELSE
		CALL CHOICE_TESTCHARA_SKILL,U,RESULT+59
	ENDIF
ELSEIF RESULT >= 10 && RESULT <= 16
	CALL CHOICE_TESTCHARA_EQUIP,ARG,RESULT
ELSEIF RESULT == 21
	ABL:ARG:従順 += 1
ELSEIF RESULT == 22
	ABL:ARG:従順 -= 1
ELSEIF RESULT == 23
	ABL:ARG:技巧 += 1
ELSEIF RESULT == 24
	ABL:ARG:技巧 -= 1
ELSEIF RESULT == 25
	ABL:ARG:欲望 += 1
ELSEIF RESULT == 26
	ABL:ARG:欲望 -= 1
ELSEIF RESULT == 27
	IF LOCAL:12
		FOR COUNT,3,8
			TALENT:U:COUNT = 0
		NEXT
	ELSE
		FOR COUNT,3,8
			TALENT:U:COUNT = 1
		NEXT
	ENDIF
ELSEIF RESULT == 28
	IF TALENT:U:妊娠
		TALENT:U:妊娠 = 0
	ELSE
		TALENT:U:妊娠 = 1
	ENDIF
ELSEIF RESULT >= 30 && RESULT <= 36
	BASE:U:(RESULT) += 1
	IF RESULT == 30
		LOCAL:10 += 1
	ELSE
		LOCAL:11 += 1
	ENDIF
ELSEIF RESULT >= 40 && RESULT <= 46
	BASE:U:(RESULT - 10)  -= 1
	IF RESULT == 40
		LOCAL:10 -= 1
	ELSE
		LOCAL:11 -= 1
	ENDIF
ELSEIF RESULT >= 50 && RESULT <= 56
	BASE:U:(RESULT - 20) += 10
	IF RESULT == 50
		LOCAL:10 += 10
	ELSE
		LOCAL:11 += 10
	ENDIF
ELSEIF RESULT >= 60 && RESULT <= 66
	BASE:U:(RESULT - 30)  -= 10
	IF RESULT == 60
		LOCAL:10 -= 10
	ELSE
		LOCAL:11 -= 10
	ENDIF
ELSEIF RESULT >= 70 && RESULT <= 73
	LOCAL = CFLAG:ARG:強化ランク
	IF RESULT == 70
		CFLAG:ARG:強化ランク += 1
	ELSEIF RESULT == 71
		CFLAG:ARG:強化ランク -= 1
	ELSEIF RESULT == 72
		CFLAG:ARG:強化ランク += 10
	ELSEIF RESULT == 73
		CFLAG:ARG:強化ランク -= 10
	ENDIF
	SIF CFLAG:ARG:強化ランク > 200
		CFLAG:ARG:強化ランク = 200
	SIF (LOCAL < 100 && CFLAG:ARG:強化ランク >= 100)
		CFLAG:ARG:強化ランク = 99
	SIF (LOCAL >= 100 && CFLAG:ARG:ボスフラグ == 0)
		CFLAG:ARG:強化ランク = 100
	SIF CFLAG:ARG:強化ランク < 0
		CFLAG:ARG:強化ランク = 0
	;ステータス強化、強化ランクフラグセット、ボスなら行動回数
	IF LOCAL < 100
		BASE:ARG:(GET_BASESTATUS(0)) -= LOCAL*3
		FOR LOCAL:1, 0, 6
					BASE:ARG:(GET_BASESTATUS(1+LOCAL:1)) -= LOCAL * 1
		NEXT
	ELSE
		BASE:ARG:GET_BASESTATUS(0) -= (LOCAL-100)*3
		FOR LOCAL:1, 0, 6
			BASE:ARG:(GET_BASESTATUS(1+LOCAL:1)) -= (LOCAL-100) *2
		NEXT
	ENDIF
	BASE:ARG:LV += CFLAG:ARG:強化ランク * 3
	CALL SYNC_STATUS,ARG
	;CALL ENHANCE_ENEMY,ARG,CFLAG:ARG:強化ランク
ELSEIF RESULT >= 74 && RESULT <= 77
	IF RESULT == 74
		CFLAG:U:速度補正 += 1
	ELSEIF RESULT == 75
		CFLAG:U:速度補正 -= 1
	ELSEIF RESULT == 76
		CFLAG:U:速度補正 += 10
	ELSE
		CFLAG:U:速度補正 -= 10
	ENDIF
ELSEIF RESULT == 78
	IF CSTR:ARG:思考パターン != ""
		CSTR:ARG:思考パターン = 
	ELSE
		CSTR:ARG:思考パターン = %CALLNAME:ARG%
	ENDIF
ELSEIF RESULT == 79
	PRINTL 思考パターンの文字列を入力してください
	INPUTS
	CSTR:ARG:思考パターン = %RESULTS%
ELSEIF RESULT >= 80 && RESULT <= 81
	IF RESULT == 80
		CFLAG:U:行動回数 += 1
	ELSEIF RESULT == 81
		CFLAG:U:行動回数 -= 1
	ENDIF
	SIF CFLAG:U:行動回数 == 0
		CFLAG:U:行動回数 = 1
ELSEIF RESULT == 82
	ABL:U:攻撃相性 += 1
	SIF ABL:U:攻撃相性 == 18
		ABL:U:攻撃相性 = 0
ELSEIF RESULT == 83
	ABL:U:最低攻撃回数 += 1
ELSEIF RESULT == 84
	ABL:U:最低攻撃回数 -= 1
	SIF ABL:U:最低攻撃回数 == 0
		ABL:U:最低攻撃回数 = 1
ELSEIF RESULT == 85
	ABL:U:最大攻撃回数 += 1
ELSEIF RESULT == 86
	ABL:U:最大攻撃回数 -= 1
	SIF ABL:U:最大攻撃回数 == 0
		ABL:U:最大攻撃回数 = 1
ELSEIF RESULT == 87
	ABL:U:射程 += 1
	SIF ABL:U:射程 == 6
		ABL:U:射程 = 1
ELSEIF RESULT >= 88 && RESULT <= 93
	 IF RESULT == 88
	 	CFLAG:U:ＨＰ補正 += 1
	 ELSEIF RESULT == 89
	 	CFLAG:U:ＨＰ補正 -= 1
	 ELSEIF RESULT == 90
	 	CFLAG:U:ＨＰ補正 += 10
	 ELSEIF RESULT == 91
	 	CFLAG:U:ＨＰ補正 -= 10
	 ELSEIF RESULT == 92
	 	CFLAG:U:ＨＰ補正 += 100
	 ELSEIF RESULT == 93
	 	CFLAG:U:ＨＰ補正 -= 100
	 ENDIF
ELSEIF (RESULT >= 94 && RESULT <= 98 ) || RESULT == 110
	 IF RESULT == 94
	 	CFLAG:U:ＭＰ補正 += 1
	 ELSEIF RESULT == 95
	 	CFLAG:U:ＭＰ補正 -= 1
	 ELSEIF RESULT == 96
	 	CFLAG:U:ＭＰ補正 += 10
	 ELSEIF RESULT == 97
	 	CFLAG:U:ＭＰ補正 -= 10
	 ELSEIF RESULT == 98
	 	CFLAG:U:ＭＰ補正 += 100
	 ELSE
	 	CFLAG:U:ＭＰ補正 -= 100
	 ENDIF
ELSEIF RESULT == 99
	CALL REMOVE_POSITION,ARG:1
	RETURN
ELSEIF RESULT == 100
	RETURN
ELSEIF RESULT >= 200 && RESULT <= 218
	LOCAL = RESULT - 200
	LOCAL:1 = RESULT - 160
	$AISYOU
	PRINTFORM %CALLNAME:ARG%の防御相性は
	PRINTFORM \@(MAXBASE:U:(GET_TYPE(LOCAL)) < 0) ? Dr # 　\@
	PRINTFORML \@ ((MAXBASE:U:(GET_TYPE(LOCAL)) != 999)) ? {ABS(MAXBASE:U:(GET_TYPE(LOCAL))),4}％ # %" " *2%Refl \@です
	PRINTL 直接入力あるいは以下のボタンをクリックしてください
	PRINTL なお、装備によって修正が加わる場合、ここでの変更より基本的に優先されます
	PRINTBUTTON "[無効]",0
	PRINTBUTTON "[反射]",999
	PRINTBUTTON "[吸収]",-100
	PRINTL
	PRINTBUTTON "[ +5]",2001
	PRINTBUTTON "[+10]",2002
	PRINTBUTTON "[100]",2003
	PRINTBUTTON "[ -5]",2004
	PRINTBUTTON "[-10]",2005
	PRINTL 
	PRINTBUTTON "[決定]",2000
	INPUT
	IF RESULT == 2000
		RETURN
	ELSEIF RESULT >= 2001 && RESULT <= 2005
		IF RESULT == 2001
			BASE:ARG:(LOCAL:1) += 5
			MAXBASE:ARG:(LOCAL:1) += 5
		ELSEIF RESULT == 2002
			BASE:ARG:(LOCAL:1) += 10
			MAXBASE:ARG:(LOCAL:1) += 10
		ELSEIF RESULT == 2003
			BASE:ARG:(LOCAL:1) = 100
			MAXBASE:ARG:(LOCAL:1) = 100
		ELSEIF RESULT == 2004
			BASE:ARG:(LOCAL:1) -= 5
			MAXBASE:ARG:(LOCAL:1) -= 5
		ELSE
			BASE:ARG:(LOCAL:1) -= 5
			MAXBASE:ARG:(LOCAL:1) -= 10
		ENDIF
		CALL SYNC_STATUS,U
		GOTO AISYOU
	ELSE
		BASE:ARG:(LOCAL:1) = RESULT
		MAXBASE:ARG:(LOCAL:1) = RESULT
	ENDIF
ELSEIF RESULT == 219
	REPEAT FLAG:相性数
		BASE:ARG:(COUNT+40) = 101
		MAXBASE:ARG:(COUNT+40) = 101
	REND
ELSEIF RESULT == 220
	REPEAT FLAG:相性数
		BASE:ARG:(COUNT+40) = CSVBASE(NO:ARG,COUNT+40,0)
		MAXBASE:ARG:(COUNT+40) = BASE:ARG:(COUNT+40)
	REND
ELSEIF RESULT >= 250 && RESULT <= 273
	RESULT -= 250
	LOCALS = %GET_BATTLESTATUS(RESULT/4)%補正
	SELECTCASE RESULT % 4
		CASE 0
			CFLAG:ARG:LOCALS += 1
		CASE 1
			CFLAG:ARG:LOCALS -= 1
		CASE 2
			CFLAG:ARG:LOCALS += 10
		CASE 3
			CFLAG:ARG:LOCALS -= 10
	ENDSELECT
ELSEIF RESULT == 500
	ABL:U:攻撃範囲 += 1
	SIF ABL:U:攻撃範囲 == 3 
		ABL:U:攻撃範囲 = 1
ENDIF
	CALL SYNC_STATUS,U
	CALL HEALTH_CHARA,U
	GOTO START
@CHOICE_TESTCHARA_SKILL(ARG,ARG:1)
PRINTL [ 0]Slash　　[ 1]Gun　　[ 2]Strke　　[ 3]Skill　　[ 4]回復　　
PRINTL [ 5]支援　　[ 6]Defense　　[ 7]Fire　　[ 8]Ice　　[ 9]Elect　　
PRINTL [10]Force　　[11]Nerve　　[12]Mind　　[13]Light　　[14]Dark　　
PRINTL [15]Earth　　[16]Water　　[17]Wind　　[18]Grav　　[19]Nuclr　　
PRINTL [20]Almig　　[24]Auto[97]LEARNI　　[98]EMPTY　 [99]Return
PRINTL 所持させるスキルの系統を選んでください
$INPUT_LOOP1
INPUT
IF RESULT == 97
	FOR COUNT,1,20
		SIF ABL:ARG:(COUNT+100) == 0
			BREAK
		CALLFORM SKILL_NAME_{ABL:ARG:(COUNT+100)}
		PRINTFORMLC [{COUNT}] %RESULTS%(Lv{ABL:ARG:(COUNT+120)})
		SIF COUNT % 4 == 0
			PRINTL 
	NEXT
	PRINTL [99] Return
	PRINTL 所持させるスキルを選んでください
	INPUT
	IF RESULT > 0 && RESULT < COUNT
		ABL:ARG:(ARG:1) = ABL:ARG:(RESULT+100)
	ELSEIF RESULT == 99
	ELSE
		$INPUT_LOOP2
	ENDIF
	RETURN 0
ELSEIF RESULT == 98
	ABL:ARG:(ARG:1) = 0
	RETURN 0
ENDIF
SIF RESULT == 99
	RETURN 0
SIF (RESULT < 0 || RESULT > 24 || RESULT ==21 || RESULT == 22 || RESULT == 23)
	GOTO INPUT_LOOP1

LOCAL = RESULT
LOCAL:1 = 0
LOCAL:2 = 0
FOR COUNT,RESULT*100+1,RESULT*100+100
	LOCAL:1 += 1
	TRYCCALLFORM SKILL_NAME_{COUNT}
		PRINTFORMLC [{LOCAL:1}] %RESULTS%
		SIF LOCAL:2 % 4 == 3
			PRINTL 
		LOCAL:2 += 1
	CATCH
	ENDCATCH
NEXT
$INPUT_LOOP3
PRINTL [99] Return
PRINTL 所持させるスキルを選んでください
INPUT
LOCAL = LOCAL*100 + RESULT
SIF RESULT == 99
	RETURN 0
TRYCCALLFORM SKILL_NAME_{LOCAL}
	ABL:ARG:(ARG:1) = LOCAL
CATCH
	GOTO INPUT_LOOP3
ENDCATCH
@CHOICE_TESTCHARA(ARG)
PRINTL [ 0]Lady　[ 1]Megami　　[ 2]Tyrant　　[ 3]Divine　　[ 4]Yoma　　
PRINTL [ 5]Fairy　　[ 6]Brute　　[ 7]Snake　　[ 8]Beast　　[ 9]Flight　　
PRINTL [10]Foul　　[11]Machine　[12]Element　　[14]Kishin　　[30]暴君　　
PRINTL [31]Kyojin　　[32]Rumor　　[36]天魔　　[37]超獣　　[38]戦士　　
PRINTL [41]Fiend　　[42]Meta　　[44]Zoma　　[45]Human　　[98]作成済み
PRINTL [99]Return
PRINTL 種族を選んでください
$INPUT_LOOP1
INPUT
SIF RESULT == 99
	RETURN 0
IF RESULT == 98
	CALL INPUT_CHARA_LIST("配置するキャラを選んでください")
	IF RESULT == 1000
		RETURN 0
	ENDIF
	SIF ARG > 6
		CFLAG:RESULT:PTフラグ = 0
	CALL INSERT_POSITION,ARG,RESULT
	RETURN 0
ENDIF
SIF RESULT < 0 || RESULT > 100 || !EXISTCSV(RESULT*100+1, 0)
	GOTO INPUT_LOOP1

LOCAL = RESULT
LOCAL:1 = 0
LOCAL:2 = 0
FOR COUNT,RESULT*100+1,RESULT*100+101,1
	SIF COUNT == RESULT*100+100
		PRINTL [99]Return
		LOCAL:1 += 1
	IF EXISTCSV(COUNT,0)
		PRINTFORMLC [{LOCAL:1}]%CSVCALLNAME(COUNT,0)%
		SIF LOCAL:2 % 3 == 2
			PRINTL 
		LOCAL:2 += 1
	ENDIF
NEXT
PRINTL キャラクターを選んでください
INPUT
$INPUT_LOOP2
SIF RESULT == 99
	RETURN 0
SIF !EXISTCSV(LOCAL*100+RESULT,0)
	GOTO INPUT_LOOP2
LOCAL = LOCAL*100+RESULT
CALL INCREASE_ANALYZE,LOCAL,1000
IF ARG > 6
	PRINTL 強化ランクを選んでください
	PRINTL [  0] [  1] [  2] [  3] [  4] [  5]
	PRINTL [100] [101] [102] [103] [104] [105]
	$INPUT_LOOP3
	INPUT
	SIF RESULT < 0 || RESULT > 200
		GOTO INPUT_LOOP3
	LOCAL:2 = RESULT
	CALL SET_ENEMY,ARG,LOCAL,LOCAL:2,1
ELSE
	CALL ADD_NEW_COMPANION,LOCAL,500
	CALL INSERT_POSITION,ARG,CHARANUM-1
ENDIF
CALL SYNC_STATUS,CHARANUM-1
@CHOICE_TESTCHARA_EQUIP(ARG,ARG:1)
IF ARG:1 == 10
	LOCAL = 2000
ELSEIF ARG:1 == 11
	LOCAL = 2500
ELSEIF ARG:1 == 12
	LOCAL = 3000
ELSEIF ARG:1 == 13
	LOCAL = 3500
ELSEIF ARG:1 == 14
	LOCAL = 4000
ELSEIF ARG:1 == 15
	LOCAL = 4500
ELSEIF ARG:1 == 16
	LOCAL = 5000
ENDIF
LOCAL:1 = 0
LOCAL:2 = 0
CALLFORM 基本能力修正_2500
FOR COUNT,LOCAL,LOCAL+501
	IF COUNT == LOCAL+500
		PRINTL [999] Return
		CONTINUE
	ENDIF
	TRYCCALLFORM 基本能力修正_{COUNT}
		PRINTFORMLC [{LOCAL:1}] %ITEMNAME_E(COUNT)%
		SIF LOCAL:2 % 3 == 2
			PRINTL 
		LOCAL:2 += 1
	CATCH
	ENDCATCH
	LOCAL:1 += 1
NEXT
PRINTL 装備を選んでください
$INPUT_LOOP
INPUT
SIF RESULT == 999
	RETURN
LOCAL = LOCAL+RESULT
TRYCCALLFORM 装備箇所_{LOCAL}
CATCH
	GOTO INPUT_LOOP
ENDCATCH
EQUIP:ARG:(ARG:1) = LOCAL

@SET_POS_TEST
;ここは適当に書き換えてというか、貼りつけて使うといいと思います
;あとまぁ、死体残存フラグをたしたほうがよさげ
;例としてというか、実際にやった例としてイシュキックと愉快な仲間たち
;
					CALL SET_ENEMY,9,4205,100,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 850
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,7,3108,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 400
					CSTR:(CHARANUM-1):思考パターン = 3108
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,8,3108,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 400
					CSTR:(CHARANUM-1):思考パターン = 3108
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,10,3109,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 350
					CSTR:(CHARANUM-1):思考パターン = 3109
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,11,3109,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 350
					CSTR:(CHARANUM-1):思考パターン = 3109
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,12,3110,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 250
					CSTR:(CHARANUM-1):思考パターン = 3110
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,13,3110,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 250
					CSTR:(CHARANUM-1):思考パターン = 3110
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,15,3111,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 250
					CSTR:(CHARANUM-1):思考パターン = 3111
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
					CALL SET_ENEMY,16,3111,1 + ダンジョンフラグ:13:4,1
					CFLAG:(CHARANUM-1):ＨＰ補正 = 250
					CSTR:(CHARANUM-1):思考パターン = 3111
					MAXBASE:(CHARANUM-1):破魔 = 20
					MAXBASE:(CHARANUM-1):呪殺 = 20
					MAXBASE:(CHARANUM-1):精神 = 150
					MAXBASE:(CHARANUM-1):神経 = 150
					CALL SYNC_STATUS,(CHARANUM-1)
					CALL HEALTH_CHARA,(CHARANUM-1)
