
;=======================================================================

;ダンジョンフラグ:79:0 = 1.クリアフラグ
;ダンジョンフラグ:79:1 = 1.初回
;ダンジョンフラグ:79:2 = 1.中ボス撃破
;ダンジョンフラグ:79:10- = 1.宝箱

;博物館クリア後に出現、おおむね原作通りの構造
;処理がごちゃごちゃしている統一感０、とりあえず動作はしているはず
;フリーなんで適当に改変してください、というか修正して欲しい
;宝は原作通り、ないのはそれっぽいの

;=======================================================================
;攻略条件
;=======================================================================
@PREREQUISITE_DUNGEON_79
IF  ダンジョンフラグ:86:0 == 1 & !ダンジョンフラグ:79:0
	RETURN 1
ENDIF

;=======================================================================
;ダンジョン名
;=======================================================================
@GET_DUNGEON_NAME_79
RESULTS = Toa TV
;東亜テレビ

;=======================================================================
;フロア名表示
;=======================================================================
@FLOORNAME_79
PRINT  Toa TV
SELECTCASE FLAG:現M
	CASE 0
		PRINTL 1F
	CASE 1
		PRINTL 2F
	CASE 2
		PRINTL 3F
	CASE 3
		PRINTL 4F
	CASE 4
		PRINTL 5F
	CASE 5
		PRINTL 6F
	CASE 6
		PRINTL 7F
	CASE 7
		PRINTL 8F
	CASE 8
		PRINTL  Broadcast Tower 1F
		;電波塔・
	CASE 9
		PRINTL  Broadcast Tower 4F
	CASE 10
		PRINTL  Broadcast Tower 8F
	CASE 11
		PRINTL  Broadcast Tower 13F
	CASE 12
		PRINTL  Broadcast Tower 15F
	CASE 13
		PRINTL  Broadcast Tower 17F
	CASE 14
		PRINTL  Broadcast Tower 19F
	CASE 15
		PRINTL  Broadcast Tower 20F
	CASEELSE
		PRINTL
ENDSELECT
;=======================================================================
;スタート地点入力
;=======================================================================
@START_DUNGEON_79,ARG
FLAG:現M = 0
FLAG:現X = 7
FLAG:現Y = 1

;=======================================================================
;スタート時イベント
;=======================================================================
@EVENT_DUNGEON_START_79
IF ダンジョンフラグ:79:1 == 0
	CALL SHOW_PICTURE, "NONFLOORD"
	CALL MESSAGE_WINDOW_D, "", @"＞%CALLNAME:MASTER% received a request to investigate Toa TV, which was differentiated./＞It seems Toa TV was highjacked by some demon./＞You must quickly find and neutralize the target."
	;＞%CALLNAME:MASTER%は異界化した東亜テレビの調査依頼を受けた/＞東亜テレビが悪魔に乗っ取られたそうだ/＞迅速に対象を見つけ出し始末しなければなるまい
	ダンジョンフラグ:79:1 = 1
ENDIF

;=======================================================================
;フロアデータ
;=======================================================================
@MAKE_FLOOR_79
SELECTCASE FLAG:現M
	CASE 0
		FLAG:最大X = 17 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 6     8   11126 "
		CALL MAKE_FLOOR_LINE, 2," 2     2   111   "
 		CALL MAKE_FLOOR_LINE, 3," 111   1   111   "
		CALL MAKE_FLOOR_LINE, 4," 111   1   2     "
		CALL MAKE_FLOOR_LINE, 5," 11121 1 111     "
		CALL MAKE_FLOOR_LINE, 6,"     1 2 1       "
		CALL MAKE_FLOOR_LINE, 7,"     11111       "
		CALL MAKE_FLOOR_LINE, 8,"       111       "
		CALL MAKE_FLOOR_LINE, 9,"       11111     "
		CALL MAKE_FLOOR_LINE,10,"       1 2 1     "
		CALL MAKE_FLOOR_LINE,11,"     111 1 12111 "
		CALL MAKE_FLOOR_LINE,12,"     2   1   111 "
		CALL MAKE_FLOOR_LINE,13,"   111   1   111 "
		CALL MAKE_FLOOR_LINE,14,"   111   2     2 "
		CALL MAKE_FLOOR_LINE,15," 62111   1     6 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		
	CASE 1
		FLAG:最大X = 20 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 76 111111111 67 "
		CALL MAKE_FLOOR_LINE, 2," 11 1       1 11 "
 		CALL MAKE_FLOOR_LINE, 3," 1111 11111 1111 "
		CALL MAKE_FLOOR_LINE, 4," 1    2   2    1 "
		CALL MAKE_FLOOR_LINE, 5," 1 11115551111 1 "
		CALL MAKE_FLOOR_LINE, 6," 1 1       111 1 "
		CALL MAKE_FLOOR_LINE, 7," 1 1   E21 111 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 2     1     1 "
		CALL MAKE_FLOOR_LINE, 9," 1 111 5141111 1 "
		CALL MAKE_FLOOR_LINE,10," 1 111       1 1 "
		CALL MAKE_FLOOR_LINE,11," 1 11111111121 1 "
		CALL MAKE_FLOOR_LINE,12," 1    2   1    1 "
		CALL MAKE_FLOOR_LINE,13," 1111 115 1 1111 "
		CALL MAKE_FLOOR_LINE,14," 11 1       1 11 "
		CALL MAKE_FLOOR_LINE,15," 76 111111111 67 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456789
		
		CASE 2
		FLAG:最大X = 17 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 6 7     1111126 "
		CALL MAKE_FLOOR_LINE, 2," 2 2     2   1   "
 		CALL MAKE_FLOOR_LINE, 3," 111     1   127 "
		CALL MAKE_FLOOR_LINE, 4," 1       1       "
		CALL MAKE_FLOOR_LINE, 5," 1   4 41114     "
		CALL MAKE_FLOOR_LINE, 6," 1   1           "
		CALL MAKE_FLOOR_LINE, 7," 12111 E21 5     "
		CALL MAKE_FLOOR_LINE, 8,"     1   1 1     "
		CALL MAKE_FLOOR_LINE, 9,"     5 111 11121 "
		CALL MAKE_FLOOR_LINE,10,"           1   1 "
		CALL MAKE_FLOOR_LINE,11,"     41114 4   1 "
		CALL MAKE_FLOOR_LINE,12,"       1       1 "
		CALL MAKE_FLOOR_LINE,13," 721   1     111 "
		CALL MAKE_FLOOR_LINE,14,"   1   2     2 2 "
		CALL MAKE_FLOOR_LINE,15," 6211111     7 6 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		
		CASE 3
		FLAG:最大X = 17 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 7 1         127 "
		CALL MAKE_FLOOR_LINE, 2," 2 1         1   "
 		CALL MAKE_FLOOR_LINE, 3," 111 6211121 111 "
		CALL MAKE_FLOOR_LINE, 4,"           1     "
		CALL MAKE_FLOOR_LINE, 5,"     111111111   "
		CALL MAKE_FLOOR_LINE, 6,"     1       1   "
		CALL MAKE_FLOOR_LINE, 7,"     4 E2111 1   "
		CALL MAKE_FLOOR_LINE, 8,"     1   1 2 1   "
		CALL MAKE_FLOOR_LINE, 9,"     1 311 1 1   "
		CALL MAKE_FLOOR_LINE,10,"     1     1 2   "
		CALL MAKE_FLOOR_LINE,11,"     1111111 6   "
		CALL MAKE_FLOOR_LINE,12,"                 "
		CALL MAKE_FLOOR_LINE,13," 111         111 "
		CALL MAKE_FLOOR_LINE,14,"   1         1 2 "
		CALL MAKE_FLOOR_LINE,15," 721         1 7 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 4
		FLAG:最大X = 17 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 111112111111    "
		CALL MAKE_FLOOR_LINE, 2," 1   1      1    "
 		CALL MAKE_FLOOR_LINE, 3," 1 7 1      1    "
		CALL MAKE_FLOOR_LINE, 4," 1 121      1    "
		CALL MAKE_FLOOR_LINE, 5," 1 6 1      1    "
		CALL MAKE_FLOOR_LINE, 6," 1          1    "
		CALL MAKE_FLOOR_LINE, 7," 111 4 E    1    "
		CALL MAKE_FLOOR_LINE, 8," 2   2 2 1111111 "
		CALL MAKE_FLOOR_LINE, 9," 1   1 121  2  1 "
		CALL MAKE_FLOOR_LINE,10," 1   1 1 1 716 1 "
		CALL MAKE_FLOOR_LINE,11," 123 121 1     1 "
		CALL MAKE_FLOOR_LINE,12,"         1111111 "
		CALL MAKE_FLOOR_LINE,13,"                 "
		CALL MAKE_FLOOR_LINE,14,"                 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 5
		FLAG:最大X = 17 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 111112111111    "
		CALL MAKE_FLOOR_LINE, 2," 1   1      1    "
 		CALL MAKE_FLOOR_LINE, 3," 1 6 1      1    "
		CALL MAKE_FLOOR_LINE, 4," 1 121      1    "
		CALL MAKE_FLOOR_LINE, 5," 1 7 1      1    "
		CALL MAKE_FLOOR_LINE, 6," 1   1      1    "
		CALL MAKE_FLOOR_LINE, 7," 11111 E    1    "
		CALL MAKE_FLOOR_LINE, 8,"       2 1111111 "
		CALL MAKE_FLOOR_LINE, 9," 11111 121  2  1 "
		CALL MAKE_FLOOR_LINE,10," 11111 1   617 1 "
		CALL MAKE_FLOOR_LINE,11," 3151121 1     1 "
		CALL MAKE_FLOOR_LINE,12," 11111   1111111 "
		CALL MAKE_FLOOR_LINE,13," 11111           "
		CALL MAKE_FLOOR_LINE,14,"                 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 6
		FLAG:最大X = 17 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 11111           "
		CALL MAKE_FLOOR_LINE, 2," 1   1           "
 		CALL MAKE_FLOOR_LINE, 3," 1 7 1           "
		CALL MAKE_FLOOR_LINE, 4," 1 121           "
		CALL MAKE_FLOOR_LINE, 5," 1 6 1           "
		CALL MAKE_FLOOR_LINE, 6," 1   1           "
		CALL MAKE_FLOOR_LINE, 7," 11111 E         "
		CALL MAKE_FLOOR_LINE, 8," 2     2 1111111 "
		CALL MAKE_FLOOR_LINE, 9," 11111 1 1  2  1 "
		CALL MAKE_FLOOR_LINE,10," 1   1 1 1 716 1 "
		CALL MAKE_FLOOR_LINE,11," 1 1 1 2 1     1 "
		CALL MAKE_FLOOR_LINE,12," 1 2 11111111111 "
		CALL MAKE_FLOOR_LINE,13," 11111           "
		CALL MAKE_FLOOR_LINE,14,"                 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 7
		FLAG:最大X = 17 
		FLAG:最大Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"   4             "
		CALL MAKE_FLOOR_LINE, 2,"   2             "
 		CALL MAKE_FLOOR_LINE, 3," 111 72111111    "
		CALL MAKE_FLOOR_LINE, 4," 1          2    "
		CALL MAKE_FLOOR_LINE, 5," 1 1111114111    "
		CALL MAKE_FLOOR_LINE, 6," 1 2 1   33      "
		CALL MAKE_FLOOR_LINE, 7," 1 1 1           "
		CALL MAKE_FLOOR_LINE, 8," 1 1 111 5 51111 "
		CALL MAKE_FLOOR_LINE, 9," 1 1   1 2 1 2 1 "
		CALL MAKE_FLOOR_LINE,10," 1 1   1 111 7 1 "
		CALL MAKE_FLOOR_LINE,11," 1 5   1 131   1 "
		CALL MAKE_FLOOR_LINE,12," 1     1 1151111 "
		CALL MAKE_FLOOR_LINE,13," 1111111 1   2 1 "
		CALL MAKE_FLOOR_LINE,14,"         12111 1 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 8
		FLAG:最大X = 17 
		FLAG:最大Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE,13,"                 "
		CALL MAKE_FLOOR_LINE, 4,"                 "
 		CALL MAKE_FLOOR_LINE, 5,"     11111 111   "
		CALL MAKE_FLOOR_LINE, 6,"     1   1 1 1   "
		CALL MAKE_FLOOR_LINE, 7,"   111 a 1 5 5   "
		CALL MAKE_FLOOR_LINE, 8,"   5   2 2 1 5   "
		CALL MAKE_FLOOR_LINE, 9,"   5   1 b 1 5   "
		CALL MAKE_FLOOR_LINE,10,"   5   1   1 1   "
		CALL MAKE_FLOOR_LINE,11,"   111 11111 1   "
		CALL MAKE_FLOOR_LINE,12,"     1       1   "
		CALL MAKE_FLOOR_LINE,13,"     111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 9
		FLAG:最大X = 17 
		FLAG:最大Y = 13 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"                 "
		CALL MAKE_FLOOR_LINE, 4,"                 "
 		CALL MAKE_FLOOR_LINE, 5,"   11123 11111   "
		CALL MAKE_FLOOR_LINE, 6,"   111   1   1   "
		CALL MAKE_FLOOR_LINE, 7,"   111 a 1   1   "
		CALL MAKE_FLOOR_LINE, 8,"   1   2 2   1   "
		CALL MAKE_FLOOR_LINE, 9,"   1   1 b 111   "
		CALL MAKE_FLOOR_LINE,10,"   1   1   111   "
		CALL MAKE_FLOOR_LINE,11,"   11111 32111   "
		CALL MAKE_FLOOR_LINE,12,"                 "
		;                        01234567890123456
		
		CASE 10
		FLAG:最大X = 17 
		FLAG:最大Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"     1111111     "
		CALL MAKE_FLOOR_LINE, 3,"     1     2     "
		CALL MAKE_FLOOR_LINE, 4,"     1   111     "
 		CALL MAKE_FLOOR_LINE, 5,"     1   2 1     "
		CALL MAKE_FLOOR_LINE, 6,"     1   1 1     "
		CALL MAKE_FLOOR_LINE, 7,"     1 a 1 1     "
		CALL MAKE_FLOOR_LINE, 8,"     1 2 2 1     "
		CALL MAKE_FLOOR_LINE, 9,"     1 1 b 1     "
		CALL MAKE_FLOOR_LINE,10,"     1 1   1     "
		CALL MAKE_FLOOR_LINE,11,"     1 2 111     "
		CALL MAKE_FLOOR_LINE,12,"     111 2       "
		CALL MAKE_FLOOR_LINE,13,"         4       "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 11
		FLAG:最大X = 17 
		FLAG:最大Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"   11111111111   "
		CALL MAKE_FLOOR_LINE, 4,"   1         1   "
 		CALL MAKE_FLOOR_LINE, 5,"   1253111   1   "
		CALL MAKE_FLOOR_LINE, 6,"   1     1   2   "
		CALL MAKE_FLOOR_LINE, 7,"   111 a 1   6   "
		CALL MAKE_FLOOR_LINE, 8,"       2 2       "
		CALL MAKE_FLOOR_LINE, 9,"   6   1 b 111   "
		CALL MAKE_FLOOR_LINE,10,"   2   1     1   "
		CALL MAKE_FLOOR_LINE,11,"   1   1113521   "
		CALL MAKE_FLOOR_LINE,12,"   1         1   "
		CALL MAKE_FLOOR_LINE,13,"   11111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 12
		FLAG:最大X = 17 
		FLAG:最大Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"   111111111     "
		CALL MAKE_FLOOR_LINE, 4," c 1       1     "
 		CALL MAKE_FLOOR_LINE, 5," 2 1 11111 11111 "
		CALL MAKE_FLOOR_LINE, 6," 1 1 1   1     1 "
		CALL MAKE_FLOOR_LINE, 7," 1 1 5 a 1   7 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 2   2 2   2 1 "
		CALL MAKE_FLOOR_LINE, 9," 1 7   1 b 5 1 1 "
		CALL MAKE_FLOOR_LINE,10," 1     1   1 1 1 "
		CALL MAKE_FLOOR_LINE,11," 11111 11111 1 2 "
		CALL MAKE_FLOOR_LINE,12,"     1       1 d "
		CALL MAKE_FLOOR_LINE,13,"     111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 13
		FLAG:最大X = 17 
		FLAG:最大Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"   1111111       "
		CALL MAKE_FLOOR_LINE, 4," c 1     1       "
 		CALL MAKE_FLOOR_LINE, 5," 2 1   621 11123 "
		CALL MAKE_FLOOR_LINE, 6," 1 1       1   5 "
		CALL MAKE_FLOOR_LINE, 7," 1 1111111 1   1 "
		CALL MAKE_FLOOR_LINE, 8," 1   1     1   1 "
		CALL MAKE_FLOOR_LINE, 9," 1   1 1111111 1 "
		CALL MAKE_FLOOR_LINE,10," 5   1       1 1 "
		CALL MAKE_FLOOR_LINE,11," 32111 126   1 2 "
		CALL MAKE_FLOOR_LINE,12,"       1     1 d "
		CALL MAKE_FLOOR_LINE,13,"       1111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 14
		FLAG:最大X = 17 
		FLAG:最大Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"   111111111     "
		CALL MAKE_FLOOR_LINE, 2,"   1 2     1     "
		CALL MAKE_FLOOR_LINE, 3,"   1 11111 111   "
		CALL MAKE_FLOOR_LINE, 4," c 1     1   1   "
 		CALL MAKE_FLOOR_LINE, 5," 2 11127 121 1   "
		CALL MAKE_FLOOR_LINE, 6," 1         1 1   "
		CALL MAKE_FLOOR_LINE, 7," 11111 62111 111 "
		CALL MAKE_FLOOR_LINE, 8,"     1         1 "
		CALL MAKE_FLOOR_LINE, 9,"     1 1111121 1 "
		CALL MAKE_FLOOR_LINE,10,"     1 1       1 "
		CALL MAKE_FLOOR_LINE,11,"     1 1 72111 2 "
		CALL MAKE_FLOOR_LINE,12,"     1 2     1 d "
		CALL MAKE_FLOOR_LINE,13,"     111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 15
		FLAG:最大X = 17 
		FLAG:最大Y =  7 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
 		CALL MAKE_FLOOR_LINE, 1," 111111151111111 "
		CALL MAKE_FLOOR_LINE, 2," 1             1 "
		CALL MAKE_FLOOR_LINE, 3," 1111127 4211111 "
		CALL MAKE_FLOOR_LINE, 4," 1             1 "
		CALL MAKE_FLOOR_LINE, 5," 111111111111111 "
		CALL MAKE_FLOOR_LINE, 6,"                 "
		;                        01234567890123456
		
	
	CASEELSE
ENDSELECT


;=======================================================================
;タイル調整
;=======================================================================
@MAKE_FLOOR_LINE_COMMON_79, ARG, ARG:1, ARG:2
#LOCALSIZE 20
SIF ARG:1 == 0 && ARG:2 == 0
	VARSET LOCAL
SELECTCASE ARG
	CASE 3
		IF GETBIT(ダンジョンフラグ:(FLAG:現ダンジョン):(FLAG:現M+10), LOCAL:3)
			DA:(ARG:1):(ARG:2) = 1
			ELSE
			DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:3 * 10 + 3
		ENDIF
		LOCAL:3++
	CASE 4 TO 9
		DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:ARG * 10 + ARG
		LOCAL:ARG++
	
ENDSELECT

;=======================================================================
;指定したマスに進入可能か
;=======================================================================
@CAN_ENTER_79,ARG,ARG:1


IF FLAG:現M == 0 && ARG == 4 && ARG:1 == 5
		IF FLAG:現X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
	;＞扉は閉ざされている
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 0 && ARG == 12 && ARG:1 == 11
		IF FLAG:現X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 0 && ARG == 11 && ARG:1 == 4
		IF FLAG:現Y < ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 0 && ARG == 5 && ARG:1 == 12
		IF FLAG:現Y > ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF


	IF FLAG:現M == 2 && ARG == 2 && ARG:1 == 7
		IF FLAG:現X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 2 && ARG == 9 && ARG:1 == 2
		IF FLAG:現Y > ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 2 && ARG == 7 && ARG:1 == 14
		IF FLAG:現Y < ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 2 && ARG == 14 && ARG:1 == 9
		IF FLAG:現X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 4 && ARG == 6 && ARG:1 == 1
		IF FLAG:現X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF


IF FLAG:現M == 5 && ARG == 6 && ARG:1 == 1
		IF FLAG:現X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF


IF FLAG:現M == 4 && ARG == 8 && ARG:1 == 9
		IF FLAG:現X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF


IF FLAG:現M == 5 && ARG == 8 && ARG:1 == 9
		IF FLAG:現X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 6 && ARG == 7 && ARG:1 == 11
		IF FLAG:現Y > ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞This door can't be opened from this side"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:現M == 4 && ARG == 5 && ARG:1 == 8 && ダンジョンフラグ:79:2 == 0
	CALL MESSAGE_WINDOW_D, "", "＞This sounds like a power room./＞There is a beeping noise from the other side of the door./＞Do you want to open the door?"
	;＞この部屋は動力室のようだ/＞扉の向こうから音が響いてくる/＞扉をあけますか？
			CALL INPUT_YN_D,"Yes","No"
		SIF RESULT
			RETURN 0
ENDIF

IF FLAG:現M == 15 && ARG == 10 && ARG:1 == 3 
	CALL MESSAGE_WINDOW_D, "", "＞It seems like this leads to the summit of the broadcast tower./＞Do you want to open the door?"
	;＞ここが電波塔の頂上のようだ/＞扉をあけますか？
			CALL INPUT_YN_D,"Yes","No"
		SIF RESULT
			RETURN 0
ENDIF



CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT

;=======================================================================
;タイル定義
;=======================================================================
@DEFINE_TILES_79, ARGS, ARG, ARG:1
SELECTCASE ARGS
	CASE "a"
		RETURN 19
	CASE "b"
		RETURN 29
	CASE "c"
		RETURN 39
	CASE "d"
		RETURN 49
	ENDSELECT

@TILE_MARK_COMMON_79_4, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	CASE 0 , 100 , 300 , 701
		SETCOLOR 0x00ff00
		RESULTS = ｍ
	CASE 1 , 700 
		RESULTS = ↑
	CASE 1 , 1000 
		RESULTS = ↓
	CASEELSE
		RETURN 1
ENDSELECT


@TILE_MARK_COMMON_79_9, ARG, ARG:1, ARG:2
SELECTCASE FLAG:現M
	CASE 8,9,10,11,12,13,14
	RESULTS = Ｅ
	CASEELSE
	RETURN 1
ENDSELECT

@TILE_MARK_COMMON_79_5, ARG, ARG:1, ARG:2
SELECTCASE FLAG:現M
	CASE 2
RESULTS = ！
	CASEELSE
RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?罠#□\@
ENDSELECT

;=======================================================================
;[5]調べる　実行時のイベント
;=======================================================================
@EVENT_CHECK_DUNGEON_79

;==========
;出口の処理
;==========
IF DA:(FLAG:現X):(FLAG:現Y) == 8
		CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 3
	CALL TRESURING_CALLING_79
	RETURN RESULT

;=======
;階段
;=======
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 6
	CALL UPSTAIRS_79
	RETURN RESULT

ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 7
	CALL DOWNSTAIRS_79
	RETURN RESULT

;==========
;イベントの処理
;==========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 4
	 
	SELECTCASE FLAG:現M
	CASE 1
		IF FLAG:現X == 9 && FLAG:現Y == 9
			CALL MESSAGE_WINDOW_D, "ＴＶ局員", "おい、なんだありゃ。/怪談話や怪奇現象のネタは、時代遅れもいいとこだぞ。/責任者、呼んでこい！　責任者！ まったく何の番組撮ってんだよ。"
		ENDIF
	CASE 3
		IF FLAG:現X == 5 && FLAG:現Y == 7
			CALL MESSAGE_WINDOW_D, "Anna Girl", "Yu, it's a ghost! There's ghosts!/And there's also a ghost inside Toa TV station, I never saw anything like that./Somebody say all this is just a joke, please!!"
			;"女子アナ", "ゆ、幽霊です！ 幽霊が出ました！/と、東亜ＴＶ局内に幽霊です、私も初めて目撃いたしました。/誰かウソでもいいからドッキリだって言ってえ！！ "
		ENDIF
	CASE 7
		IF FLAG:現X == 9 && FLAG:現Y == 5
			CALL MESSAGE_WINDOW_D, "ＡＤ", "絶対間違いないっす、あれはギタリストのスピーディーっすよ。/自分、動力室で見たっす。危ない薬に手を出していっちまった/あのスピーディーに間違いないっすぅ。"
			CALL MESSAGE_WINDOW_D, "ＡＤ", "うう………お前は天才だった。/わからなかった俺たちがバカだったんだ/頼むから成仏してくれー。"
		ENDIF
		ENDSELECT
	RETURN 1

ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 9
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
			CASE 1
				CALL DUNGEON_ELEVATOR, 19
			CASE 2
				CALL DUNGEON_ELEVATOR, 29
			CASE 3
				CALL DUNGEON_ELEVATOR, 39
			CASE 4
				CALL DUNGEON_ELEVATOR, 49
		ENDSELECT
		RETURN 1

ELSE
	CALL MESSAGE_WINDOW_D, "", "＞Nothing seems to be here."
	;何も無いようだ
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時のイベント
;=======================================================================
@EVENT_ENTER_DUNGEON_79,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出口の処理
;==========
IF DA:(FLAG:現X):(FLAG:現Y)  == 8
	CALL DUNGEON_EXIT
	RETURN 1

;========
;宝の処理
;========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 3
	CALL TRESURING_CALLING_79
	RETURN RESULT
	
;========
;罠の処理
;========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 ==  5 
	CALL TRAP_79
	RETURN RESULT
	
;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1

;=======
;階段
;=======
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 6
	CALL UPSTAIRS_79
	RETURN RESULT

ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 7
	CALL DOWNSTAIRS_79
	RETURN RESULT

ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 9
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
			CASE 1
				CALL DUNGEON_ELEVATOR, 19
			CASE 2
				CALL DUNGEON_ELEVATOR, 29
			CASE 3
				CALL DUNGEON_ELEVATOR, 39
			CASE 4
				CALL DUNGEON_ELEVATOR, 49
		ENDSELECT
RETURN 1
		
;==========
;イベントの処理
;==========
ELSEIF DA:(FLAG:現X):(FLAG:現Y) % 10 == 4
	 
	SELECTCASE FLAG:現M 
		
		CASE 2
			IF FLAG:現X == 5 && FLAG:現Y == 5
				FLAG:現M = 2
				FLAG:現X = 5
				FLAG:現Y = 11
			ELSEIF FLAG:現X == 7 && FLAG:現Y == 5
				FLAG:現M = 2
				FLAG:現X = 15
				FLAG:現Y = 13
			ELSEIF FLAG:現X == 11 && FLAG:現Y == 3
				FLAG:現M = 2
				FLAG:現X = 5
				FLAG:現Y = 5
			ELSEIF FLAG:現X == 5 && FLAG:現Y == 11
				FLAG:現M = 2
				FLAG:現X = 11
				FLAG:現Y = 11
			ELSEIF FLAG:現X == 11 && FLAG:現Y == 11
				FLAG:現M = 2
				FLAG:現X = 11
				FLAG:現Y = 5
			ELSEIF FLAG:現X == 9 && FLAG:現Y == 11
				FLAG:現X = 1
				FLAG:現Y = 3
			ELSEIF FLAG:現X == 11 && FLAG:現Y == 5
				FLAG:現X = 5
				FLAG:現Y = 5
			ENDIF
			
		CASE 4
			IF FLAG:現X == 5 && FLAG:現Y == 7 && ダンジョンフラグ:79:2 == 0
			
			CALL MESSAGE_WINDOW_D, "", "＞There are three demons in this room"
			;＞異界化した部屋の中に三体の悪魔がいた
			CALL MESSAGE_WINDOW_D, "Julia", "I'm the absolute idol!/Super Idol!! Forever an idol!!"
			;ユリア	わたし、絶対アイドル！/スーパーアイドル！！永遠にアイドルよ！！
			CALL MESSAGE_WINDOW_D, "Speedy", "My guitar tech is world class!/I'm a superstar!!　I won't loose to anyone!!"
			;スピーディー	おれのギターテクは世界一！/おれは、スーパースター！！　誰にも負けないぜ！！
			CALL MESSAGE_WINDOW_D, "Speedy", "With Orgone Ghost energy,/we are superstars forever!!/And we'll kill anyone who disturbs us!!"
			;オルゴンゴースト様のエナジーで/おれたちは、永遠にスーパースターだ！！/邪魔するヤツは、皆殺しだぜぇ！！
			CALL MESSAGE_WINDOW_D, "Mikiya", "....... "
			;ミキヤ
			CALL MESSAGE_WINDOW_D, "", "＞１ Ghost Julia appeared!/＞１ Ghost Speedy appeared!/＞１ Ghost Mikiya appeared!"
			;怨霊 ユリアが１体出た！/＞怨霊 スピーディーが１体出た！/＞怨霊 ミキヤが１体出た！
			
			FLAG:逃走不可フラグ = 1
			FLAG:会話不能フラグ = 1
			FLAG:先制不意打ちキャンセル = 1
			
				;ユリア
				CALL SET_ENEMY,8,[[キャラ:ユリア]],40,0,1
				CFLAG:(CHARANUM-1):ＨＰ補正 += 500
				CFLAG:(CHARANUM-1):ＭＰ補正 += 1000
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				;スピーディー
				CALL SET_ENEMY,9,[[キャラ:スピーディー]],43,0,1
				CFLAG:(CHARANUM-1):ＨＰ補正 += 500
				CFLAG:(CHARANUM-1):ＭＰ補正 += 1000
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				;ミキヤ
				CALL SET_ENEMY,10,[[キャラ:ミキヤ]],38,0,1
				CFLAG:(CHARANUM-1):ＨＰ補正 += 500
				CFLAG:(CHARANUM-1):ＭＰ補正 += 1000
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				CALL BATTLE_START
				FLAG:逃走不可フラグ = 0
				FLAG:会話不能フラグ = 0
				FLAG:先制不意打ちキャンセル = 0
				
			CALL MESSAGE_WINDOW_D, "Julia", "....no..no!!/I'm an idol, I have to be on ＴＶ....."
			;……いやぁああああ！！/アイドルは、ＴＶに出なくちゃああああ……
			CALL MESSAGE_WINDOW_D, "Speedy", "...all geniuses have to die eventually..."
			;……やはり、天才は死ななきゃいけないのか…
			CALL MESSAGE_WINDOW_D, "Mikiya", "...... "
			CALL MESSAGE_WINDOW_D, "", "＞Ghost Julia defeated.../＞Ghost Speedy defeated.../＞Ghost Mikiya defeated..."
			;怨霊 ユリアは力尽きた…/＞怨霊 スピーディーは力尽きた…/＞怨霊 ミキヤは力尽きた…"
			CALL MESSAGE_WINDOW_D, "", "＞Abnormal power room function has been stopped."
			;動力室の機能は、止まった。
				
				ダンジョンフラグ:79:2 = 1
				RETURN 1
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞The power room has been powered down."
				;動力室の機能は、止まっている。
	
				RETURN 1
			ENDIF
				
		CASE 7
			IF FLAG:現X == 3 && FLAG:現Y == 1
						CALL MESSAGE_WINDOW_D, "", "＞Will you go to the broadcast tower?"
						;電波塔に行きますか？"
			CALL INPUT_YN_D,"Yes","No"
				IF RESULT == 0
					FLAG:現M = 10
					FLAG:現X = 9
					FLAG:現Y = 13
					CALL MAKE_FLOOR, FLAG:現ダンジョン
					CALL AUTOMAP
				ENDIF
			ENDIF
				
		CASE 10
			IF FLAG:現X == 9 && FLAG:現Y == 13
						CALL MESSAGE_WINDOW_D, "", "＞Will you go to Toa TV?"
						;東亜テレビに行きますか？
			CALL INPUT_YN_D,"Yes","No"
				IF RESULT == 0
					FLAG:現M = 7
					FLAG:現X = 3
					FLAG:現Y = 1
					CALL MAKE_FLOOR, FLAG:現ダンジョン
					CALL AUTOMAP
				ENDIF
			ENDIF
			
		CASE 15
			IF FLAG:現X == 9 && FLAG:現Y == 3 && ダンジョンフラグ:79:2 == 1

			CALL MESSAGE_WINDOW_D, "", "＞In this room,/＞a small spirit's body was swaying."
			;部屋の中で顔の形をした/＞小さな霊体がゆらゆらと揺らめいていた
			CALL MESSAGE_WINDOW_D, "Orgone Ghost", "ohhhh...../What happened to thoose 3 in the power room..../There was soo much sweet energy...."
			;オルゴンゴースト	ぅおおおおおお……/動力室の3人組は、どうした……/エナジーが全然集まってこんぞぉ……
			CALL MESSAGE_WINDOW_D, "", "＞１ Foul Orgone Ghost appeared!"
			
			FLAG:逃走不可フラグ = 1
			FLAG:会話不能フラグ = 1
			FLAG:先制不意打ちキャンセル = 1
			
				;オルゴンゴースト
				CALL SET_ENEMY,9,[[キャラ:オルゴンゴースト]],45,0,1
				CFLAG:(CHARANUM-1):ＭＰ補正 = +1000
				BASE:(CHARANUM-1):剣撃 = 150
				BASE:(CHARANUM-1):飛具 = 100
				BASE:(CHARANUM-1):打撃 = 100
				BASE:(CHARANUM-1):戦技 = 150
				BASE:(CHARANUM-1):火炎 = 100
				BASE:(CHARANUM-1):氷結 = 200
				BASE:(CHARANUM-1):衝撃 = 100
				BASE:(CHARANUM-1):地変 = 100
				BASE:(CHARANUM-1):水撃 = 100
				BASE:(CHARANUM-1):疾風 = 100
				BASE:(CHARANUM-1):重力 = 100
				BASE:(CHARANUM-1):核熱 = 100
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				ABL:(CHARANUM-1):スキル3 = [[スキル:ジオンガ]]
				ABL:(CHARANUM-1):スキル4 = [[スキル:放電]]
				
				CALL BATTLE_START
				FLAG:逃走不可フラグ = 0
				FLAG:会話不能フラグ = 0
				FLAG:先制不意打ちキャンセル = 0
				
			CALL MESSAGE_WINDOW_D, "Orgone Ghost", "Ohhhh..../Without energy...../Loose....."
			;ぅおおおおおお……/エ、エナジーがなければ……/勝てん……。
			
			ELSE
			
			CALL MESSAGE_WINDOW_D, "", "＞In this room/＞a huge spirit body was swaying."
			;＞部屋の中で顔の形をした/＞巨大な霊体がゆらゆらと揺らめいていた"
			CALL MESSAGE_WINDOW_D, "Orgone Ghost", "Ohhh!/There is so much energy!/Many sweet electrical energy waves to gather!"
			;ぐおおおおおおおおお！/エナジーが、みなぎるみなぎる！/電波が電気が怨念が、集まる集まる！
			CALL MESSAGE_WINDOW_D, "Orgone Ghost", "I feel good, oooooo!/I'll also turn you into my energy!"
			;気持ちいいぞぉおおおおおおおおおおおお！/おまえも、おれのエナジーにしてやるぜぇ！
			CALL MESSAGE_WINDOW_D, "", "＞１ Foul Orgone Ghost appeared!"
			
			FLAG:逃走不可フラグ = 1
			FLAG:会話不能フラグ = 1
			FLAG:先制不意打ちキャンセル = 1
			
							;オルゴンゴースト
				CALL SET_ENEMY,9,[[キャラ:オルゴンゴースト]],60,0,1
				CFLAG:(CHARANUM-1):ＨＰ補正 += 2000
				CFLAG:(CHARANUM-1):ＭＰ補正 += 3000
				CFLAG:(CHARANUM-1):行動回数 = 2
				CFLAG:(CHARANUM-1):速度補正 = 15
				BASE:(CHARANUM-1):力 += 5
				BASE:(CHARANUM-1):知恵 += 5
				BASE:(CHARANUM-1):魔力 += 5
				BASE:(CHARANUM-1):耐力 += 5
				BASE:(CHARANUM-1):速さ += 5
				BASE:(CHARANUM-1):運 += 5
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				CALL BATTLE_START
				FLAG:逃走不可フラグ = 0
				FLAG:会話不能フラグ = 0
				FLAG:先制不意打ちキャンセル = 0
			
				CALL MESSAGE_WINDOW_D, "Orgone Ghost", "Awaa..ah.../The energy...it leaves me..."
				;ぐあああああああ……/エナジーが、出て行く出て行く……。
			
			ENDIF
			
			CALL MESSAGE_WINDOW_D, "", "＞Foul Orgone Ghost defeated...."
			CALL MESSAGE_WINDOW_D, "", "＞The differentiated Toa TV station was returned to normal./＞￥50000 were paid as reward."
			;異界化した東亜テレビは元に戻った/＞報酬として口座に￥50000が支払われた
		MONEY += 50000
		ダンジョンフラグ:79:0 = 1
		FLAG:脱出 = 1
		
	ENDSELECT
ENDIF



	
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
			CASE 1
				CALL DUNGEON_ELEVATOR, 19
			CASE 2
				CALL DUNGEON_ELEVATOR, 29
			CASE 3
				CALL DUNGEON_ELEVATOR, 39
			CASE 4
				CALL DUNGEON_ELEVATOR, 49
		ENDSELECT
		RETURN 0

;========
;階段移動
;========
@UPSTAIRS_79
SELECTCASE FLAG:現M
	CASE 0
		SIF FLAG:現X == 1 && FLAG:現Y == 1
			CALL DUNGEON_UPSTAIRS,1,1,1
		SIF FLAG:現X == 1 && FLAG:現Y == 15
			CALL DUNGEON_UPSTAIRS,1,1,15
		SIF FLAG:現X == 15 && FLAG:現Y == 1
			CALL DUNGEON_UPSTAIRS,1,15,1
		SIF FLAG:現X == 15 && FLAG:現Y == 15
			CALL DUNGEON_UPSTAIRS,1,15,15
	CASE 1
		SIF FLAG:現X == 2 && FLAG:現Y == 1
			CALL DUNGEON_UPSTAIRS,2,3,1
		SIF FLAG:現X == 14 && FLAG:現Y == 1
			CALL DUNGEON_UPSTAIRS,2,15,3
		SIF FLAG:現X == 2 && FLAG:現Y == 15
			CALL DUNGEON_UPSTAIRS,2,1,13
		SIF FLAG:現X == 14 && FLAG:現Y == 15
			CALL DUNGEON_UPSTAIRS,2,13,15
	CASE 2
		SIF FLAG:現X == 1 && FLAG:現Y == 1
			CALL DUNGEON_UPSTAIRS,3,1,1
		SIF FLAG:現X == 1 && FLAG:現Y == 15
			CALL DUNGEON_UPSTAIRS,3,1,15
		SIF FLAG:現X == 15 && FLAG:現Y == 1
			CALL DUNGEON_UPSTAIRS,3,15,1
		SIF FLAG:現X == 15 && FLAG:現Y == 15
			CALL DUNGEON_UPSTAIRS,3,15,15
	CASE 3
		SIF FLAG:現X == 5 && FLAG:現Y == 3
			CALL DUNGEON_UPSTAIRS,4,3,3
		SIF FLAG:現X == 13 && FLAG:現Y == 11
			CALL DUNGEON_UPSTAIRS,4,11,10
	CASE 4
		SIF FLAG:現X == 3 && FLAG:現Y == 5
			CALL DUNGEON_UPSTAIRS,5,3,5
		SIF FLAG:現X == 13 && FLAG:現Y == 10
			CALL DUNGEON_UPSTAIRS,5,13,10
	CASE 5
		SIF FLAG:現X == 11 && FLAG:現Y == 10
			CALL DUNGEON_UPSTAIRS,6,11,10
		SIF FLAG:現X == 3 && FLAG:現Y == 3
			CALL DUNGEON_UPSTAIRS,6,3,3
	CASE 6
		SIF FLAG:現X == 3 && FLAG:現Y == 5
			CALL DUNGEON_UPSTAIRS,7,5,3
		SIF FLAG:現X == 13 && FLAG:現Y == 10
			CALL DUNGEON_UPSTAIRS,7,13,10
	CASE 11
		SIF FLAG:現X == 13 && FLAG:現Y == 7
			CALL DUNGEON_UPSTAIRS,12,13,7
		SIF FLAG:現X == 3 && FLAG:現Y == 9
			CALL DUNGEON_UPSTAIRS,12,3,9
	CASE 12
		SIF FLAG:現X == 3 && FLAG:現Y == 9
			CALL DUNGEON_UPSTAIRS,13,3,9
		SIF FLAG:現X == 3 && FLAG:現Y == 9
			CALL DUNGEON_UPSTAIRS,13,13,7
	CASE 13
		SIF FLAG:現X == 7 && FLAG:現Y == 5
			CALL DUNGEON_UPSTAIRS,14,7,5
		SIF FLAG:現X == 9 && FLAG:現Y == 11
			CALL DUNGEON_UPSTAIRS,14,9,11
	CASE 14
		SIF FLAG:現X == 7 && FLAG:現Y == 7
			CALL DUNGEON_UPSTAIRS,15,7,3
	CASEELSE
ENDSELECT
RETURN 1

@DOWNSTAIRS_79
SELECTCASE FLAG:現M
	CASE 1
		SIF FLAG:現X == 1 && FLAG:現Y == 1
			CALL DUNGEON_DOWNSTAIRS,0,1,1
		SIF FLAG:現X == 1 && FLAG:現Y == 15
			CALL DUNGEON_DOWNSTAIRS,0,1,15
		SIF FLAG:現X == 15 && FLAG:現Y == 1
			CALL DUNGEON_DOWNSTAIRS,0,15,1
		SIF FLAG:現X == 15 && FLAG:現Y == 15
			CALL DUNGEON_DOWNSTAIRS,0,15,15
	CASE 2
		SIF FLAG:現X == 3 && FLAG:現Y == 1
			CALL DUNGEON_DOWNSTAIRS,1,2,1
		SIF FLAG:現X == 15 && FLAG:現Y == 3
			CALL DUNGEON_DOWNSTAIRS,1,14,1
		SIF FLAG:現X == 1 && FLAG:現Y == 13
			CALL DUNGEON_DOWNSTAIRS,1,2,15
		SIF FLAG:現X == 13 && FLAG:現Y == 15
			CALL DUNGEON_DOWNSTAIRS,1,14,15
	CASE 3
		SIF FLAG:現X == 1 && FLAG:現Y == 1
			CALL DUNGEON_DOWNSTAIRS,2,1,1
		SIF FLAG:現X == 1 && FLAG:現Y == 15
			CALL DUNGEON_DOWNSTAIRS,2,1,15
		SIF FLAG:現X == 15 && FLAG:現Y == 1
			CALL DUNGEON_DOWNSTAIRS,2,15,1
		SIF FLAG:現X == 15 && FLAG:現Y == 15
			CALL DUNGEON_DOWNSTAIRS,2,15,15
	CASE 4
		SIF FLAG:現X == 3 && FLAG:現Y == 3
			CALL DUNGEON_DOWNSTAIRS,3,5,3
		SIF FLAG:現X == 11 && FLAG:現Y == 10
			CALL DUNGEON_DOWNSTAIRS,3,13,11
	CASE 5
		SIF FLAG:現X == 3 && FLAG:現Y == 5
			CALL DUNGEON_DOWNSTAIRS,4,3,5
		SIF FLAG:現X == 13 && FLAG:現Y == 10
			CALL DUNGEON_DOWNSTAIRS,4,13,10
	CASE 6
		SIF FLAG:現X == 3 && FLAG:現Y == 3
			CALL DUNGEON_DOWNSTAIRS,5,3,3
		SIF FLAG:現X == 11 && FLAG:現Y == 10
			CALL DUNGEON_DOWNSTAIRS,5,11,10
	CASE 7
		SIF FLAG:現X == 5 && FLAG:現Y == 3
			CALL DUNGEON_DOWNSTAIRS,6,3,5
		SIF FLAG:現X == 13 && FLAG:現Y == 10
			CALL DUNGEON_DOWNSTAIRS,6,13,10
	CASE 12
		SIF FLAG:現X == 13 && FLAG:現Y == 7
			CALL DUNGEON_DOWNSTAIRS,11,13,7
		SIF FLAG:現X == 3 && FLAG:現Y == 9
			CALL DUNGEON_DOWNSTAIRS,11,3,9
	CASE 13
		SIF FLAG:現X == 3 && FLAG:現Y == 9
			CALL DUNGEON_DOWNSTAIRS,12,3,9
		SIF FLAG:現X == 3 && FLAG:現Y == 9
			CALL DUNGEON_DOWNSTAIRS,12,13,7
	CASE 14
		SIF FLAG:現X == 7 && FLAG:現Y == 5
			CALL DUNGEON_DOWNSTAIRS,13,7,5
		SIF FLAG:現X == 9 && FLAG:現Y == 11
			CALL DUNGEON_DOWNSTAIRS,13,9,11
	CASE 15
		SIF FLAG:現X == 7 && FLAG:現Y == 3
			CALL DUNGEON_DOWNSTAIRS,14,7,7
	CASEELSE
ENDSELECT
RETURN 1
;=======================================================================
;エレベーター
;=======================================================================
@DUNGEON_ELEVATOR_79, ARG
VARSET RESULT, -1
VARSET RESULTS

IF FLAG:現M < 8

RESULT:1 = 1
RESULT:2 = 2
RESULT:3 = 3
RESULT:4 = 4
RESULT:5 = 5
RESULT:6 = 6
RESULTS:1 = ２Ｆ
RESULTS:2 = ３Ｆ
RESULTS:3 = ４Ｆ
RESULTS:4 = ５Ｆ
RESULTS:5 = ６Ｆ
RESULTS:6 = ７Ｆ
RETURN -1

ENDIF

SELECTCASE ARG
	CASE 19
		RESULT:1 = 8
		RESULT:2 = 9
		RESULT:3 = 10
		RESULT:4 = 11
		RESULT:5 = 12
		RESULTS:1 = １Ｆ
		RESULTS:2 = ４Ｆ
		RESULTS:3 = ８Ｆ
		RESULTS:4 = １３Ｆ
		RESULTS:5 = １５Ｆ
		RETURN -1
	CASE 29
		RESULT:1 = 8
		RESULT:2 = 9
		RESULT:3 = 10
		RESULT:4 = 11
		RESULT:5 = 12
		RESULTS:1 = １Ｆ
		RESULTS:2 = ４Ｆ
		RESULTS:3 = ８Ｆ
		RESULTS:4 = １３Ｆ
		RESULTS:5 = １５Ｆ
		RETURN -1
	CASE 39
		RESULT:1 = 12
		RESULT:2 = 13
		RESULT:3 = 14
		RESULTS:1 = １５Ｆ
		RESULTS:2 = １７Ｆ
		RESULTS:3 = １９Ｆ
		RETURN -1
	CASE 49
		RESULT:1 = 12
		RESULT:2 = 13
		RESULT:3 = 14
		RESULTS:1 = １５Ｆ
		RESULTS:2 = １７Ｆ
		RESULTS:3 = １９Ｆ
		RETURN -1
ENDSELECT

;=======================================================================
;宝箱の中身
;=======================================================================
@TRESURING_CALLING_79
#LOCALSIZE 3
LOCAL = FLAG:現M + 10

LOCAL:1 = (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
		CASE 300
			CALL GET_TREASURE_MONEY, 1 , 100 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 400
			CALL GET_TREASURE, [[アイテム:Revenge Gauntlet]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 500
			CALL GET_TREASURE, [[アイテム:Sword of Light]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 700		
			CALL GET_TREASURE, [[アイテム:MegidoStone]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 701
			CALL GET_TREASURE, [[アイテム:AgIncense]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 702		
			CALL GET_TREASURE, [[アイテム:Ｍ249 Minimi]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 900
			CALL GET_TREASURE, [[アイテム:Bead]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 901
			CALL GET_TREASURE, [[アイテム:CoreShield]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 1100
			CALL GET_TREASURE, [[アイテム:InIncense]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 1101
			CALL GET_TREASURE, [[アイテム:StunGrenade]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 1300
			CALL GET_TREASURE, [[アイテム:極寒の勾玉]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
		CASE 1301
			CALL GET_TREASURE, [[アイテム:Crescent Blade]] , 1 , FLAG:現ダンジョン, LOCAL , LOCAL:1
	ENDSELECT
RETURN 1


;========
;罠置き場
;========
@TRAP_79
SELECTCASE FLAG:現M
	CASE 1
		IF  FLAG:現X == 7 && FLAG:現Y == 9
			CALL MESSAGE_WINDOW_D, "", "＞It's a pitfall!"
			CALL DUNGEON_WORP, FLAG:現M-1, FLAG:現X,  FLAG:現Y
		ELSEIF  FLAG:現X == 8 && FLAG:現Y == 13
			CALL DUNGEON_TRAP_POISON,40
		ELSE
			CALL DUNGEON_TRAP_HP,15
		ENDIF
	CASE 8
		CALL DUNGEON_TRAP_HP,15
	CASE 15
		CALL DUNGEON_TRAP_MP,10
	CASEELSE
		CALL MESSAGE_WINDOW_D, "", "＞It's a pitfall!"
		;落とし穴だ！
				CALL DUNGEON_WORP, FLAG:現M-1, FLAG:現X,  FLAG:現Y
	ENDSELECT

;=======================================================================
;エンカウント率
;=======================================================================
@ENCOUNT_RATE_79

SELECTCASE FLAG:現M
	CASE 8,9,10,11,12,13
		FLAG:エンカウント率 = 5 + FLAG:未遭遇歩数*5
	CASE 14,15
		FLAG:エンカウント率 = 10 + FLAG:未遭遇歩数*5
	CASEELSE
		FLAG:エンカウント率 = FLAG:未遭遇歩数*5
ENDSELECT
SIF FLAG:未遭遇歩数 < 5
	FLAG:エンカウント率 = 0
;=======================================================================
;必要レベル目安
;推奨LV 雑魚最低LV 雑魚最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_79
RETURN 40, 34, 43, 60 

;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_79
IF RAND:100 < FLAG:エンカウント率
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	FLAG:未遭遇歩数 += 1
	RETURN 0
ENDIF
;=======================================================================
;敵の種族の種類数
;=======================================================================
@CLASS_NUM_79
RETURN CLASS_NUM_COMMON("上級")
;=======================================================================
;敵の総数
;ARGは出現する敵の種類です
;=======================================================================
@ENEMY_NUM_79, ARG
RETURN ENEMY_NUM_COMMON("上級", ARG)
;=======================================================================
;敵の種類
;=======================================================================
@ENEMY_79, ARG
SELECTCASE FLAG:現M
	CASE 0,1,2,
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:ナーガ]], 34
			CASE IS < 55
				RETURN [[キャラ:ユキジョロウ]], 34
			CASE IS < 70
				RETURN [[キャラ:パワー]], 35
			CASE IS < 85
				RETURN [[キャラ:カラステング]], 35
			CASE IS < 100
				RETURN [[キャラ:カワンチャ]], 35
		ENDSELECT
	CASE 3,4,5,6,7
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:ビフロンス]], 37
			CASE IS < 55
				RETURN [[キャラ:ガシャドクロ]], 39
			CASE IS < 70
				RETURN [[キャラ:カラステング]], 38
			CASE IS < 85
				RETURN [[キャラ:チン]], 38
			CASE IS < 100
				RETURN [[キャラ:コープス]], 37
			ENDSELECT
	CASE 8,9,10,11,12,13
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:レギオン]], 41
			CASE IS < 55
				RETURN [[キャラ:スプリガン]], 43
			CASE IS < 70
				RETURN [[キャラ:チン]], 40
			CASE IS < 85
				RETURN [[キャラ:サキュバス]], 40
			CASE IS < 100
				RETURN [[キャラ:ガシャドクロ]], 40
			ENDSELECT
	CASEELSE
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:バジリスク]], 43
			CASE IS < 55
				RETURN [[キャラ:サキュバス]], 44
			CASE IS < 70
				RETURN [[キャラ:くちさけ]], 42
			CASE IS < 85
				RETURN [[キャラ:アマゾーン]], 43
			CASE IS < 100
				RETURN [[キャラ:ヴァーチャー]], 43
			ENDSELECT	
ENDSELECT

;=======================================================================
;輪姦参加悪魔
;=======================================================================
@DUNGEON_RAPE_DEVIL_79
;ランダムにどの悪魔が出るか決定
;RETURN CSV番号 , 人数 , レベル
SELECTCASE RAND:3
	CASE 0
		RETURN [[キャラ:ナーガ]] , 3 + RAND:10 , CSVBASE([[キャラ:ナーガ]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 1
		RETURN [[キャラ:ナーガ・ラジャ]] , 3 + RAND:10 , CSVBASE([[キャラ:ナーガ・ラジャ]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 2
		RETURN [[キャラ:コープス]] , 3 + RAND:10 , CSVBASE([[キャラ:コープス]] , GETNUM(BASE , "LV") , 0) + RAND:3
ENDSELECT