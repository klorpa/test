
;=======================================================================
;森本病院
;=======================================================================
;=======================================================================
;攻略条件
;=======================================================================
@PREREQUISITE_DUNGEON_54
SIF STRFLAG_NUM_EV("罰ルート進行", , , , [[イベント:ペルソナ２]]) == 3
	RETURN 1
RETURN 0



;=======================================================================
;ダンジョン名
;=======================================================================
@GET_DUNGEON_NAME_54
RESULTS = Morimoto Hospital

;=======================================================================
;指定したマスに進入可能か
;=======================================================================
@CAN_ENTER_54, ARG, ARG:1
RESULT = 1
SELECTCASE DA:ARG:(ARG:1)
	CASE 12
	PRINTW ＞すでに須藤 竜蔵の配下が来ている
	PRINTW ＞出直す時間はない
	RETURN 0
;トリッシュの泉
	CASE 22
	CALL FOUNTAIN_OF_TRISH
	RETURN 0
	CASEELSE
		CALL CAN_ENTER,ARG,ARG:1
	ENDSELECT
RETURN RESULT
;=======================================================================
;泉のセーブの価格
;=======================================================================
@PRICE_OF_SAVE_54
RETURN 100, 400

;=======================================================================
;フロア名表示
;=======================================================================
@FLOORNAME_54
SELECTCASE FLAG:現M
	CASE 0
		PRINTL １Ｆ
	CASE 1
		PRINTL ２Ｆ
	CASE 2
		PRINTL ３Ｆ
	CASE 3
		PRINTL ４Ｆ
ENDSELECT

;=======================================================================
;特殊タイル表示
;=======================================================================
;時計台
@TILE_MARK_ID_54_3_3004
SETCOLOR 0x990000
RESULTS = ！
;=======================================================================
;フロアデータ
;=======================================================================
@MAKE_FLOOR_54
SELECTCASE FLAG:現M
	CASE 0
		FLAG:最大X = 30
		FLAG:最大Y = 16
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"                              "
		CALL MAKE_FLOOR_LINE, 1,"     111                126   "
		CALL MAKE_FLOOR_LINE, 2,"     111                1     "
		CALL MAKE_FLOOR_LINE, 3,"     111                1     "
		CALL MAKE_FLOOR_LINE, 4,"      G                 1     "
		CALL MAKE_FLOOR_LINE, 5,"  111 1                 1 111 "
		CALL MAKE_FLOOR_LINE, 6,"  11121                 12111 "
		CALL MAKE_FLOOR_LINE, 7,"  331 1                 1 111 "
		CALL MAKE_FLOOR_LINE, 8,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 9,"  111 1                 1 111 "
		CALL MAKE_FLOOR_LINE,10,"  111t1                 12111 "
		CALL MAKE_FLOOR_LINE,11,"  111 1111111111111111111 113 "
		CALL MAKE_FLOOR_LINE,12,"        2  2  111  2  2       "
		CALL MAKE_FLOOR_LINE,13,"        8  1  111  1  1       "
		CALL MAKE_FLOOR_LINE,14,"               G              "
		CALL MAKE_FLOOR_LINE,15,"               1              "
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
		;1個目の特殊扉は番号ずらすよう
	CASE 1
		FLAG:最大X = 30
		FLAG:最大Y = 16
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"                              "
		CALL MAKE_FLOOR_LINE, 1,"    621                 126   "
		CALL MAKE_FLOOR_LINE, 2,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 3,"      1                 127   "
		CALL MAKE_FLOOR_LINE, 4,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 5,"    821                 121   "
		CALL MAKE_FLOOR_LINE, 6,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 7,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 8,"    121                 121   "
		CALL MAKE_FLOOR_LINE, 9,"      1                 1     "
		CALL MAKE_FLOOR_LINE,10,"      1                 1     "
		CALL MAKE_FLOOR_LINE,11,"      1111111111111111111     "
		CALL MAKE_FLOOR_LINE,12,"        2  2  111  2  2       "
		CALL MAKE_FLOOR_LINE,13,"        1  1  113  1  1       "
		CALL MAKE_FLOOR_LINE,14,"                              "
		CALL MAKE_FLOOR_LINE,15,"                              "
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
	CASE 2
		FLAG:最大X = 30
		FLAG:最大Y = 16
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"                              "
		CALL MAKE_FLOOR_LINE, 1,"    621                 126   "
		CALL MAKE_FLOOR_LINE, 2,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 3,"    721                 127   "
		CALL MAKE_FLOOR_LINE, 4,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 5,"    121                 121   "
		CALL MAKE_FLOOR_LINE, 6,"      1                 1     "
		CALL MAKE_FLOOR_LINE, 7,"      1 1  1       1  1 1     "
		CALL MAKE_FLOOR_LINE, 8,"    121 2  2       2  2 121   "
		CALL MAKE_FLOOR_LINE, 9,"      1111111111111111111     "
		CALL MAKE_FLOOR_LINE,10,"      1                 1     "
		CALL MAKE_FLOOR_LINE,11,"      1111111111111111111     "
		CALL MAKE_FLOOR_LINE,12,"        2  2  111  2  2       "
		CALL MAKE_FLOOR_LINE,13,"        1  1  111  4  1       "
		CALL MAKE_FLOOR_LINE,14,"                              "
		CALL MAKE_FLOOR_LINE,15,"                              "
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
	CASE 3
		FLAG:最大X = 30
		FLAG:最大Y = 16
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"                              "
		CALL MAKE_FLOOR_LINE, 1,"                              "
		CALL MAKE_FLOOR_LINE, 2,"      11               11     "
		CALL MAKE_FLOOR_LINE, 3,"    7211               1127   "
		CALL MAKE_FLOOR_LINE, 4,"      1                1      "
		CALL MAKE_FLOOR_LINE, 5,"    121                1      "
		CALL MAKE_FLOOR_LINE, 6,"      1                1      "
		CALL MAKE_FLOOR_LINE, 7,"      1                1124   "
		CALL MAKE_FLOOR_LINE, 8,"    121                       "
		CALL MAKE_FLOOR_LINE, 9,"      1                       "
		CALL MAKE_FLOOR_LINE,10,"      1                       "
		CALL MAKE_FLOOR_LINE,11,"      111111111111111111      "
		CALL MAKE_FLOOR_LINE,12,"        2  2  111  2  2       "
		CALL MAKE_FLOOR_LINE,13,"        1  4  133  1  1       "
		CALL MAKE_FLOOR_LINE,14,"                              "
		CALL MAKE_FLOOR_LINE,15,"                              "
		;						 000000000011111111112222222222
		;						 012345678901234567890123456789
ENDSELECT
;=======================================================================
;タイル調整
;=======================================================================
@MAKE_FLOOR_LINE_COMMON_54, ARG, ARG:1, ARG:2
#LOCALSIZE 30
;LOCAL:3 宝箱 ダンジョンフラグ:75~99
;LOCAL:4 イベント
;LOCAL:8 メッセンジャー
;(0/0)でLOCALを消去
SIF ARG:1 == 0 && ARG:2 == 0
	VARSET LOCAL
IF ARG == 3
	IF GETBIT(ダンジョンフラグ:(FLAG:現ダンジョン):(FLAG:現M+75), LOCAL:3)
		DA:(ARG:1):(ARG:2) = 1
	ELSE
		DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:3 * 10 + 3
	ENDIF
	LOCAL:3++
ENDIF
;イベント扉
IF ARG == 12
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:2 * 10 + 2
	LOCAL:2++
ENDIF
IF ARG == 4
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:4 * 10 + 4
	LOCAL:4++
	SELECTCASE DA:(ARG:1):(ARG:2) / 10
		CASE 301
			SIF STRFLAG_D("ノリコ") || STRFLAG_NUM_EV("セブンスの闇の噂", , , , [[イベント:噂]]) < 2
				DA:(ARG:1):(ARG:2) = 1
	ENDSELECT
ENDIF
IF ARG == 6
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:6 * 100 + 6
	LOCAL:6++
ENDIF
IF ARG == 7
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:7 * 100 + 7
	LOCAL:7++
ENDIF
IF ARG == 8
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:8 * 10 + 8
	LOCAL:8++
	SELECTCASE DA:(ARG:1):(ARG:2) / 10
	ENDSELECT
ENDIF
;=======================================================================
;タイル定義
;=======================================================================
@DEFINE_TILES_54, ARGS, ARG, ARG:1
;G イベント扉
SIF ARGS == "G"
	RETURN 12
SIF ARGS == "t"
	RETURN 22
;=======================================================================
;ダンジョン突入時のイベント
;=======================================================================
@START_DUNGEON_54, ARG
FLAG:現M = 0
FLAG:現X = 15
FLAG:現Y = 13
FLAG:脱出スキル禁止 = 1
PRINTFORMW ＞病院に入ると、濃密な血の匂いが鼻腔をついた…
PRINTFORML ＞あたりを見渡すと、血まみれの死体がいくつか転がっている
PRINTFORMW ＞死体はギャングといったなりをしており、病院の職員にも、患者にも見えない
PRINTFORML ＞%CALLNAME:MASTER%が詳しく死体を調べようとしたとき、奥から男達が現れた
PRINTFORMW ＞服装からみて、死んでいる男達の仲間だろう
PRINTL 
PRINTL 男:
PRINTL 「オマエ、サマナーか？」
PRINTW 　オマエがアクマなんて呼び出したのか？」
PRINTW 「許さナイよ！」
PRINTL 
PRINTFORML ＞%CALLNAME:MASTER%が口を開く前に、男達は襲いかかってきた！
CUSTOMDRAWLINE =
WAIT
FLAG:逃走不可フラグ = 1
FLAG:会話不能フラグ = 1
FLAG:先制不意打ちキャンセル = 1
CALL SET_ENEMY,8,[[キャラ:ファンレン]], 13
CALL SET_ENEMY,9,[[キャラ:ファンレン]], 13
CALL SET_ENEMY,10,[[キャラ:ファンレン]], 13
CALL SET_ENEMY,14,[[キャラ:リュウマン]], 15
CALL BATTLE_START
FLAG:逃走不可フラグ = 0
FLAG:会話不能フラグ = 0
FLAG:先制不意打ちキャンセル = 0
;=======================================================================
;タイル進入時のイベント
;=======================================================================
@EVENT_ENTER_DUNGEON_54,ARG
;ARG = 進入時の向き　0の場合ワープなど
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) % 10
CASE 1
	SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	ENDSELECT
;==========
;出口の処理　出口はない
;==========
;==========
;扉の処理
;==========
CASE 2
	CALL DUNGEON_DOOR,ARG
;宝の処理
;========
	CASE 3
		CALL TREASURE_54, DA:(FLAG:現X):(FLAG:現Y) / 10
		RETURN 1
;=======
;イベント
;=======
	CASE 4
		CALL EVENT_54
		RETURN 1
;=======
;階段
;=======
	CASE 6
		CALL STAIR_54, 6
		RETURN 1
	CASE 7
		CALL STAIR_54, 7
		RETURN 1
;=======
;メッセンジャー
;=======
	CASE 8
		CALL MESSAGE_54
		RETURN 1
;=======
;特殊タイル
;=======
	CASE 9
ENDSELECT
@EVENT_CHECK_DUNGEON_54
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) % 10
;==========
;出口の処理　出口はない
;==========
;========
;宝の処理
;========
	CASE 3
		CALL TREASURE_54, DA:(FLAG:現X):(FLAG:現Y) / 10
		RETURN 1
;=======
;イベント
;=======
	CASE 4
		CALL EVENT_54
		RETURN 1
;=======
;階段
;=======
	CASE 6
		CALL STAIR_54, 6
		RETURN 1
	CASE 7
		CALL STAIR_54, 7
		RETURN 1
;=======
;メッセンジャー
;=======
	CASE 8
		CALL MESSAGE_54
		RETURN 1
	CASEELSE
		PRINTW Nothing seems to be here.
		RETURN 0
ENDSELECT
@TREASURE_54, ARG
#LOCALSIZE 1
#LOCALSSIZE 1
;個数,-1のとき、魔貨・0の時、\となる
LOCAL = 1
;IDは現M*100＋X個目の宝箱の法則でふられている
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 0
		LOCALS = Medicine
		LOCAL = 3
	CASE 1
		LOCALS = ValueMedicine
		LOCAL = 3
	CASE 2
		LOCALS = Dis-Poison
		LOCAL = 2
	CASE 100
		LOCALS = ￥
		LOCAL = 13700
	CASE 300
		LOCALS = OxBezoar
		LOCAL = 2
	CASE 301
		LOCALS = ￥
		LOCAL = 12600
ENDSELECT
IF LOCALS == "￥"
	CALL GET_TREASURE_MONEY, 0, LOCAL, FLAG:現ダンジョン, FLAG:現M + 75, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSEIF LOCALS == "魔貨"
	CALL GET_TREASURE_MONEY, 1, LOCAL, FLAG:現ダンジョン, FLAG:現M + 75, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSEIF LOCALS == "MAG" || LOCALS == "ＭＡＧ"
	CALL GET_TREASURE_MAG, 0, LOCAL, FLAG:現ダンジョン, FLAG:現M + 75, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSEIF LOCALS == "罠"
	;LOCALS:1 種類 LOCAL ダメージ量or確率 LOCALS:2 相性
	;CALL GET_TREASURE_TRAP, LOCALS:1, LOCAL, GET_TYPE_NUM(LOCALS:2), FLAG:現ダンジョン, FLAG:現M + 75, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSE
	IF GETNUM(ITEM, LOCALS) == -1
		PRINTL ＞アイテム名の指定が間違ってます
		PRINTW ＞アイテムの取得処理を中断します
	ELSE
		CALL GET_TREASURE, GETNUM(ITEM, LOCALS), LOCAL , FLAG:現ダンジョン, FLAG:現M + 75, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
	ENDIF
ENDIF


;=======================================================================
;階段
;=======================================================================
@STAIR_54, ARG
IF ARG == 6
	CALL DUNGEON_UPSTAIRS_ID, FLAG:現M+1, DA:(FLAG:現X):(FLAG:現Y)+1001
ELSE
	CALL DUNGEON_DOWNSTAIRS_ID, FLAG:現M-1, DA:(FLAG:現X):(FLAG:現Y)-1001
ENDIF

;=======================================================================
;イベント
;=======================================================================
@EVENT_54
#LOCALSIZE 2
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) /10
	CASE 200
		PRINTL ＞病室には誰もいない
		PRINTL ＞しかし、壁中に怪しげな図面や文字がかきつけてある
		PRINTW ＞壁の文字を読みますか？
		CALL INPUT_YN
		PRINTW 『マイアの託宣』
		PRINTL 『空に瞬く昴の星に　止まった刻は動き出す
		PRINTL 　享楽の舞　影達の宴　異国の詠
		PRINTW 　贖罪の迎え火は天を照らし…』
		PRINTL 『獅子の咆哮はあまねく響く
		PRINTL 　冥府に輝くは五なる髑髏
		PRINTW 　天上に輝くは聖なる十字架…』
		PRINTL 『天に昇りて星が動きを止めると時
		PRINTL 　マイヤの乙女の鼓動も止まる
		PRINTW 　後に残るは地上の楽園　そして刻は繰り返す』
	CASE 300
		PRINTW ＞いくつもの死体が転がっている部屋の中に剣をもった白衣の男がいる
		PRINTL 
		PRINTL 白衣の男:
		PRINTL 「よぉ、見てたぜぇ
		PRINTL 　俺にかわって、クソ親父の手下どもを倒してくれてたなぁ
		PRINTW 　一応、例は言っておいてやるよ」
		PRINTL 「電波が言ってたぜ
		PRINTW 　俺が使命を果たすのを手伝ってくれる奴が現れるってな」
		PRINTW 「俺は須藤 竜也……ＪＯＫＥＲだ」
		PRINTL 「電波の注文もうるさくてこまるよなぁ？
		PRINTW 　なぁ、あんたにもわかるよなぁ？」
		PRINTL 「そう…生贄がな、いるってんだ
		PRINTL 　こう、生きたまま胸かっさばいてよ…
		PRINTW 　その前に、動けねぇように手足の腱切るんだ」
		PRINTL 「電波はなぁ、なんでも教えてくれんだよ
		PRINTW 　あのクソ親父がよ、俺をこうしたんだぜ」
		PRINTL 「だから、三下どもはいくらでも譲ってやるが
		PRINTL 　クソ親父は俺のこの手でぶちころしてやらなきゃいけねぇんだ」
		PRINTW 　そこんところはよろしく頼むぜ」
		PRINTL 
		PRINTW ＞突然、音楽が鳴り出した
		PRINTW ＞竜也は携帯電話を取り出す
		PRINTL 
		PRINTL 竜也:
		PRINTW 「シーッ。電話だ」
		PRINTL 「ああ、わかった…すぐに殺してやる
		PRINTW 　任せとけ」
		PRINTL 
		PRINTW ＞竜也は電話をしまうと笑い出した
		PRINTL 
		PRINTL 竜也：
		PRINTL 「ヒャハ！　殺しはよぉ、昔は好きでやってたが、
		PRINTW 　今は街の人間が電話かけてくっからやってるだけだぜぇ…」
		PRINTL 「それがまた、忙しくてなぁ
		PRINTL 　親父を殺しにいく暇も、魔女を殺しに行く暇もねぇくらいだぜ
		PRINTW 　みんな、ころしてーやつがいるんなら、自分で殺しゃいいのによぉ」
		IF STRFLAG_D("ノリコ保護")
			PRINTL 
			PRINTW ＞そう言って、竜也はノリコを見た
			PRINTFORMW ＞ノリコは俯くと%CALLNAME:MASTER%の腕を強く握った
			PRINTL 
			PRINTL 竜也:
		ENDIF
		PRINTL 「俺の本当の役目はよぉ…間違いを正すことなんだよ
		PRINTW 　『こっち側』は間違いで、『向こう側』が正しいんだ」
		PRINTL 「クソ親父は、そこんとこがわかっちゃいねぇ…
		PRINTW 　あんたにも、わかんだろ？」
		PRINTL 「そうだ。もうすぐ、もうすぐ間違いは正せる
		PRINTL 　もう招待状はだしたんだ
		PRINTW 　あのくそ忌々しい空の科学館にあの方と魔女がやってくる」
		PRINTL 「そこで俺達は宿敵を打ち倒し、指導者を得るんだ
		PRINTL 　ヒャハ！　そうしたらもう俺達は無敵だ！
		PRINTW 　もう誰にも止めらんねぇ！　ヒャハハハハハ！」
		PRINTL 
		PRINTW ＞突然、ドアが開かれ、男達がなだれこんだ
		PRINTL 
		PRINTL 竜也:
		PRINTL 「ちっ、クソ親父の手下どもか
		PRINTL 　人が友達と楽しくお喋りしてるってのに
		PRINTW 　うっとおしいじゃねえか」
		PRINTL 「はらわたひきずりだして、ぐちゃぐちゃにしてやる
		PRINTL 　……っていいたいところだが、ちょうど仕事がはいっちまって
		PRINTW 　もういかなきゃいけねぇんだ」
		PRINTL 「そういうわけで、ここはあんたに任せるぜ」
		PRINTL 
		PRINTL ＞須藤 竜也は姿を消した
		PRINTW ＞そして、男達が襲いかかってきた…！
		PRINTL 
		FLAG:逃走不可フラグ = 1
		FLAG:会話不能フラグ = 1
		FLAG:先制不意打ちキャンセル = 1
		CALL SET_ENEMY,7,[[キャラ:ファンレン]], 16
		CALL SET_ENEMY,8,[[キャラ:ファンレン]], 16
		CALL SET_ENEMY,9,[[キャラ:ファンレン]], 16
		CALL SET_ENEMY,10,[[キャラ:ファンレン]], 16
		CALL SET_ENEMY,11,[[キャラ:ファンレン]], 16
		CALL SET_ENEMY,12,[[キャラ:リュウマン]], 18
		CALL SET_ENEMY,13,[[キャラ:リュウマン]], 18
		CALL SET_ENEMY,14,[[キャラ:リュウマン]], 20
		CALL SET_ENEMY,15,[[キャラ:リュウマン]], 18
		CALL SET_ENEMY,16,[[キャラ:リュウマン]], 18
		FOR LOCAL, 7, 17
			LOCAL:1 = FLAG:戦闘難易度 - 3 > 0 ? 300 + (FLAG:戦闘難易度 - 3) * 50 # 250
			CALL SET_BATTLE_STATUS(POS(LOCAL), MAXBASE:POS(LOCAL):ＨＰ * LOCAL:1 / 100, "ＨＰ")
			CALL SET_BATTLE_STATUS(POS(LOCAL), MAXBASE:POS(LOCAL):攻撃*3/2, "銃攻撃")
			CALL HEALTH_CHARA, POS(LOCAL)
			SELECTCASE LOCAL
				CASE 7, 8, 9, 10, 11
					ABL:POS(LOCAL):スキル4 = [[スキル:SpiralBomb]]
					ABL:POS(LOCAL):スキル5 = [[スキル:ValueMedicine]]
				CASE 12, 13
					ABL:POS(LOCAL):スキル4 = [[スキル:Corona Shell]]
					ABL:POS(LOCAL):スキル5 = [[スキル:Corona Shell]]
				CASE 14
					ABL:POS(LOCAL):スキル4 = [[スキル:ランタンショット]]
					ABL:POS(LOCAL):スキル5 = [[スキル:ランタンショット]]
				CASE 15, 16
					ABL:POS(LOCAL):スキル4 = [[スキル:フロストショット]]
					ABL:POS(LOCAL):スキル5 = [[スキル:フロストショット]]
			ENDSELECT
		NEXT
		CALL BATTLE_START
		FLAG:逃走不可フラグ = 0
		FLAG:会話不能フラグ = 0
		FLAG:先制不意打ちキャンセル = 0
		FLAG:脱出 = 1
		CUSTOMDRAWLINE =
		WAIT
		PRINTFORMW >男達を倒した
		PRINTFORMW >ターゲットもいなくなってしまったので、増援が来て厄介なことになる前に
		PRINTFORMW >%CALLNAME:MASTER%は病院を脱出することにした……
		CALLF STRFLAG_NUM_EV("罰ルート進行", "=", , 4, [[イベント:ペルソナ２]])
		IF STRFLAG_D("ノリコ保護")
			CUSTOMDRAWLINE =
			WAIT
			PRINTW ＞無事、蝸牛山を下り、珠閒瑠市の市街地までやってきた
			PRINTL 
			PRINTL ノリコ:
			PRINTL 「ここまで来れば、大丈夫ですね
			PRINTW 　ありがとうございます。おかげで助かりました…」
			PRINTL 「でも、どうしてわたしなんかが助かっちゃったんだろう…
			PRINTW 　病院の人は助からなかったのに、ＪＯＫＥＲ呪いをしたわたしが助かるなんておかしいです」
			PRINTL 「……やっぱり、本当にＪＯＫＥＲ呪いしちゃったんですよねわたし
			PRINTL 　あの病院にいれられて、ＪＯＫＥＲ呪いをしたのも、人が死んだのも、
			PRINTW 　ＪＯＫＥＲになっちゃったのも全部妄想で、病気のせいなんじゃないかっておもったりしたけど…」
			PRINTL 「さっきのことでわかりました
			PRINTW 　やっぱり、現実だったんだって…」
			PRINTL 「あの日、本当に校長先生が死んだのかどうか見に行って…
			PRINTW 　そうしたら、校長先生が死んでて、さっきのＪＯＫＥＲにあって……」
			PRINTL 「そこで、言われたんです
			PRINTL 　ＪＯＫＥＲはわたしのなかにもいるって
			PRINTW 　こんどはわたしがＪＯＫＥＲの仕事を手伝う番だって」
			PRINTW 「それからＪＯＫＥＲが手を伸ばしてきて……気づいたら……」
			PRINTL 「わたし、怖いんです。またＪＯＫＥＲになって、こんどは本当に人殺しになるんじゃないかって
			PRINTW 　いつＪＯＫＥＲになるかわからないのに、みんなの傍で暮らすなんてできません」
			PRINTL 
			PRINTW ＞ノリコはそういうと泣き出してしまった……
			PRINTL 
			CALL INPUT_YN("励ます", "奴隷になることを薦める")
			IF RESULT == 0
				PRINTFORML ＞%CALLNAME:MASTER%はフィレモンから聞いたとおり、
				PRINTFORML ＞これから、再びＪＯＫＥＲになるかどうかは
				PRINTFORMW ＞これからのノリコ次第だということを伝えて励ました
				PRINTL 
				PRINTL ノリコ:
				PRINTL 「これからのわたし次第……
				PRINTW 　でも、わたしなんか……」
				PRINTL 「いえ、こんな事言ってちゃだめですよね
				PRINTL 　せっかくサマナーさんが助けてくれたんだから
				PRINTW 　その分、しっかり頑張らないと……」
				PRINTL 「ねぇ、サマナーさん。わたし、憧れている人がいるんです
				PRINTL 　その人はすごい綺麗な走り方をする人だったんですけど交通事故で走れなくなって
				PRINTW 　やけになっちゃって、悪い人たちの仲間になっちゃって……みんなに見捨てられて」
				PRINTL 「でも、わたし、そのひとに諦めないでまた頑張って欲しいっていっちゃったんです…
				PRINTW 　それなのにわたしが、自分には無理とかいって諦めちゃだめですよね
				PRINTL 「わたし、頑張ってみます
				PRINTL 　ＪＯＫＥＲなんかに負けないように
				PRINTW 　そして、サマナーさんみたいに人を助けられる人になりたいです」
				PRINTW 「わたし、絶対、今日のことを、サマナーさんのことを忘れません！」
				PRINTL 
				PRINTFORMW ＞ノリコの表情に強い決意が見える
				PRINTFORMW ＞%CALLNAME:MASTER%はそんなノリコに別れを告げ、事務所に帰った
				SIF STRFLAG_NUM_EV("フィレモン進行", , , , [[イベント:ペルソナ２]]) == 2
					CALLF STRFLAG_NUM_EV("フィレモン進行", "=", , 3, [[イベント:ペルソナ２]])
			ELSE
				PRINTL ノリコ:
				PRINTW 「……え、奴隷商人ってほんとに？」
				PRINTW 「そう…なんですか…」
				PRINTL 「……わかりました。こんなわたしでいいなら、奴隷にしてください
				PRINTL 　サマナーさんの傍にいられるんなら、いつＪＯＫＥＲになっても安心です
				PRINTW 　こんな風にいつＪＯＫＥＲになることを怯えながら暮らすぐらいなら……奴隷のほうが……」
				PRINTL 
				PRINTW ＞片山 典子を手に入れた
				CALL ADD_NEW_COMPANION,[[キャラ:ノリコ]],1000
				SIF RESULT
					TALENT:(RESULT:1):弱味 = 1
			ENDIF
		ENDIF
	CASE 301
		IF !STRFLAG_D("ノリコ")
			PRINTW ＞病室には少女がいた……
			PRINTL 少女:
			PRINTW 「ひっ……食べないでっ……」
			PRINTW 「ああすいません。てっきり悪魔かと」
			PRINTW 「……あっ、あなたは七姉妹学園に来たサマナーさんですね！？」
			PRINTL 
			PRINTL ＞そういって驚く少女をよくみると、
			PRINTW ＞七姉妹学園でＪＯＫＥＲとして戦った少女だった…
			PRINTL 
			PRINTL 少女:
			PRINTW 「ぼんやりとですが覚えてます……」
			PRINTL 「あのときは申し訳有りませんでした
			PRINTW 　それと、ありがとうございます」
			PRINTL 「はぁよかった…せめて、お礼くらいは言いたいと思っていたんです
			PRINTL 　それがいきなり病院に……いえ、仕方ないといえば仕方ないというか
			PRINTW 　あんなことをしでかして、こんな風に治療してもらえるってあけでありがたいんですが…」
			PRINTL 
			PRINTW ＞少女は現在自分が置かれている状況を忘れてしまっているようだが……
			CALL INPUT_YN("少女を保護する", "少女を拉致する")
			IF RESULT == 0
				PRINTL 少女:
				PRINTL 「保護？　いえ、そんな迷惑をかけるわけには……
				PRINTW 　いえ、こんな状況ですもんね……それじゃあよろしくお願いします」
				PRINTW 「あ、そうだ。わたしは片山 典子です。ノリコって呼んでください」
				PRINTW 「それでは、本当に申し訳有りませんが、よろしくお願いします」
				CALLF STRFLAG_D("ノリコ保護", 1)
			ELSE
				PRINTL 少女:
				PRINTW 「え、ちょっと…きゃあっ……!?」
				PRINTL 
				PRINTW ＞片山 典子を手に入れた
				CALL ADD_NEW_COMPANION,[[キャラ:ノリコ]],200,1
			ENDIF
			CALLF STRFLAG_D("ノリコ", 1)
		ELSE
				PRINTW ＞誰も居ない……
		ENDIF
ENDSELECT

;=====================
;メッセンジャー
;=====================
@TILE_MARK_COMMON_54_8, ARG, ARG:1, ARG:2
SETCOLOR 0x00ff00
RESULTS = ｍ
@MESSAGE_54
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 0
		PRINTL 隠れていた職員:
		PRINTL 「あ…あなた達は…人…間……よね？
		PRINTL 　たたた…助けてちょうだい！
		PRINTW 　悪魔…悪魔が現れたのよ！！」
		PRINTL 「…あの人よ…あの人が悪魔を……
		PRINTL 　３０３号室の患者が…
		PRINTW 　須藤 竜也が悪魔を呼び寄せたのよ！」
		PRINTL 「悪魔が患者や同僚たちに襲いかかって…
		PRINTW 　それから武装した男達がやってきて戦い始めたけど…」
	CASE 100
		PRINTL 隠れていた職員:
		PRINTL 「……あ、あんたは？　サマナーか？
		PRINTW 　竜蔵様が助けをよこしてくれたのか？
		PRINTL 「え？　違う？　そんな……
		PRINTW 　武装した奴らもあんたも竜蔵様の部下じゃないのか…？」
		PRINTL 「そんなバカな！　俺達はあいつの仕事を手伝ってきたんだ！
		PRINTW 　金だけじゃなくて、こんなとき俺たちを助ける義務があるだろう！？」
ENDSELECT
;=======================================================================
;エンカウント率
;=======================================================================
@ENCOUNT_RATE_54
IF FLAG:未遭遇歩数 <= 5
	FLAG:エンカウント率 = 0
ELSE
	FLAG:エンカウント率 = 10 + (FLAG:未遭遇歩数-5) * 5
ENDIF
;=======================================================================
;必要レベル目安
;推奨LV 雑魚最低LV 雑魚最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_54
RETURN 11, 8, 12, 12
;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_54
IF RAND:100 < FLAG:エンカウント率
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	FLAG:未遭遇歩数 += 1
	RETURN 0
ENDIF
;=======================================================================
;敵の種族の種類数
;=======================================================================
@CLASS_NUM_54
;天道連がどうかの判別
ダンジョンフラグ:(FLAG:現ダンジョン):1 = RAND:2
IF ダンジョンフラグ:(FLAG:現ダンジョン):1
	RETURN CLASS_NUM_COMMON("初級")
ELSE
	RETURN RAND(1, 3)
ENDIF
;=======================================================================
;敵の総数
;ARGは出現する敵の種類です
;=======================================================================
@ENEMY_NUM_54, ARG
IF ダンジョンフラグ:(FLAG:現ダンジョン):1
	RETURN ENEMY_NUM_COMMON("初級", ARG)
ELSE
	RETURN RAND(2 + ARG*2, 3 + ARG * 4)
ENDIF
;=======================================================================
;敵の種類
;=======================================================================
@ENEMY_54, ARG
IF ダンジョンフラグ:(FLAG:現ダンジョン):1
	SELECTCASE RAND:100
		CASE IS < 20
			RETURN [[キャラ:パリカー]], 14
		CASE IS < 40
			RETURN [[キャラ:ヨモツシコメ]], 14
		CASE IS < 60
			;20%でピクシー
			RETURN [[キャラ:ネコマタ]], 12
		CASE IS < 75
			;15%でゾンビちゃん
			RETURN [[キャラ:ジャックフロスト]], 15
		CASE IS < 90
			;15%でゾンビくん
			RETURN [[キャラ:ツチグモ]], 15
		CASEELSE
			RETURN [[キャラ:ガギソン]], 12
	ENDSELECT
ELSE
	IF RAND:2
		RETURN [[キャラ:ファンレン]], 13
	ELSE
		RETURN [[キャラ:リュウマン]], 15
	ENDIF
ENDIF
;=================================
;特殊調整
;=================================
@SET_ENEMY_STATUS_54, ARG
SIF GROUPMATCH(NO:ARG, [[キャラ:リュウマン]], [[キャラ:ファンレン]])
	CALL SET_BATTLE_STATUS(ARG, MAXBASE:ARG:攻撃*3/2, "銃攻撃")


;=======================================================================
;輪姦参加悪魔
;=======================================================================
@DUNGEON_RAPE_DEVIL_54
;ランダムにどの悪魔が出るか決定
;RETURN CSV番号 , 人数 , レベル
IF ダンジョンフラグ:(FLAG:現ダンジョン):1
	IF RAND:2
		RETURN [[キャラ:リュウマン]] , 3 + RAND:10 , CSVBASE([[キャラ:リュウマン]] , GETNUM(BASE , "LV") , 0) + RAND:3
	ELSE
		RETURN [[キャラ:ファンレン]] , 3 + RAND:10 , CSVBASE([[キャラ:ファンレン]] , GETNUM(BASE , "LV") , 0) + RAND:3
	ENDIF
ELSE
	SELECTCASE RAND:2
		CASE 0
			RETURN [[キャラ:ツチグモ]] , 3 + RAND:10 , CSVBASE([[キャラ:ツチグモ]] , GETNUM(BASE , "LV") , 0) + RAND:3
		CASE 1
			RETURN [[キャラ:ガギソン]] , 3 + RAND:10 , CSVBASE([[キャラ:ガギソン]] , GETNUM(BASE , "LV") , 0) + RAND:3
	ENDSELECT
ENDIF
