;=======================================================================
;サンプルダンジョン
;ダンジョンのテンプレートみたいなものです
;ダンジョンナンバー0
;=======================================================================




;=======================================================================
;攻略条件
;=======================================================================
@PREREQUISITE_DUNGEON_17
;渋谷クリア
IF ダンジョンフラグ:16:14 == 1
	RETURN 1
ELSE
	RETURN 0
ENDIF

;=======================================================================
;ダンジョン名
;=======================================================================
@GET_DUNGEON_NAME_17
RESULTS = Ikebukuro

;=======================================================================
;フロア名表示
;=======================================================================
@FLOORNAME_17
PRINT Ikebukuro 
SELECTCASE FLAG:現M
	CASE 0
		PRINTL Underground shopping center B2F
		;地下街
	CASE 1
		PRINTL Underground shopping center B1F
	CASE 2
		PRINTL Main street
		;表通り
	CASE 4
		PRINTL Gaean Ikebukuro branch 1F
		;ガイア教・池袋支部
	CASE 5
		PRINTL Gaean Ikebukuro branch 2F
	CASE 6
		PRINTL Gaean Ikebukuro branch 3F
	CASE 7
		PRINTL Gaean Ikebukuro branch 4F
	CASE 9
		PRINTL Mantra Army HQ B1F
		;マントラ軍本営
	CASE 10
		PRINTL Mantra Army HQ 1F
	CASE 11
		PRINTL Mantra Army HQ 2F
	CASE 12
		PRINTL Mantra Army HQ 3F
	CASE 13
		PRINTL Mantra Army HQ 60F~64F
	CASEELSE
		PRINTL
ENDSELECT

;=======================================================================
;スタート地点入力
;=======================================================================
@START_DUNGEON_17,ARG
FLAG:現M = 2
FLAG:現X = 4
FLAG:現Y = 18
;=======================================================================
;スタート時イベント
;=======================================================================
@EVENT_DUNGEON_START_17
IF ダンジョンフラグ:(FLAG:現ダンジョン):10 == 0
	CALL SHOW_PICTURE, "D"
	CALL MESSAGE_WINDOW_D, "", "＞From what the checkmen said, the next 'star power'/＞is located at the base of the mantra army of Ikebukuro."
	;チェックマンが言うには、ここ池袋のマントラ軍の拠点に『星の力』はあるらしい
	CALL MESSAGE_WINDOW_D, "", "＞マントラ軍とは、東京を支配する魔王バエルの呼びかけに応じた/＞祇園神、ゴズテンノウをトップとした戦闘集団である/＞しかし、彼らは人間と悪魔の融和を目指すガイア教の理念を/＞そう重んじているというわけではない"
	CALL MESSAGE_WINDOW_D, "", "＞彼らはメシア教による教理支配に反発し、/＞メシア教団排除を第一に置くガイア教団と接近することとなり、/＞Now they are the most powerful ally of the Gaean community."
	;彼らはメシア教による教理支配に反発し、/＞メシア教団排除を第一に置くガイア教団と接近することとなり、/＞いまではガイア教団の最も有力な同盟者となっているのである"
	CALL MESSAGE_WINDOW_D, "", "＞That also means that like Shibuya, Ikebukuro is another area/＞where Gaean teachings have much infuence./＞Since you killed Balaam at Shibuya,/＞hostilities will likely be unavoidable..."
	;つまりこの池袋もガイア教団の勢力圏である点においては渋谷と同じである/＞バラムを殺害した以上、ここでの戦いは避けれないだろう……
	ダンジョンフラグ:(FLAG:現ダンジョン):10 = 1
ENDIF



;=======================================================================
;フロアデータ
;=======================================================================
@MAKE_FLOOR_17
SELECTCASE FLAG:現M
	CASE 0
		;地下街B2F
		FLAG:最大X = 9
		FLAG:最大Y = 10
		;						 000000000
		;						 012345678
		CALL MAKE_FLOOR_LINE, 0,"         "
		CALL MAKE_FLOOR_LINE, 1,"    1    "
		CALL MAKE_FLOOR_LINE, 2,"    1113 "
		CALL MAKE_FLOOR_LINE, 3,"    1    "
		CALL MAKE_FLOOR_LINE, 4,"    1    "
		CALL MAKE_FLOOR_LINE, 5,"    1    "
		CALL MAKE_FLOOR_LINE, 6," 9111    "
		CALL MAKE_FLOOR_LINE, 7,"    1    "
		CALL MAKE_FLOOR_LINE, 8,"    6    "
		CALL MAKE_FLOOR_LINE, 9,"         "	
	CASE 1
		;地下街B1F
		FLAG:最大X = 20
		FLAG:最大Y = 20
		;						 000000000011111111112
		;						 012345678901234567890
		CALL MAKE_FLOOR_LINE, 0,"                    "
		CALL MAKE_FLOOR_LINE, 1," 92111129      16   "
		CALL MAKE_FLOOR_LINE, 2,"   1111        1    "
		CALL MAKE_FLOOR_LINE, 3,"   1111      911111 "
		CALL MAKE_FLOOR_LINE, 4,"   1111     1  2 1  "
		CALL MAKE_FLOOR_LINE, 5,"   1 11     1211 1  "
		CALL MAKE_FLOOR_LINE, 6," T216 129   1    1  "
		CALL MAKE_FLOOR_LINE, 7,"   1 11     123  1  "
		CALL MAKE_FLOOR_LINE, 8,"   17 1  6  1    1  "
		CALL MAKE_FLOOR_LINE, 9,"   1 11  1  121121  "
		CALL MAKE_FLOOR_LINE,10,"   1111  1  1    1  "
		CALL MAKE_FLOOR_LINE,11,"   1111 911 1 91 1  "
		CALL MAKE_FLOOR_LINE,12,"   1111 119 1 11 1  "
		CALL MAKE_FLOOR_LINE,13," 921111211121 11 1  "
		CALL MAKE_FLOOR_LINE,14,"    1       1  2 1  "
		CALL MAKE_FLOOR_LINE,15,"    2       11111   "
		CALL MAKE_FLOOR_LINE,16,"    6               "
		CALL MAKE_FLOOR_LINE,17,"                    "
		CALL MAKE_FLOOR_LINE,18,"                    "
		CALL MAKE_FLOOR_LINE,19,"                    "
	CASE 2
		;表通り
		FLAG:最大X = 20
		FLAG:最大Y = 20
		;						 000000000011111111112
		;						 012345678901234567890
		CALL MAKE_FLOOR_LINE, 0,"                    "
		CALL MAKE_FLOOR_LINE, 1,"         6      711 "
		CALL MAKE_FLOOR_LINE, 2,"       11111      1 "
		CALL MAKE_FLOOR_LINE, 3," 92111 11111 111111 "
		CALL MAKE_FLOOR_LINE, 4,"   191 11111     1  "
		CALL MAKE_FLOOR_LINE, 5," 92111 11191 111 1  "
		CALL MAKE_FLOOR_LINE, 6,"    7  1 1 1 1 1 1  "
		CALL MAKE_FLOOR_LINE, 7,"       1 1 1 3 121  "
		CALL MAKE_FLOOR_LINE, 8,"       1 7 1     9  "
		CALL MAKE_FLOOR_LINE, 9,"     921   129      "
		CALL MAKE_FLOOR_LINE,10,"       1   1        "
		CALL MAKE_FLOOR_LINE,11,"      11   11       "
		CALL MAKE_FLOOR_LINE,12,"      11   11       "
		CALL MAKE_FLOOR_LINE,13,"      11   11       "
		CALL MAKE_FLOOR_LINE,14,"      11   11       "
		CALL MAKE_FLOOR_LINE,15,"      111 111       "
		CALL MAKE_FLOOR_LINE,16,"    7 1111111       "
		CALL MAKE_FLOOR_LINE,17,"    1 2  2  2       "
		CALL MAKE_FLOOR_LINE,18,"    1 9  9  3       "
		CALL MAKE_FLOOR_LINE,19,"    8               "

	CASE 4
		;ガイア教・池袋支部1F
		FLAG:最大X = 17
		FLAG:最大Y = 17
		;						 00000000001111111
		;						 01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 1 9 11111 1 121 "
		CALL MAKE_FLOOR_LINE, 2," 1 2 1   1 2 1   "
		CALL MAKE_FLOOR_LINE, 3," 11111 921111111 "
		CALL MAKE_FLOOR_LINE, 4,"   1         1   "
		CALL MAKE_FLOOR_LINE, 5," 121 1 9 129 121 "
		CALL MAKE_FLOOR_LINE, 6," 1 1 1 2 1   1   "
		CALL MAKE_FLOOR_LINE, 7," 1 1 111 1 6 111 "
		CALL MAKE_FLOOR_LINE, 8," 1   2 1 1 2 1   "
		CALL MAKE_FLOOR_LINE, 9," 111 1 1 1 1 127 "
		CALL MAKE_FLOOR_LINE,10,"   1 1   2 1 1   "
		CALL MAKE_FLOOR_LINE,11," 121 1111111 111 "
		CALL MAKE_FLOOR_LINE,12," 1     2     1   "
		CALL MAKE_FLOOR_LINE,13," 11111 11111212T "
		CALL MAKE_FLOOR_LINE,14," 1 2 1       1   "
		CALL MAKE_FLOOR_LINE,15," 1 E 11111112111 "
		CALL MAKE_FLOOR_LINE,16,"                 "

	CASE 5
		;ガイア教・池袋支部2F
		FLAG:最大X = 17
		FLAG:最大Y = 17
		;						 00000000001111111
		;						 01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 111111111111111 "
		CALL MAKE_FLOOR_LINE, 2," 1         2   1 "
		CALL MAKE_FLOOR_LINE, 3," 1 1111111 1 1 1 "
		CALL MAKE_FLOOR_LINE, 4," 1   1   1   1 1 "
		CALL MAKE_FLOOR_LINE, 5," 123 1 E 11111 1 "
		CALL MAKE_FLOOR_LINE, 6," 1   1 2 1 2 1 1 "
		CALL MAKE_FLOOR_LINE, 7," 1 1111111 7 1 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 1 2 1       1 "
		CALL MAKE_FLOOR_LINE, 9," 1 1 6 1 1111111 "
		CALL MAKE_FLOOR_LINE,10," 1 1   1 1111111 "
		CALL MAKE_FLOOR_LINE,11," 1211111 1111111 "
		CALL MAKE_FLOOR_LINE,12," 1   1   2 1   1 "
		CALL MAKE_FLOOR_LINE,13," 1 3 1 3 1 1 3 1 "
		CALL MAKE_FLOOR_LINE,14," 1 2   2 1 2 2 1 "
		CALL MAKE_FLOOR_LINE,15," 1111111 1 1 121 "
		CALL MAKE_FLOOR_LINE,16,"                 "

	CASE 6
		;ガイア教・池袋支部3F
		FLAG:最大X = 17
		FLAG:最大Y = 17
		;						 00000000001111111
		;						 01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 1111111 9 11121 "
		CALL MAKE_FLOOR_LINE, 2," 1   2 1 2 1   1 "
		CALL MAKE_FLOOR_LINE, 3," 1 111 11111 111 "
		CALL MAKE_FLOOR_LINE, 4,"   1         1   "
		CALL MAKE_FLOOR_LINE, 5," 111 1 E 111 1 6 "
		CALL MAKE_FLOOR_LINE, 6,"   1 1 2 1   1 2 "
		CALL MAKE_FLOOR_LINE, 7," 921 11111 6 1 1 "
		CALL MAKE_FLOOR_LINE, 8,"   1     1 2 2 1 "
		CALL MAKE_FLOOR_LINE, 9," 111 7 1 1 1 111 "
		CALL MAKE_FLOOR_LINE,10," 1   2 1 2 1 1   "
		CALL MAKE_FLOOR_LINE,11," 121 1111111 123 "
		CALL MAKE_FLOOR_LINE,12," 1 1     2   1   "
		CALL MAKE_FLOOR_LINE,13," 1 111 1 1 11111 "
		CALL MAKE_FLOOR_LINE,14," 1 2 1 1 2 1 2 1 "
		CALL MAKE_FLOOR_LINE,15," 1 3 1211111 9 1 "
		CALL MAKE_FLOOR_LINE,16,"                 "

	CASE 7
		;ガイア教・池袋支部4F
		FLAG:最大X = 17
		FLAG:最大Y = 17
		;						 00000000001111111
		;						 01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 11121 9 1 11111 "
		CALL MAKE_FLOOR_LINE, 2,"   1 1 2 1 2   1 "
		CALL MAKE_FLOOR_LINE, 3," 121 111111111 1 "
		CALL MAKE_FLOOR_LINE, 4,"   1         1 2 "
		CALL MAKE_FLOOR_LINE, 5," 111 1 E 111 1 7 "
		CALL MAKE_FLOOR_LINE, 6," 2   1 2 1 2 1   "
		CALL MAKE_FLOOR_LINE, 7," 111 111 1 7 111 "
		CALL MAKE_FLOOR_LINE, 8,"   1   1 1     1 "
		CALL MAKE_FLOOR_LINE, 9," 921 121 111 121 "
		CALL MAKE_FLOOR_LINE,10,"   1 1     1 1 1 "
		CALL MAKE_FLOOR_LINE,11," 1 1 1111121 1 1 "
		CALL MAKE_FLOOR_LINE,12," 1 2         1 1 "
		CALL MAKE_FLOOR_LINE,13," 1111111211111 1 "
		CALL MAKE_FLOOR_LINE,14,"       1 1 2   1 "
		CALL MAKE_FLOOR_LINE,15," 6111121 1 T 111 "
		CALL MAKE_FLOOR_LINE,16,"                 "

	CASE 9
		;マントラ軍本営B1F
		FLAG:最大X = 20
		FLAG:最大Y = 15
		;						 000000000011111111112
		;						 012345678901234567890
		CALL MAKE_FLOOR_LINE, 0,"                    "
		CALL MAKE_FLOOR_LINE, 1,"    6               "
		CALL MAKE_FLOOR_LINE, 2,"    1               "
		CALL MAKE_FLOOR_LINE, 3,"    1               "
		CALL MAKE_FLOOR_LINE, 4,"    1               "
		CALL MAKE_FLOOR_LINE, 5,"    2               "
		CALL MAKE_FLOOR_LINE, 6,"    1               "
		CALL MAKE_FLOOR_LINE, 7,"    1    1 1 1 1    "
		CALL MAKE_FLOOR_LINE, 8,"    1    G G G G    "
		CALL MAKE_FLOOR_LINE, 9,"  111 1211111111    "
		CALL MAKE_FLOOR_LINE,10," E11121             "
		CALL MAKE_FLOOR_LINE,11,"  111 12111111111G3 "
		CALL MAKE_FLOOR_LINE,12,"         G G G G    "
		CALL MAKE_FLOOR_LINE,13,"         1 1 1 1    "
		CALL MAKE_FLOOR_LINE,14,"                    "
	CASE 10
		;マントラ軍本営1F
		FLAG:最大X = 20
		FLAG:最大Y = 20
		;						 000000000011111111112
		;						 012345678901234567890
		CALL MAKE_FLOOR_LINE, 0,"                    "
		CALL MAKE_FLOOR_LINE, 1,"    7               "
		CALL MAKE_FLOOR_LINE, 2,"  111   1     6     "
		CALL MAKE_FLOOR_LINE, 3,"  1     1   111     "
		CALL MAKE_FLOOR_LINE, 4,"  111 921    2      "
		CALL MAKE_FLOOR_LINE, 5,"    2   1    1      "
		CALL MAKE_FLOOR_LINE, 6,"    1   129  1 1111 "
		CALL MAKE_FLOOR_LINE, 7,"    1   1    1211118"
		CALL MAKE_FLOOR_LINE, 8,"    1 T21    1 1111 "
		CALL MAKE_FLOOR_LINE, 9,"  911   1    1      "
		CALL MAKE_FLOOR_LINE,10," E111211111211      "
		CALL MAKE_FLOOR_LINE,11,"  111   1    123    "
		CALL MAKE_FLOOR_LINE,12,"        1    1      "
		CALL MAKE_FLOOR_LINE,13,"        2           "
		CALL MAKE_FLOOR_LINE,14,"       111          "
		CALL MAKE_FLOOR_LINE,15,"       111          "
		CALL MAKE_FLOOR_LINE,16,"       111          "
		CALL MAKE_FLOOR_LINE,17,"       111          "
		CALL MAKE_FLOOR_LINE,18,"        7           "
		CALL MAKE_FLOOR_LINE,19,"                    "

	CASE 11
		;マントラ軍本営2F
		FLAG:最大X = 18
		FLAG:最大Y = 19
		;						 000000000011111111112
		;						 012345678901234567890
		CALL MAKE_FLOOR_LINE, 0,"                  "
		CALL MAKE_FLOOR_LINE, 1,"    6     9       "
		CALL MAKE_FLOOR_LINE, 2,"    2     2   7   "
		CALL MAKE_FLOOR_LINE, 3,"    1     1   1   "
		CALL MAKE_FLOOR_LINE, 4,"    1     1   111 "
		CALL MAKE_FLOOR_LINE, 5,"    1111111     1 "
		CALL MAKE_FLOOR_LINE, 6,"          2     1 "
		CALL MAKE_FLOOR_LINE, 7,"      111111111 1 "
		CALL MAKE_FLOOR_LINE, 8,"      111111911 1 "
		CALL MAKE_FLOOR_LINE, 9,"  111 111111111 1 "
		CALL MAKE_FLOOR_LINE,10," E111211111111121 "
		CALL MAKE_FLOOR_LINE,11,"  111 111111111 1 "
		CALL MAKE_FLOOR_LINE,12,"    1 119111111   "
		CALL MAKE_FLOOR_LINE,13,"    1 111111111   "
		CALL MAKE_FLOOR_LINE,14,"    1             "
		CALL MAKE_FLOOR_LINE,15,"    11111111      "
		CALL MAKE_FLOOR_LINE,16,"       2  2       "
		CALL MAKE_FLOOR_LINE,17,"       9  3       "
		CALL MAKE_FLOOR_LINE,18,"                  "


	CASE 12
		;マントラ軍本営3F
		FLAG:最大X = 18
		FLAG:最大Y = 17
		;						 000000000011111111
		;						 012345678901234567
		CALL MAKE_FLOOR_LINE, 0,"                  "
		CALL MAKE_FLOOR_LINE, 1,"    7             "
		CALL MAKE_FLOOR_LINE, 2,"  111             "
		CALL MAKE_FLOOR_LINE, 3,"  1               "
		CALL MAKE_FLOOR_LINE, 4,"  111             "
		CALL MAKE_FLOOR_LINE, 5,"    2             "
		CALL MAKE_FLOOR_LINE, 6,"    1         1   "
		CALL MAKE_FLOOR_LINE, 7,"    1211111112123 "
		CALL MAKE_FLOOR_LINE, 8,"    1    2    1   "
		CALL MAKE_FLOOR_LINE, 9,"  111   444   129 "
		CALL MAKE_FLOOR_LINE,10," E111   111   1   "
		CALL MAKE_FLOOR_LINE,11,"  111   1A1   123 "
		CALL MAKE_FLOOR_LINE,12,"         2    1   "
		CALL MAKE_FLOOR_LINE,13,"  111211111112129 "
		CALL MAKE_FLOOR_LINE,14," 6111         1   "
		CALL MAKE_FLOOR_LINE,15,"  111         1   "
		CALL MAKE_FLOOR_LINE,16,"                  "
		;A トールにさらわれきた直後のタイル
		DA:9:11 = 11
		;イベント:裁判（ボス戦）

	CASE 13
		;マントラ軍本営60F~64F
		FLAG:最大X = 20
		FLAG:最大Y = 20
		;						 000000000011111111112
		;						 01234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"         GG         "
		CALL MAKE_FLOOR_LINE, 1,"         11         "
		CALL MAKE_FLOOR_LINE, 2,"         11         "
		CALL MAKE_FLOOR_LINE, 3,"         11         "
		CALL MAKE_FLOOR_LINE, 4,"         11         "
		CALL MAKE_FLOOR_LINE, 5,"         11         "
		CALL MAKE_FLOOR_LINE, 6,"         11         "
		CALL MAKE_FLOOR_LINE, 7,"         11         "
		CALL MAKE_FLOOR_LINE, 8,"         111111     "
		CALL MAKE_FLOOR_LINE, 9,"            111     "
		CALL MAKE_FLOOR_LINE,10,"   111111111111     "
		CALL MAKE_FLOOR_LINE,11,"   111              "
		CALL MAKE_FLOOR_LINE,12,"   111111111111     "
		CALL MAKE_FLOOR_LINE,13,"            111     "
		CALL MAKE_FLOOR_LINE,14," 72111111111111     "
		CALL MAKE_FLOOR_LINE,15,"   111          113 "
		CALL MAKE_FLOOR_LINE,16," 111111111111111111 "
		CALL MAKE_FLOOR_LINE,17," 1 11    1          "
		CALL MAKE_FLOOR_LINE,18,"   11    1          "
		CALL MAKE_FLOOR_LINE,19,"                    "
	CASEELSE
ENDSELECT

;=======================================================================
;タイル調整
;=======================================================================
@MAKE_FLOOR_LINE_COMMON_17, ARG, ARG:1, ARG:2
#LOCALSIZE 30
;LOCAL:3 宝箱 ダンジョンフラグ:75~99
;LOCAL:4 イベント
;LOCAL:8 メッセンジャー
;(0/0)でLOCALを消去
SIF ARG:1 == 0 && ARG:2 == 0
	VARSET LOCAL
IF ARG == 3
	IF GETBIT(ダンジョンフラグ:(FLAG:現ダンジョン):(FLAG:現M+25), LOCAL:3)
		DA:(ARG:1):(ARG:2) = 1
	ELSE
		DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:3 * 10 + 3
	ENDIF
	LOCAL:3++
ENDIF
;イベント扉
IF ARG == 12
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:2 * 10 + 12
	LOCAL:2++
ENDIF
;イベント
IF ARG == 4
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:4 * 10 + 4
	LOCAL:4++
	SELECTCASE DA:(ARG:1):(ARG:2) / 10
		;裁判
		CASE 1200, 1201, 1202
			SIF ダンジョンフラグ:(FLAG:現ダンジョン):13
				DA:(ARG:1):(ARG:2) = 1
	ENDSELECT
ENDIF
;上り階段
IF ARG == 6
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:6 * 100 + 6
	LOCAL:6++
ENDIF
;下り階段
IF ARG == 7
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:7 * 100 + 7
	LOCAL:7++
ENDIF
;メッセンジャー
IF ARG == 9
	DA:(ARG:1):(ARG:2) = FLAG:現M *1000 + LOCAL:9 * 10 + 9
	LOCAL:9++
ENDIF

;=======================================================================
;タイル定義
;=======================================================================
@DEFINE_TILES_17, ARGS, ARG, ARG:1
;G イベント扉
SIF ARGS == "G"
	RETURN 12

;=======================================================================
;[5]調べる　実行時のイベント
;=======================================================================
@EVENT_CHECK_DUNGEON_17
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) % 10
	;==========
	;出口の処理
	;==========
	CASE 8
		CALL DUNGEON_EXIT
		RETURN 1
	;========
	;宝の処理
	;========
	CASE 3
		CALL TREASURE_17
		RETURN RESULT
	CASE 4
		CALL EVENT_17
	;=======
	;階段
	;=======
	CASE 6, 7
		CALL WORP_17
		RETURN 1
	;=======
	;メッセンジャー
	;=======
	CASE 9
		CALL MESSAGE_17
		RETURN 1
ENDSELECT

;=======================================================================
;タイル進入時のイベント
;=======================================================================
@EVENT_ENTER_DUNGEON_17,ARG
;ARG = 進入時の向き　0の場合ワープなど
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) % 10
	;========
	;扉の処理
	;========
	CASE 2
		CALL DUNGEON_DOOR,ARG
		RETURN 1
	;========
	;宝の処理
	;========
	CASE 3
		CALL TREASURE_17
		RETURN RESULT
	CASE 4
		CALL EVENT_17
	;=======
	;階段
	;=======
	CASE 6, 7
		CALL WORP_17
		RETURN RESULT
	;==========
	;出口の処理
	;==========
	CASE 8
		CALL DUNGEON_EXIT
		RETURN 1
	;=======
	;メッセンジャー
	;=======
	CASE 9
		CALL MESSAGE_17, 1
		RETURN 1
ENDSELECT
RETURN 0
;========
;イベントの処理
;========

;=======================================================================
;指定したマスに進入可能か
;=======================================================================
@CAN_ENTER_17,ARG,ARG:1
#LOCALSSIZE 1
#LOCALSIZE 1
SELECTCASE DA:ARG:(ARG:1)
	CASE 9012
		CALL MESSAGE_WINDOW_D, "悪魔らしき声", "つーかまっちゃったー/つーかまっちゃったよーん"
		RETURN 0
	CASE 9022
		CALL MESSAGE_WINDOW_D, "若い女の声", "援交とか普通、って言ったら捕まっちゃった/ゴズテンノウ様って結構古風な方だったのねぇ"
		RETURN 0
	CASE 9032
		CALL MESSAGE_WINDOW_D, "", "＞この牢には誰も入っていないようだ…"
		RETURN 0
	CASE 9042
		CALL MESSAGE_WINDOW_D, "女の声", "夫婦は別姓にすべきなのです！/新しい家族の形を認めないマントラ軍は右翼！"
		RETURN 0
	CASE 9052
		IF ダンジョンフラグ:(FLAG:現ダンジョン):14 == 0
			CALL MESSAGE_WINDOW_D, "", "＞There was a huge door here.../＞It looked like it requires considerable power to open it.../＞Please decide who should open the door"
			;巨大な扉がある……/＞この扉を開けるには相当な力が必要そうだ……/＞誰に扉を開けさせるか選んでください
			LOCALS = 
			FOR LOCAL, 1, 7
				SIF POS(LOCAL) < 0
					CONTINUE
				SIF GET_STATE(CFLAG:POS(LOCAL):ステート) != "GOOD"
					CONTINUE
				LOCALS += @"[{LOCAL}] %CALLNAME:POS(LOCAL)%/"
			NEXT
			LOCALS += "[9] Leave the door"
			;扉を放って置く
			CALL INPUT_SELECT_D, LOCALS, , , 2
			LOCAL = RESULT
			IF LOCAL == 9
				CALL MESSAGE_WINDOW_D, "", "＞You turned back from the door..."
				;扉に構わず引き返した……
			ELSE
				CALL MESSAGE_WINDOW_D, "", @"＞%CALLNAME:POS(LOCAL)% pushed the door forcefully..."
				;は力を籠めて扉を押した……
				CALL MESSAGE_WINDOW_D, "", "......../...../..."
				IF MAXBASE:POS(LOCAL):力 >= 50
					CALL MESSAGE_WINDOW_D, "", @"＞%CALLNAME:POS(LOCAL)% managed to open the door!"
					;は見事扉を開けた！
					ダンジョンフラグ:(FLAG:現ダンジョン):14 = 1
					RETURN 1
				ELSE
					CALL MESSAGE_WINDOW_D, "", @"＞But the door remained shut..."
					;扉は開かなかった……
				ENDIF
			ENDIF
			RETURN 0
		ENDIF
	CASE 9062
		CALL MESSAGE_WINDOW_D, "若い男の声", "ちくしょー！/マントラ軍の時代になっても飲酒運転はだめなのかよぉ！"
		RETURN 0
	CASE 9072
		CALL MESSAGE_WINDOW_D, "", "＞この牢には誰も入っていないようだ…"
		RETURN 0
		;IF ダンジョンフラグ:(FLAG:現ダンジョン):22 == 0
		;	PRINTL 牢屋の中には一人の少女がいた。
		;	PRINTL 服装は割と普通だが、顔立ちを見れば分かる。恐らくいいとこのお嬢さんだろう。
		;	PRINTL 「…誰？」
		;	PRINTL 「…なんだ、また悪魔使いか…」
		;	PRINTL 「放っといてよ。私は自分の意思でここにいるの…」
		;	PRINTL 「…あいつに会うことができない世界なんて、もうどうでもいい…」
		;	PRINTL 「もう何もかも、どうでもいい…」
		;	PRINTL そう言うと少女は俯いて、一切の問いかけに応じなくなった。
		;	PRINTL …これまで影になっていてよく見えなかったが、少女の右腕は…。
		;	PRINTL これでは連れて行くことなどできないだろう…。
		;	PRINTFORMW %CALLNAME:MASTER%はやむなく部屋から出ていくことにした。
		;	ダンジョンフラグ:(FLAG:現ダンジョン):22 = 1
		;ELSEIF ダンジョンフラグ:(FLAG:現ダンジョン):22 == 1
		;	PRINTL 少女は心を開く様子がない…。
		;		IF FINDCHARA_B(4501,1) == 2 && (TALENT:(RESULT:1):恋慕 || TALENT:(RESULT:1):親愛)
		;			PRINTL 
		;			PRINTL 「…この子…。どうにかできないの…？」
		;			PRINTL 「何があったかは分からないけど…こんなことされて…可哀想だよ…」
		;			PRINTW ベスは心を閉ざした少女を心配そうな眼差しで見つめている。
		;		ENDIF
		;	PRINTFORMW %CALLNAME:MASTER%はやむなく部屋から出ていくことにした。
		;ENDIF
	CASE 9082
		CALL MESSAGE_WINDOW_D, "若い男の声", "ちくしょう……/力さえあればなんだって許されるのに……/ちょっと女だって金だって……"
		RETURN 0
		;PRINTL 若者がいる…。
		;PRINTL 「あ？俺が何をしたかって？んなことどうでもいいだろ」
		;PRINTW 「そんなことより隣の牢屋だぜ…。なんであんな上玉が池袋なんかにいるんだ？」
	CASE 9092
		CALL MESSAGE_WINDOW_D, "子供の声", "ちょっと優しい言葉をかけたら凍ってしまったんだホ！/おいらもNo,1フロストになりたかったんだホ！/トホホ…/早く裁判をしてほしいホ…！"
		RETURN 0
	CASE 13012, 13022
		IF ダンジョンフラグ:(FLAG:現ダンジョン):23
			CALL MESSAGE_WINDOW_D, "", "The door is locked tightly..."
			;扉はかたく閉ざさされている……
		ELSE
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "", "＞牛頭天王の間の扉に近づくと物陰から妖魔 モコイが現われた"
			CALL MESSAGE_WINDOW_D, "Yoma Mokoi", "なんだかとってもダークネス/ボク、アマラ宇宙デビューしたッスよ"
			;妖魔 モコイ", "なんだかとってもダークネス/ボク、アマラ宇宙デビューしたッスよ"
			CALL MESSAGE_WINDOW_D, "Yoma Mokoi", "Um,/Devil summoner Raidou Kuzunoha vs. Phantom Society summoner./Did I do that right?"
			;ウヒッ、/デビルサマナークズノハライドウ対ファントム・ソサエティのサマナー…/それってイケてる？
			CALL MESSAGE_WINDOW_D, "", @"＞When %CALLNAME:MASTER% turned to answer the Yoma Mokoi.../＞There was a sound from downstairs./＞Looking down the stairs,/＞there where a young man in black clothes and a black cat."
			;%CALLNAME:MASTER%がモコイに返答しようとしたその時…/＞階下から気配がした/＞見下ろすとそこには漆黒の外套を纏った青年と黒猫がいた
			IF ダンジョンフラグ:34:12
				CALL MESSAGE_WINDOW_D, "Gouto", "Is it the summoner from back then?/It seems you got quite strong to make it here."
				;あの時のファントムのサマナーか…/ここまで辿りつくとは腕をあげたようだな
			ELSE
				CALL MESSAGE_WINDOW_D, "Black cat", "Summoner of the Phantom Society.../Let us see your power!"
				;黒猫", "ファントムのサマナーよ…/まずはその力を見極めさせてもらうぞ！
			ENDIF
			CALL MESSAGE_WINDOW_D, "", "＞The young man walked up the stairs./＞Devil summoner Raidou Kuzunoha appeared!"
			FLAG:逃走不可フラグ = 1
			FLAG:会話不能フラグ = 1
			FLAG:先制不意打ちキャンセル = 1
			;
			;ライドウLv5　ランク12
			CALL SET_ENEMY,9,[[キャラ:ライドウ]],41,0,1
			CFLAG:(CHARANUM-1):ＨＰ補正 += 1500
			CFLAG:(CHARANUM-1):ＭＰ補正 += 9000
			CFLAG:(CHARANUM-1):行動回数 = 2
			CFLAG:(CHARANUM-1):速度補正 += 10
			EQUIP:(CHARANUM-1):頭 = [[アイテム:Jagd Helm]]
			EQUIP:(CHARANUM-1):胴 = [[アイテム:Jagd Armor]]
			EQUIP:(CHARANUM-1):腕 = [[アイテム:Jagd Glove]]
			EQUIP:(CHARANUM-1):足 = [[アイテム:Jagd Leg]]
			ABL:(CHARANUM-1):スキル6 = 18
			ABL:(CHARANUM-1):スキル7 = 117
			ABL:(CHARANUM-1):スキル8 = 513
			CSTR:(CHARANUM-1):思考パターン = 4542
			CALL SYNC_STATUS, (CHARANUM-1)
			CALL HEALTH_CHARA, (CHARANUM-1)
			CALL BATTLE_START
			FLAG:逃走不可フラグ = 0
			FLAG:会話不能フラグ = 0
			FLAG:先制不意打ちキャンセル = 0
			CALL MESSAGE_WINDOW_D, "", "＞Raidou dropped his sword and yielded..."
			;ライドウが刀を納め引き下がった…
			IF ダンジョンフラグ:34:12
				CALL MESSAGE_WINDOW_D, "Gouto", "ライドウが認めるほどに成長したか/ファントムのサマナーにしておくには惜しい逸材だな…/これも運命ゆえか…/なるほどな"
			ELSE
				CALL MESSAGE_WINDOW_D, "Back cat", "ライドウが認めるその力/やはり、なかなかのものだな…/人にして人にあらず、その強さ只者ではあるまい/何者なのだ…"
				CALL MESSAGE_WINDOW_D, "Back cat", "今、お前と戦ったこの男の名はライドウ/そして、俺はGouto/まあ、しがない探偵だ"
			ENDIF
			CALL MESSAGE_WINDOW_D, "Gouto", "ある紳士の依頼でお前の様子を探りに来たんだが…/ライドウ、お前の言う通りになったな？/しかし…紳士の思惑が気になる/少し調べて見る必要がありそうだ"
			CALL MESSAGE_WINDOW_D, "Gouto", "事と次第によっては、もう一度/ライドウと手合わせするかもしれんぞ？/…それまではその命、大事にしておくのだな"
			CALL MESSAGE_WINDOW_D, "", "＞Raidou Kuzunoha and the black cat Gouto left..."
			ダンジョンフラグ:(FLAG:現ダンジョン):23 = 1
			DA:9:12 = 1
			DA:10:12 = 1
		ENDIF
		RETURN 0
ENDSELECT
CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT

;=======================================================================
;エレベーター定義
;=======================================================================
@DUNGEON_ELEVATOR_17, ARG
VARSET RESULT, -1
VARSET RESULTS
SELECTCASE FLAG:現M
	CASE 4, 5, 6, 7
		RESULT:1 = 4
		RESULT:2 = 5
		RESULT:3 = 6
		RESULT:4 = 7
		RESULTS:1 = 1F
		RESULTS:2 = 2F
		RESULTS:3 = 3F
		RESULTS:4 = 4F
	CASE 9, 10, 11, 12
		RESULT:1 = 9
		RESULT:2 = 10
		RESULT:3 = 11
		RESULT:4 = 12
		RESULTS:1 = B1F
		RESULTS:2 = 1F
		RESULTS:3 = 2F
		RESULTS:4 = 3F
ENDSELECT
RETURN -1
;=======================================================================
;宝箱の中身
;=======================================================================
@TREASURE_17
#LOCALSIZE 1
#LOCALSSIZE 3
LOCAL = 1
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 0
		LOCALS = SolvingOrb
	CASE 100
		LOCALS = 純米からじし
	CASE 200
		LOCALS = PoisonArrow
	CASE 201
		LOCALS = Life stone
	CASE 500
		LOCALS = 罠
		LOCALS:1 = ＨＰ
		LOCAL = 25
	CASE 501
		LOCALS = ￥
		LOCAL = 14000
	CASE 502
		LOCALS = Bead
	CASE 503
		LOCALS = 罠
		LOCALS:1 = POISON
		LOCAL = 30
		LOCALS:2 = 神経
	CASE 600
		LOCALS = SmokeBall
	CASE 601
		LOCALS = 本醸造まんさく
	CASE 800
		LOCALS = YamataNoDrink
		LOCAL = 3
	CASE 900
		LOCALS = Masakado Helm
	CASE 1000
		LOCALS = StIncense
	CASE 1100
		LOCALS = BalmOfLife
		LOCAL = 3
	CASE 1200
		LOCALS = BeadChain
	CASE 1201
		LOCALS = ChakraDrop
		LOCAL = 3
	CASE 1300
		LOCALS = 魔貨
		LOCAL = 3000
ENDSELECT
IF LOCALS == "￥"
	CALL GET_TREASURE_MONEY, 0, LOCAL, FLAG:現ダンジョン, FLAG:現M + 25, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSEIF LOCALS == "魔貨"
	CALL GET_TREASURE_MONEY, 1, LOCAL, FLAG:現ダンジョン, FLAG:現M + 25, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSEIF LOCALS == "MAG" || LOCALS == "ＭＡＧ"
	CALL GET_TREASURE_MAG, 0, LOCAL, FLAG:現ダンジョン, FLAG:現M + 25, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSEIF LOCALS == "罠"
	;LOCALS:1 種類 LOCAL ダメージ量or確率 LOCALS:2 相性
	CALL GET_TREASURE_TRAP, LOCALS:1, LOCAL, GET_TYPE_NUM(LOCALS:2), FLAG:現ダンジョン, FLAG:現M + 25, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
ELSE
	IF GETNUM(ITEM, LOCALS) == -1
		PRINTL ＞アイテム名の指定が間違ってます
		PRINTW ＞アイテムの取得処理を中断します
	ELSE
		CALL GET_TREASURE, GETNUM(ITEM, LOCALS), LOCAL , FLAG:現ダンジョン, FLAG:現M + 25, (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
	ENDIF
ENDIF
RETURN 1
@EVENT_17, ARG
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
ENDSELECT
;=======================================================================
;ワープ
;=======================================================================
@TILE_MARK_COMMON_17_6, ARG, ARG:1, ARG:2
IF ARG == 2006 || ARG == 7006
	RESULTS = 入
ELSEIF ARG == 12006
	RESULTS = Ｅ
ELSE
	RESULTS = 昇
ENDIF
@TILE_MARK_COMMON_17_7, ARG, ARG:1, ARG:2
IF ARG == 4007 || ARG == 10107
	RESULTS = 出
ELSEIF ARG == 13007
	RESULTS = Ｅ
ELSE
	RESULTS = 降
ENDIF
@WORP_17
SELECTCASE DA:(FLAG:現X):(FLAG:現Y)
	CASE 2006
		CALL MESSAGE_WINDOW_D, "", "＞It's the entrance of the Gaean Branch Ikebukuro."
		;ガイア教団・池袋支部の入口だ"
		CALL INPUT_YN_D, "Enter ", "Don't enter"
		SIF !RESULT
			CALL DUNGEON_WORP_ID, 4, 4007, 1
	CASE 4007
		CALL MESSAGE_WINDOW_D, "", "＞It's the exit of the Gaean Branch Ikebukuro."
		;ガイア教団・池袋支部の出口だ"
		CALL INPUT_YN_D, "Leave", "Stay"
		SIF !RESULT
			CALL DUNGEON_WORP_ID, 2, 2006, 1
	CASE 7006
		CALL MESSAGE_WINDOW_D, "", "＞It's the entrance of the Mantra Army HQ."
		;マントラ軍本営の入口だ"
		CALL INPUT_YN_D, "Enter", "Don't enter"
		IF !RESULT
			IF ダンジョンフラグ:(FLAG:現ダンジョン):13 == 0
				CALL MESSAGE_WINDOW_D, "", "＞扉を開けようと取っ手に手をかけたが/＞背後から大きな足音が響いたため、慌てて振り向いたが/＞ちょうど巨大なハンマーが振り下ろされるところだった…"
				CALL MESSAGE_WINDOW_D, "Demon", "You are suspected of having killed Balaam in Shibuya./This wouldn't be a problem for the mantra army./However, since you are to be put on trial,/the voices of thoose who escaped from Shibuya can't be ignored."
				;貴様は渋谷のバラム殿殺害の件の容疑者ではあるが/そのこと自体はマントラ軍にとってはさして問題ではない/だが貴様を裁判にかけよという、/渋谷から逃げ帰った者達の声を無視することもできぬ
				CALL MESSAGE_WINDOW_D, "Demon", "ならば、双方が納得する形を提供するまで…/それがゴズテンノウ様の意思だ…"
				CALL MESSAGE_WINDOW_D, "Demon", @"悪魔は意識を失った%CALLNAME:MASTER%達を引き摺っていった……"
				CALL MESSAGE_WINDOW_D, "", "........./......./..."
				CALL SHOW_PICTURE, "EMPTY"
				ダンジョンフラグ:(FLAG:現ダンジョン):12 = 1
				FLAG:脱出スキル禁止 = 1
				DA:(FLAG:現X):(FLAG:現Y) = 1
				CALL DUNGEON_WORP_ID, 12, 11, 1
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "", @"＞When you woke up, you had been brought to a place akin to a stadium./＞周囲には深い堀が組まれ、更にその先には観客席が見える"
				;目を覚ますと、闘技場のような場所に連れてこられていた/＞周囲には深い堀が組まれ、更にその先には観客席が見える
				CALL MESSAGE_WINDOW_D, "", @"＞%CALLNAME:MASTER%の後ろのドアは施錠されており、目の前のドアには/＞先ほど鈍器で%CALLNAME:MASTER%達を強く殴打した巨大な悪魔が中央に/＞その横には女性の悪魔、そして獣型の悪魔が１体ずついる"
				CALL MESSAGE_WINDOW_D, "Voice", "Silence in the court, this trial will now begin..."
				;裁判の始まりである…
				CALL MESSAGE_WINDOW_D, "", "＞A dull, thick voice sounds from somewhere."
				;どこからか鈍く、太い声が聞こえてくる
				CALL MESSAGE_WINDOW_D, "Voice", "In Shibuya, chairman Balaam of the Gaean community/has been killed./Is this your doing?"
				;汝は、渋谷において、ガイア教団の渋谷支部会長であった/魔王バラム殿を殺害した/その罪に間違いはないか
				CALL INPUT_YN_D,"Yes","No"
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "", @"＞When %CALLNAME:MASTER% nodded in response,/＞a groaning was heard."
					;＞%CALLNAME:MASTER%が潔く首を縦に振ると/＞場内からどよめきが起こった
				ELSE
					CALL INCREASE_LD, -2
					CALL MESSAGE_WINDOW_D, "Voice", "We have many eyewithnesses who claim they saw you,/yet you deny./Well,/we'll see that the truth come to light."
					;ここには汝の姿を見たものが大勢おる/それでも汝は否定するか/まぁよい/いずれ真実は明らかになるだろう
				ENDIF
				CALL MESSAGE_WINDOW_D, "Voice", "Well, I'll ask you one thing more.../Are you a mesiac?"
				;ではもう一つ尋ねよう…/汝はメシア教徒か…？
				CALL INPUT_YN_D,"Yes","No"
				IF RESULT == 0
					;大きくLAWに寄る
					CALL INCREASE_LC, 16
					CALL MESSAGE_WINDOW_D, "", @"＞When %CALLNAME:MASTER% replied positively,/＞the room became noisy with voices."
					CALL MESSAGE_WINDOW_D, "Audience", "As we though!"
					;観衆 やっぱり！
					CALL MESSAGE_WINDOW_D, "Audience", "Mesiac!/You'll pay with your life!"
					;メシア教徒め！/命で償わせてやる！
					CALLF STRFLAG_D("メシア教徒肯定", 1)
				ELSE
					CALL MESSAGE_WINDOW_D, "", @"＞When %CALLNAME:MASTER% shook %HIS_HER(MASTER)% head, booing sounded from a corner of the hall."
					;%CALLNAME:MASTER%が首を横に振ると場内の一角からブーイングが起こった
					CALL MESSAGE_WINDOW_D, "Audience", "Don't lie to us!"
					;嘘を付くな！
					CALL MESSAGE_WINDOW_D, "Audience", "Only a mesian would want Balaam dead!"
					;メシア教徒でないやつがなぜバラム様を殺すんだ！
				ENDIF
				CALL MESSAGE_WINDOW_D, "Demon with a bell", "Silence!/The trial is still in session!"
				;静まれぃッ！/ここは裁判の場であるぞ！
				CALL MESSAGE_WINDOW_D, "", "＞From the chiding of the demon, the hall became quiet again."
				;悪魔の一喝により場内が静まり返った
				CALL MESSAGE_WINDOW_D, "Voice", "Let's continue."
				;続きを行おう
				IF STRFLAG_D("メシア教徒肯定")
					CALL MESSAGE_WINDOW_D, "Voice", "汝がメシア教徒であるならば罪は明白である/己の力を否定し、他者に縋る弱き者たちの教え……/それ自体が罪である"
					CALL MESSAGE_WINDOW_D, "Voice", "だがしかし汝は単身でバラムを殺し/そのうえこの地まで辿りついた強者である/自分の意思を貫き通すには、力、それだけがあればいいのだ/それこそがマントラ軍の摂理…"
					CALL MESSAGE_WINDOW_D, "Voice", "この摂理に従い、汝に生き延びる機会をやろう/汝に決闘の刑を処す！"
					CALL MESSAGE_WINDOW_D, "Voice", "You, if you want to survive,/will have to overcome three strong opponents./...let us see all your power."
				ELSE
					CALL MESSAGE_WINDOW_D, "Voice", "I believe you that you are not a mesiac./Because they are weak./They would never be able to kill Balaam."
					;汝がメシア教徒でないのは、我にも分かる/なぜならばメシア教徒は弱いからだ/奴ら如きにバラムが殺せるとは思えぬ
					CALL MESSAGE_WINDOW_D, "Voice", "汝に殺されたバラムもまた弱かったということなのだろう/弱き者、それに従う者などに意を貫く資格など無し/様の目的が何であろうと、それはどうでもいい"
					CALL MESSAGE_WINDOW_D, "Voice", "自分の意思を貫き通すには、力、それだけがあればいいのだ/それこそがマントラ軍の摂理…"
					CALL MESSAGE_WINDOW_D, "Voice", "だが、バラムは我らが同胞である/同胞を殺されたことに対するけじめはつけてやらねば/渋谷からわざわざここを頼って来た者達に対する示しにもならぬ"
					CALL MESSAGE_WINDOW_D, "Voice", "...my verdict is, you are given a battle penalty!/You, if you want to survive,/will have to overcome three strong opponents./...let us see all your power."
					;…よってここを持って、汝に決闘の刑を処す！/汝、生き残りたくば/ここにいる三人の強者に打ち勝ち、/…その力のすべてを我に見せてみよ
				ENDIF
				CALL MESSAGE_WINDOW_D, "", "＞The crowd cheered at this decision./＞A monsterous demon prepared it's battle gear and approached you./＞Beast Orthrus appeared!"
				;場内が歓声で沸き立つなか/＞さっそく一体の悪魔が戦闘態勢を整え、向かってきた/＞魔獣オルトロスが１体出た！
				FLAG:逃走不可フラグ = 1
				FLAG:会話不能フラグ = 1
				FLAG:先制不意打ちキャンセル = 1
				;オルトロスLv23　ランク3
				CALL SET_ENEMY,9,[[キャラ:オルトロス]],32,0,1
				CFLAG:(CHARANUM-1):ＭＰ補正 = 5000
				CFLAG:(CHARANUM-1):行動回数 = 2
				ABL:(CHARANUM-1):スキル3 = 703
				ABL:(CHARANUM-1):スキル4 = 705
				ABL:(CHARANUM-1):スキル5 = 304
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				CALL BATTLE_START
				CALL CLEAR_TILE_ID, 12004
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "Demon with a bell", "It seems you defeated Orthrus without problems./I see now how you managed to defeat Balaam..."
				;ほう、オルトロスを難なく退けるとは/バラムがやられるのも無理はないな…
				CALL MESSAGE_WINDOW_D, "Female demon", "...are you impressed by that?/トールの旦那/Next is my turn! Human!"
				;女悪魔", "…感心してる場合かい？/トールの旦那/次はあたしの番さね！人間！
				CALL MESSAGE_WINDOW_D, "", "＞Brute Yaksini appeared!"
				;妖鬼ヤクシニーが１体出た！
				;ヤクシニーLv34　ランク2
				CALL SET_ENEMY,9,[[キャラ:ヤクシニー]],40,0,1
				CFLAG:(CHARANUM-1):ＭＰ補正 = 5000
				CFLAG:(CHARANUM-1):行動回数 = 2
				ABL:(CHARANUM-1):スキル3 = 1003
				ABL:(CHARANUM-1):スキル4 = 1005
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				CALL BATTLE_START
				CALL CLEAR_TILE_ID, 12024
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "Voice", "見事なり、人間よ/だが余興はここまでと言うもの…/我がマントラ軍のNo,2、トールは強いぞ？/さぁ、トールよ！その力を存分に振るうのだ！"
				;見事なり、人間よ/だが余興はここまでと言うもの…/我がマントラ軍のNo,2、トールは強いぞ？/さぁ、トールよ！その力を存分に振るうのだ！
				CALL MESSAGE_WINDOW_D, "Kishin Thor", "わざわざ言われてしまっては仕方がないな/人間よ。重ね重ね、よくここまで勝ち抜いた/If you win now, you'll have earned your release./Come now, fight well!"
				;鬼神 トール", "わざわざ言われてしまっては仕方がないな/人間よ。重ね重ね、よくここまで勝ち抜いた/もしお前が勝てば、お前は晴れて無罪放免/さぁ、かかってくるがよい！
				;トールLv40　ランク1
				CALL SET_ENEMY,9,[[キャラ:トール]],43,0,1
				CFLAG:(CHARANUM-1):ＨＰ補正 = 1000
				CFLAG:(CHARANUM-1):ＭＰ補正 = 9000
				CSTR:(CHARANUM-1):思考パターン = 1406
				CFLAG:(CHARANUM-1):行動回数 = 2
				BASE:(CHARANUM-1):火炎 = 50
				BASE:(CHARANUM-1):氷結 = 50
				BASE:(CHARANUM-1):地変 = 50
				BASE:(CHARANUM-1):水撃 = 50
				BASE:(CHARANUM-1):疾風 = 50
				BASE:(CHARANUM-1):神経 = 0
				BASE:(CHARANUM-1):精神 = 0
				ABL:(CHARANUM-1):攻撃範囲 = 3
				;ちょっぴり長いぷろろーぐ終了
				;そげぶ
				ABL:(CHARANUM-1):入手確率1 = 100
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				CALL BATTLE_START
				FLAG:逃走不可フラグ = 0
				FLAG:会話不能フラグ = 0
				FLAG:先制不意打ちキャンセル = 0
				FLAG:11406 = 1
				CALL MESSAGE_WINDOW_D, "Voice", "A brilliant fight...human./That you even managed to defeat Thor..."
				;見事だ…人間よ/まさかトールまでも退けるとは…
				CALL MESSAGE_WINDOW_D, "", "＞The inside of the hall is filled with entusiastic applause.."
				;＞場内は割れんばかりの拍手に包まれている
				CALL MESSAGE_WINDOW_D, "Voice", "The strong are respected in our domain./And someone as strong as you,/we also allow to kill Balaam."
				;なにより強き者こそ尊ばれるのが我らが摂理/汝ほどの強さがあるならば/バラムを殺したこともまた許される
				CALL MESSAGE_WINDOW_D, "Voice", "If you challenge us again,/we will gladly accept./However, if you don't want conflict,/we will treat you as a friend."
				;汝が改めて我らに戦いを挑むのならば/我らは喜んで受けてたとう/だが、汝が争いを望まぬのならば/我らは汝を友として遇すこととする
				CALL MESSAGE_WINDOW_D, "Voice", "Hahaha....it's been a while since we have seen anyone as strong as you./我も、実体を失ってさえいなければ/If possible, I'd like to compare my power with yours soon."
				;とはいえふふふ…、汝ほどの強者は久方ぶりに見る/我も、実体を失ってさえいなければ/すぐにでも、汝と力比べをしたいものよのぉ
				CALL MESSAGE_WINDOW_D, "Voice", "...well! With this, the court is closed!"
				;…では！これにて閉廷である！
				CALL MESSAGE_WINDOW_D, "", "........../....../...."
				CALL SHOW_PICTURE, "EMPTY"
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "", @"＞The audience left the hall.../＞When %CALLNAME:MASTER% also turned to leave,/＞%HE_SHE(MASTER)% was stopped by Thor."
				;観客達は去っていった…/＞%CALLNAME:MASTER%も立ち去ろうとすると/＞鬼神トールに呼び止められた
				CALL MESSAGE_WINDOW_D, "Kishin Thor", "You, is this what you came to seek?"
				;お前の目的はこれではないか？
				CALL MESSAGE_WINDOW_D, "", "＞Thor handed you a star-shaped jewel."
				;鬼神 トールは星の形をした宝石を差し出してきた
				IF STRFLAG_D("メシア教徒肯定")
					CALL MESSAGE_WINDOW_D, "Kishin Thor", "お前がメシア教徒であるというのは惜しいが/これはおそらくお前のようものが/持つのにふさわしいものなのだろう/なにより一人の戦士としてあの場で戦ったのだ/望みの一つも叶えてやらねばなるまい"
				ELSE
					CALL MESSAGE_WINDOW_D, "Kishin Thor", "最近、これを狙ってくる悪魔使いが多くてな/下手に我が軍の者に持たせるよりも/力あるものに持たせたほうがいいだろう/どの道、我々には使い道が分からないのだから…"
				ENDIF
				CALL MESSAGE_WINDOW_D, "", "＞You got the water star power!"
				;水星のピラーを手に入れた！
				ダンジョンフラグ:(FLAG:現ダンジョン):13 = 1
				FLAG:脱出スキル禁止 = 0
				CALL CLEAR_TILE_ID, 12014
				CALL MESSAGE_WINDOW_D, "Kishin Thor", "そうそう、このマントラ軍本営にある宝箱は/自由に持っていっていいぞ/お前は我々に認められたのだからな/当然のことだ"
				IF STRFLAG_D("メシア教徒肯定")
					CALL MESSAGE_WINDOW_D, "Kishin Thor", "いつか考えを改めることがあればまた来るがいい/我らはいつでもお前を歓迎するだろう"
				ELSE
					CALL MESSAGE_WINDOW_D, "Kishin Thor", "And...if you want my help,/please call me in the proper way.../Then I'll lend you my power."
					;そして…、もし私の助けを借りたければ/しかるべき方法で私を呼び出すがよい…/その時は力を貸してやろう
				ENDIF
				CALL MESSAGE_WINDOW_D, "", "＞Thor left"
				;トールは去っていった
				CALL SHOW_PICTURE, "EMPTY"
				FLAG:11406 = 1
			ELSE
				CALL DUNGEON_WORP_ID, 10, 10107, 1
			ENDIF
		ENDIF
	CASE 10107
		CALL MESSAGE_WINDOW_D, "", "＞It's the exit of the Mantra Army HQ."
		;マントラ軍本営の出口だ"
		CALL INPUT_YN_D, "Leave", "Stay"
		SIF !RESULT
			CALL DUNGEON_WORP_ID, 7, 7006, 1
	CASE 12006
		CALL MESSAGE_WINDOW_D, "", "＞It's a direct elevator to 60F."
		;60F直通エレベーターだ
		CALL INPUT_YN_D, "Ride it", "Don't ride it"
		SIF !RESULT
			CALL DUNGEON_WORP_ID, 13, 13007, 1
	CASE 13007
		CALL MESSAGE_WINDOW_D, "", "＞It's a direct elevator to 3F."
		;3F直通エレベーターだ
		CALL INPUT_YN_D, "Ride it", "Don't ride it"
		SIF !RESULT
			CALL DUNGEON_WORP_ID, 12, 12006, 1
	CASEELSE
		IF DA:(FLAG:現X):(FLAG:現Y) % 10 == 6
			CALL DUNGEON_UPSTAIRS_ID, FLAG:現M+1, DA:(FLAG:現X):(FLAG:現Y)+1001
		ELSE
			CALL DUNGEON_DOWNSTAIRS_ID, FLAG:現M-1, DA:(FLAG:現X):(FLAG:現Y)-1001
		ENDIF
ENDSELECT
RETURN 1
;=======
;メッセンジャー(9)
;ARGは進入時の時に真
;ARGがの場合RETURNして打ち切る
;=======
@TILE_MARK_COMMON_17_9, ARG, ARG:1, ARG:2
SETCOLOR 0x00ff00
RESULTS = ｍ
@MESSAGE_17, ARG
SIF ARG
	CALL SHOW_PICTURE, "D"
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 0
		CALL MESSAGE_WINDOW_D, "", "＞モヒカン頭がいる…/＞モヒカン頭は生気がまったくないようで/＞壁にもたれかかっている/＞その手にはしっかりとCOMPが握られたままだ…"
	CASE 100
		CALL MESSAGE_WINDOW_D, "Fallen monk", "この街の者達は信心が足りないのではないか…？/いや、匿ってもらってる身だ…/余計なことは言うまい"
		;破戒僧
	CASE 101
		CALL MESSAGE_WINDOW_D, "Fallen monk", "お主には必ず、ガイアの裁きが下るだろう…"
	CASE 102
		CALL MESSAGE_WINDOW_D, "Demon", "ゴズテンノウ様が支配していると言っても、/基本的には皆やりたい放題/ただ、あまりにも度が過ぎたり、教団からの要請があった場合は/特別に裁判を行う場合もあるらしいよ"
	CASE 103
		CALL MESSAGE_WINDOW_D, "ギャル", "あんたがバラム様殺しぃ？/…ふぅーん…/結構イケてるじゃん"
	CASE 104
		SIF ARG
			RETURN 0
		CALL MESSAGE_WINDOW_D, "Youth", "この街の人々は、/悪魔が混じっててもみんなあまり気にしてないのさ/ゴズテンノウ様が『強ければ何でもあり』な御方だからね"
	CASE 105
		SIF ARG
			RETURN 0
		CALL MESSAGE_WINDOW_D, "ギャル", "歌舞伎町では今、100年に一度の、/No,1フロスト決定戦をやってるんだってぇ！/ちょ〜見にいきた〜い！"
	CASE 106
		SIF ARG
			RETURN 0
		CALL MESSAGE_WINDOW_D, "Demon", "ゴズテンノウ様は、魔王バエル様とも肩を並べる大悪魔なのよ/"
	CASE 107
		CALL MESSAGE_WINDOW_D, "Demon", "お？有名人のお出ましか/バラム様殺しの実行犯が来たって、街中大騒ぎだぜ？"
	CASE 200
		CALL MESSAGE_WINDOW_D, "Demon", "お前はバラム様を殺した奴…！/お前なんかトール様に叩き殺されちゃえ！"
	CASE 201
		SIF ARG
			RETURN 0
		CALL MESSAGE_WINDOW_D, "モヒカン頭", "バラム様を倒したからって調子に乗るなよ！？/マントラ軍の大将、ゴズテンノウ様は/お前なんか屁でもないんだぜ！"
	CASE 202
		CALL MESSAGE_WINDOW_D, "Demon", "マントラ軍に匿ってもらって助かったけど…/これからガイア教はどうなってしまうの…？"
	CASE 203
		CALL MESSAGE_WINDOW_D, "Youth", "最近はこの辺もアルゴン社の看板が多くなってきたな/アルゴン社を知らないのか？/今一番勢いのある半導体精製メーカーだぜ？"
	CASE 204
		CALL MESSAGE_WINDOW_D, "Demon", "ここから池袋全体を見渡してみると分かるんだ/……みんな同じCOMP使ってるなぁって"
	CASE 205
		CALL MESSAGE_WINDOW_D, "ギャル", "トール様ってかっこいいよねぇ〜♪/あなたもそう思わない？"
	CASE 206
		CALL MESSAGE_WINDOW_D, "ギャル", "このぉアルゴン社製のぉCOMPを使ったらぁ/あたしでもぉ簡単にぃ悪魔使いぃって感じぃ？"
	CASE 207
		CALL MESSAGE_WINDOW_D, "Youth", "マントラ軍の掟はただ一つ/『強ければ正義』だ/分かりやすくていいよな"
	CASE 208
		CALL MESSAGE_WINDOW_D, "Demon", "渋谷から逃げてきた連中、/なーんかうるさいな…/ぶっちゃけガイア教とかどうでもいいんだよ/俺達は"
	;ガイア教団支部
	CASE 400
		CALL MESSAGE_WINDOW_D, "Demon", "このビルの屋上からマントラ軍本営に行けるけどよ/あんた、教団に目を付けられてるぜ/行かないほうがいいんじゃねぇか？"
	CASE 401
		CALL MESSAGE_WINDOW_D, "Youth", "この前、いつも口煩かった親父をぶっ殺してやったが…/殺られる親父が悪いってことで、/まったく罪に問われなかったんだ…！"
	CASE 402
		CALL MESSAGE_WINDOW_D, "破戒僧", "バラム様に続き、ゴズテンノウ様まで手に掛けようというのか…？"
	CASE 403
		CALL MESSAGE_WINDOW_D, "Demon", "エレベーターって機械は便利だなぁ/あっという間に4Fまで行けるぜ"
	CASE 600
		CALL MESSAGE_WINDOW_D, "Woman", "あの人が悪いんです…/私達は何もしてないのに、いつも暴力を振るって…"
		CALL MESSAGE_WINDOW_D, "Woman", "だから、COMPを使って、悪魔を呼んで、/始末してもらったんです/私達は悪くありません…/ゴズテンノウ様のお墨付きももらってます"
	CASE 601
		CALL MESSAGE_WINDOW_D, "Man", "この前、メシア教徒をぶっ殺してきたぜ"
		CALL MESSAGE_WINDOW_D, "Woman", "ほんとぉ？/あなたったらかっこい〜！"
	CASE 602
		CALL MESSAGE_WINDOW_D, "Demon", "ガイア教団がこれほど勢力を伸ばした背景には/アルゴン社が開発した新型CPU『クリプト』/そして、それを搭載した新型COMPの普及によるところが多いだろう"
		CALL MESSAGE_WINDOW_D, "Demon", "従来機の数倍の処理スピードで、/我々の召喚ができるのだから/メシア教団では歯が立たないだろうな"
	CASE 700
		CALL MESSAGE_WINDOW_D, "Demon", "やっとここまで来れた…/なんで4Fのエレベーターから直通じゃねーんだよ/マントラ軍本営はよぉ"
	CASE 701
		CALL MESSAGE_WINDOW_D, "Youth", "あれ？あんたのそのCOMP…/アルゴン社製のものじゃないな？/今時そんなレトロなもの使ってるなんて珍しいな/不便じゃないのか？"
	;マントラ軍本営
	CASE 1000
		CALL MESSAGE_WINDOW_D, "ギャル", "トール様に勝てる人なんて初めて見たっていうかー"
	CASE 1001
		CALL MESSAGE_WINDOW_D, "Demon", "マントラ軍は永久に不滅だ！"
	CASE 1002
		CALL MESSAGE_WINDOW_D, "Demon", "ガイア教団全体からは相変わらず睨まれるだろうが/少なくともマントラ軍はあんたの味方だぜ！"
	CASE 1100
		CALL MESSAGE_WINDOW_D, "Demon", "３Ｆのもう一つのエレベーターからは６０Ｆに行けるよ！/それはそれは凄い眺めなんだ！"
	CASE 1101
		CALL MESSAGE_WINDOW_D, "ギャル", "あー！/あんた、かっこよかったよぉ！/写メ撮っていい？"
	CASE 1102
		CALL MESSAGE_WINDOW_D, "Demon", "決闘裁判というのは要するに建前で、/ありゃあ実際は公開リンチなんだ/それに勝ち抜くんだから、あんたすげーよ"
	CASE 1103
		CALL MESSAGE_WINDOW_D, "Youth", "みんながみんな同じCOMPを使ってるのって危険だと思わないか？/もし、すべての機体に共通で細工が施されていたら…/考えただけでゾッとするぜ…！"
	CASE 1200
		CALL MESSAGE_WINDOW_D, "Demon", "あんたの戦いぶりからは勇気をもらったよ/俺も絶対に勝ち抜いて、無罪放免になってやる！"
	CASE 1201
		CALL MESSAGE_WINDOW_D, "Youth", "大丈夫…勝てる…勝てる…/１Ｔ目にサジタリウス…/２Ｔ目からはダブルショット…"
ENDSELECT
;=======================================================================
;エンカウント率
;=======================================================================
@ENCOUNT_RATE_17
SELECTCASE FLAG:現M
	CASE 0, 1, 2
		FLAG:エンカウント率 = MAX(FLAG:未遭遇歩数 - 5, 0) * 3
	CASE 4, 5, 6, 7
		FLAG:エンカウント率 = MAX(FLAG:未遭遇歩数 - 5, 0) * 5
	CASEELSE
		FLAG:エンカウント率 = 0
ENDSELECT
;=======================================================================
;必要レベル目安
;推奨LV 雑魚最低LV 雑魚最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_17
RETURN 30, 30, 35, 43
;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_17
IF RAND:100 < FLAG:エンカウント率
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	FLAG:未遭遇歩数 += 1
	RETURN 0
ENDIF
;=======================================================================
;敵の種族の種類数
;=======================================================================
@CLASS_NUM_17
RETURN CLASS_NUM_COMMON("中級")
;=======================================================================
;敵の総数
;ARGは出現する敵の種類です
;=======================================================================
@ENEMY_NUM_17, ARG
RETURN ENEMY_NUM_COMMON("中級", ARG)
;=======================================================================
;敵の種類
;=======================================================================
@ENEMY_17, ARG
SELECTCASE FLAG:現M
	CASE 0, 1, 2
		SELECTCASE RAND:100
			CASE IS < 10
				RETURN [[キャラ:フーリー]],30
			CASE IS < 20
				RETURN [[キャラ:バンシー]],30
			CASE IS < 25
				RETURN [[キャラ:ヘル]],30
			CASE IS < 35
				RETURN [[キャラ:アルケニー]],28
			CASE IS < 45
				RETURN [[キャラ:ゴルゴン]],29
			CASE IS < 55
				RETURN [[キャラ:エリゴール]],29
			CASE IS < 65
				RETURN [[キャラ:モスマン]],30
			CASE IS < 75
				RETURN [[キャラ:モムノフ]],28
			CASE IS < 85
				RETURN [[キャラ:ハカイソウ]],28
			CASE IS < 95
				RETURN [[キャラ:ミュータント]],29
			CASE IS < 100
				RETURN [[キャラ:アサシン]],32
		ENDSELECT
	CASEELSE
		SELECTCASE RAND:100
			CASE IS < 10
				RETURN [[キャラ:フーリー]],32
			CASE IS < 20
				RETURN [[キャラ:バンシー]],32
			CASE IS < 25
				RETURN [[キャラ:ヘル]],33
			CASE IS < 35
				RETURN [[キャラ:アルケニー]],31
			CASE IS < 45
				RETURN [[キャラ:ゴルゴン]],34
			CASE IS < 55
				RETURN [[キャラ:エリゴール]],32
			CASE IS < 65
				RETURN [[キャラ:モスマン]],32
			CASE IS < 75
				RETURN [[キャラ:モムノフ]],33
			CASE IS < 80
				RETURN [[キャラ:ハカイソウ]],32
			CASE IS < 85
				RETURN [[キャラ:オニジョロウ]],34
			CASE IS < 95
				RETURN [[キャラ:ミュータント]],33
			CASE IS < 100
				RETURN [[キャラ:アサシン]],35
		ENDSELECT
ENDSELECT
;=================================
;特殊調整
;=================================
@SET_ENEMY_STATUS_17, ARG
SELECTCASE NO:ARG
	CASE [[キャラ:ヴィーヴル]]
		ABL:ARG:アイテム2 = 1002
		ABL:ARG:入手確率2 = 15
	CASE [[キャラ:アエーシュマ]]
		ABL:ARG:アイテム1 = 1002
		ABL:ARG:入手確率1 = 10
		ABL:ARG:アイテム2 = 1017
		ABL:ARG:入手確率2 = 5
	CASE [[キャラ:マンイーター]]
		ABL:ARG:アイテム2 = 3501
		ABL:ARG:入手確率2 = 5
		ABL:ARG:アイテム3 = 1018
		ABL:ARG:入手確率3 = 5
	CASE [[キャラ:エルフ]]
		ABL:ARG:アイテム2 = 1002
		ABL:ARG:入手確率2 = 15
	CASE [[キャラ:セイレーン]]
		ABL:ARG:アイテム1 = 1002
		ABL:ARG:入手確率1 = 10
	CASE [[キャラ:バンシー]]
		ABL:ARG:アイテム2 = 1002
		ABL:ARG:入手確率2 = 10
	CASE [[キャラ:ヘル]],30,0, 0
		ABL:ARG:アイテム1 = 1002
		ABL:ARG:入手確率1 = 10
		ABL:ARG:アイテム2 = 5504
		ABL:ARG:入手確率2 = 2
ENDSELECT


@SET_ACTION_1406,ARG
IF FLAG:経過ターン数 % 3 == 2
	IF CFLAG:ARG:行動した回数 == 0
		CFLAG:(CHARANUM-1):速度補正 = 24
		CALL CHECK_ACTIONABLE,ARG,402
		SIF RESULT == 0
			GOTO DECIDE_ACTION
		CFLAG:ARG:入力行動 = 402
		CALL RANDOM_TARGET,ARG,402
		RETURN 1
	ELSEIF CFLAG:ARG:行動した回数 == 1
		CFLAG:(CHARANUM-1):速度補正 = 24
		CALL CHECK_ACTIONABLE,ARG,508
			SIF RESULT == 0
				GOTO DECIDE_ACTION
		CFLAG:ARG:入力行動 = 508
		CALL RANDOM_TARGET,ARG,508
		RETURN 1
	ENDIF
ELSEIF CFLAG:ARG:攻撃強化 < 0 || CFLAG:ARG:防御強化 < 0 || CFLAG:ARG:命中強化 < 0
	IF RAND:2 == 0
		CFLAG:(CHARANUM-1):速度補正 = 24
		CALL CHECK_ACTIONABLE,ARG,505
			SIF RESULT == 0
				GOTO DECIDE_ACTION
		CFLAG:ARG:入力行動 = 505
		CALL RANDOM_TARGET,ARG,505
		RETURN 1
	ELSE
		GOTO DECIDE_ACTION
		RETURN 1
	ENDIF
ELSEIF CFLAG:MASTER:防御強化 > -1
		CFLAG:(CHARANUM-1):速度補正 = 24
		CALL CHECK_ACTIONABLE,ARG,515
			SIF RESULT == 0
				GOTO DECIDE_ACTION
		CFLAG:ARG:入力行動 = 515
		CALL RANDOM_TARGET,ARG,515
		RETURN 1
ELSEIF CFLAG:MASTER:攻撃強化 > 4 || CFLAG:MASTER:命中強化 > 4
		CFLAG:(CHARANUM-1):速度補正 = 24
		CALL CHECK_ACTIONABLE,ARG,509
			SIF RESULT == 0
				GOTO DECIDE_ACTION
		CFLAG:ARG:入力行動 = 509
		CALL RANDOM_TARGET,ARG,509
		RETURN 1
ELSE
	$DECIDE_ACTION
	CALL SEARCH_ACT,ARG
	IF RESULT == 0
		CFLAG:ARG:入力行動 = -1
		CFLAG:ARG:防御フラグ = 1
		RETURN 0
	ENDIF
	LOCAL = RAND:RESULT
	;スキル番号決定
	LOCAL:1 = S:(10+LOCAL)
	$TARGET_LOOP
	
	CALL RANDOM_TARGET,ARG,LOCAL:1
	CALLFORM SKILL_TARGET_{LOCAL:1}
	;ここでスキル番号を行動内容に代入
	SIF CFLAG:ARG:ターゲット == -1
		GOTO DECIDE_ACTION
	CFLAG:ARG:入力行動 = LOCAL:1
ENDIF

;=================================
;思考パターン
;=================================
@ENEMY_BATTLE_MESSAGE_4542, ARG
IF CFLAG:ARG:入力行動 == 527
	IF RAND:2 == 0
		PRINTFORML ┏>MESSAGE━━━━━━━━━━━┓
		PRINTFORML ┃デカジャー！！　　　　　　　　┃
		PRINTFORML ┃あたしのライドウを　　　　　　┃
		PRINTFORML ┃いぢめたら許さないからねっ!!　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━━┛
	ELSE
		PRINTFORML ┏>MESSAGE━━━━━━━━━━━━┓
		PRINTFORML ┃Raptorモー・ショボーだよ　　　　　┃
		PRINTFORML ┃小さいからってバカにしないで　　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━━━┛
	ENDIF
ELSEIF CFLAG:ARG:入力行動 == 915
	IF RAND:2 == 0
		PRINTFORML ┏>MESSAGE━━━━┓
		PRINTFORML ┃イ…イッイッ…　┃
		PRINTFORML ┃イグゥッ…　　　┃
		PRINTFORMW ┗━━━━━━━━┛
	ELSE
		PRINTFORML ┏>MESSAGE━━━━━━┓
		PRINTFORML ┃ウ…ウッウッ…　　　┃
		PRINTFORMW ┃デ、デルゥウウッ!!　┃
		PRINTFORMW ┗━━━━━━━━━━┛
	ENDIF
ELSEIF CFLAG:ARG:入力行動 == 1709
	IF RAND:2 == 0
		PRINTFORML ┏>MESSAGE━━━━━━━━━━━━━━┓
		PRINTFORML ┃人使いが荒いのぉ　　　　　　　　　　┃
		PRINTFORML ┃わっしゃしゃ、ワシは悪魔じゃったな　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━━━━━┛
	ELSE
		PRINTFORML ┏>MESSAGE━━━━━━━━━━━━┓
		PRINTFORML ┃そぉい！！　　　　　　　　　　　┃
		PRINTFORML ┃地の果てまで飛んでいくがいいわ　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━━━┛
	ENDIF
ELSEIF CFLAG:ARG:入力行動 == 117
	IF RAND:2 == 0
		PRINTFORML ┏>MESSAGE━━━━━━━━┓
		PRINTFORML ┃ブ、ブッブブッブブ！！　┃
		PRINTFORMW ┗━━━━━━━━━━━━┛
	ELSE
		PRINTFORML ┏>MESSAGE━━━━━━━━━━┓
		PRINTFORML ┃ア、アァァァァッアッァ！！　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━┛
	ENDIF
ELSEIF CFLAG:ARG:入力行動 == 18
	IF RAND:3 == 0
		PRINTFORML ┏>MESSAGE━━━━━━━━━━━━━━━┓
		PRINTFORML ┃ったく…　　　　　　　　　　　　　　　┃
		PRINTFORML ┃つまんねー用事で呼んでんじゃねえぞ　　┃
		PRINTFORML ┃オラオラオラオラオラオラオラオラ！！　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━━━━━━┛
	ELSEIF RAND:2 == 0
		PRINTFORML ┏>MESSAGE━━━━━━━━━━┓
		PRINTFORML ┃コチとらアナーキーよ　　　　┃
		PRINTFORML ┃八枚におろしてやんぜぇ！！　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━┛
	ELSE
		PRINTFORML ┏>MESSAGE━━━━━━━━━━━━━┓
		PRINTFORML ┃クールじゃねえなぁ、手前はよ　　　┃
		PRINTFORML ┃風通しよくしてやるぜええ！！　　　┃
		PRINTFORMW ┗━━━━━━━━━━━━━━━━━┛
	ENDIF
ENDIF

;葛葉ライドウの思考パターン
@SET_ACTION_4542,ARG
;1more
IF CFLAG:ARG:１moreフラグ == 2
	IF CFLAG:MASTER:防御強化 > -1
		CFLAG:(CHARANUM-1):速度補正 = 25
		CALL CHECK_ACTIONABLE,ARG,515
			SIF RESULT == 0
				GOTO DECIDE_ACTION
		CFLAG:ARG:入力行動 = 515
		CALL RANDOM_TARGET,ARG,515
		RETURN 1
	ELSEIF CFLAG:MASTER:攻撃強化 > 4 || CFLAG:MASTER:命中強化 > 4
		CFLAG:(CHARANUM-1):速度補正 = 25
		CALL CHECK_ACTIONABLE,ARG,527
			SIF RESULT == 0
				GOTO DECIDE_ACTION
		CFLAG:ARG:入力行動 = 527
		CALL RANDOM_TARGET,ARG,527
		RETURN 1
	ELSE
		IF RAND:3 == 0
			;モコイブーメラン
			CFLAG:(CHARANUM-1):速度補正 = 25
			CALL CHECK_ACTIONABLE,ARG,117
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:入力行動 = 117
			CALL RANDOM_TARGET,ARG,117
			RETURN 1
		ELSEIF RAND:2 == 0
			;ミシャグジ雷電
			CFLAG:(CHARANUM-1):速度補正 = 25
			CALL CHECK_ACTIONABLE,ARG,915
				SIF RESULT == 0
					GOTO DECIDE_ACTION
			CFLAG:ARG:入力行動 = 915
			CALL RANDOM_TARGET,ARG,915
			RETURN 1
		ELSE
			;ヒトコト大風
			CFLAG:(CHARANUM-1):速度補正 = 25
			CALL CHECK_ACTIONABLE,ARG,1709
				SIF RESULT == 0
					GOTO DECIDE_ACTION
			CFLAG:ARG:入力行動 = 1709
			CALL RANDOM_TARGET,ARG,1709
			RETURN 1
		ENDIF
	ENDIF
	
;ＨＰ50％以下
ELSEIF 現HP割合(ARG) < 50
	IF CFLAG:ARG:行動した回数 == 0
		IF CFLAG:MASTER:攻撃強化 > 4 || CFLAG:MASTER:命中強化 > 4
			CFLAG:(CHARANUM-1):速度補正 = 25
			CALL CHECK_ACTIONABLE,ARG,527
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:入力行動 = 527
			CALL RANDOM_TARGET,ARG,527
			RETURN 1
		ELSE
			SELECTCASE RAND:100
				CASE IS < 50
					;ヨシツネ見参
					CALL CHECK_ACTIONABLE,ARG,18
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 18
					CALL RANDOM_TARGET,ARG,18
					RETURN 1
				CASE IS < 75
					;ミシャグジ雷電
					CFLAG:(CHARANUM-1):速度補正 = 25
					CALL CHECK_ACTIONABLE,ARG,915
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 915
					CALL RANDOM_TARGET,ARG,915
					RETURN 1
				CASE IS < 100
					;ヒトコト大風
					CFLAG:(CHARANUM-1):速度補正 = 25
					CALL CHECK_ACTIONABLE,ARG,1709
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 1709
					CALL RANDOM_TARGET,ARG,1709
					RETURN 1
			ENDSELECT
		ENDIF

	ELSEIF CFLAG:ARG:行動した回数 == 1
		SELECTCASE RAND:100
			CASE IS < 15
				;ヨシツネ見参
				CALL CHECK_ACTIONABLE,ARG,18
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 18
				CALL RANDOM_TARGET,ARG,18
				RETURN 1
			CASE IS < 40
				;モコイブーメラン
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,117
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 117
				CALL RANDOM_TARGET,ARG,117
				RETURN 1
			CASE IS < 65
				;ミシャグジ雷電
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,915
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 915
				CALL RANDOM_TARGET,ARG,915
				RETURN 1
			CASE IS < 90
				;ヒトコト大風
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,1709
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 1709
				CALL RANDOM_TARGET,ARG,1709
				RETURN 1
		ENDSELECT
	ENDIF
;ＨＰ50％以上
ELSEIF 現HP割合(ARG) >= 50
	IF CFLAG:ARG:行動した回数 == 0
		IF CFLAG:MASTER:防御強化 > -1
			CFLAG:(CHARANUM-1):速度補正 = 25
			CALL CHECK_ACTIONABLE,ARG,515
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:入力行動 = 515
			CALL RANDOM_TARGET,ARG,515
			RETURN 1
		ELSEIF CFLAG:MASTER:攻撃強化 > 4 || CFLAG:MASTER:命中強化 > 4
			CFLAG:(CHARANUM-1):速度補正 = 25
			CALL CHECK_ACTIONABLE,ARG,527
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:入力行動 = 527
			CALL RANDOM_TARGET,ARG,527
			RETURN 1
		ELSE
			SELECTCASE RAND:100
				CASE IS < 40
					;ブギウギ
					CFLAG:(CHARANUM-1):速度補正 = 25
					CALL CHECK_ACTIONABLE,ARG,118
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 118
					CALL RANDOM_TARGET,ARG,118
					RETURN 1
				CASE IS < 60
					;的殺
					CFLAG:(CHARANUM-1):速度補正 = 25
					CALL CHECK_ACTIONABLE,ARG,2032
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 2032
					CALL RANDOM_TARGET,ARG,2032
					RETURN 1
				CASE IS < 80
					;モコイブーメラン
					CFLAG:(CHARANUM-1):速度補正 = 25
					CALL CHECK_ACTIONABLE,ARG,117
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 117
					CALL RANDOM_TARGET,ARG,117
					RETURN 1
				CASE IS < 90
					;ミシャグジ雷電
					CFLAG:(CHARANUM-1):速度補正 = 25
					CALL CHECK_ACTIONABLE,ARG,915
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 915
					CALL RANDOM_TARGET,ARG,915
					RETURN 1
				CASE IS < 100
					;ヒトコト大風
					CFLAG:(CHARANUM-1):速度補正 = 25
					CALL CHECK_ACTIONABLE,ARG,1709
					SIF RESULT == 0
						GOTO DECIDE_ACTION
					CFLAG:ARG:入力行動 = 1709
					CALL RANDOM_TARGET,ARG,1709
					RETURN 1
			ENDSELECT
		ENDIF
	ELSEIF CFLAG:ARG:行動した回数 == 1
		SELECTCASE RAND:100
			CASE IS < 40
				;ブギウギ
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,118
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 118
				CALL RANDOM_TARGET,ARG,118
				RETURN 1
			CASE IS < 70
				;的殺
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,2032
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 2032
				CALL RANDOM_TARGET,ARG,2032
				RETURN 1
			CASE IS < 80
				;モコイ
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,117
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 117
				CALL RANDOM_TARGET,ARG,117
				RETURN 1
			CASE IS < 90
				;ミシャグジ雷電
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,915
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 915
				CALL RANDOM_TARGET,ARG,915
				RETURN 1
			CASE IS < 100
				;ヒトコト大風
				CFLAG:(CHARANUM-1):速度補正 = 25
				CALL CHECK_ACTIONABLE,ARG,1709
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:入力行動 = 1709
				CALL RANDOM_TARGET,ARG,1709
				RETURN 1
		ENDSELECT
	ENDIF
ELSE
	$DECIDE_ACTION
	CALL SEARCH_ACT,ARG
	IF RESULT == 0
		CFLAG:ARG:入力行動 = -1
		CFLAG:ARG:防御フラグ = 1
		RETURN 0
	ENDIF
;	PRINTFORML [{CFLAG:ARG:5}]のスキル数 {RESULT}
	LOCAL = RAND:RESULT
	;スキル番号決定
	LOCAL:1 = S:(10+LOCAL)
;	PRINTFORML [{CFLAG:ARG:5}]のスキル {LOCAL:1}
	$TARGET_LOOP
	
	CALL RANDOM_TARGET,ARG,LOCAL:1
	CALLFORM SKILL_TARGET_{LOCAL:1}
	;ここでスキル番号を行動内容に代入
	SIF CFLAG:ARG:ターゲット == -1
		GOTO DECIDE_ACTION
	CFLAG:ARG:入力行動 = LOCAL:1
ENDIF

;=======================================================================
;輪姦参加悪魔
;=======================================================================
@DUNGEON_RAPE_DEVIL_17
;ランダムにどの悪魔が出るか決定
;RETURN CSV番号 , 人数 , レベル
SELECTCASE RAND:4
	CASE 0
		RETURN [[キャラ:モムノフ]] , 3 + RAND:10 , CSVBASE([[キャラ:モムノフ]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 1
		RETURN [[キャラ:ミュータント]] , 3 + RAND:10 , CSVBASE([[キャラ:ミュータント]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 2
		RETURN [[キャラ:ハカイソウ]] , 3 + RAND:10 , CSVBASE([[キャラ:ハカイソウ]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 3
		RETURN [[キャラ:モスマン]] , 3 + RAND:10 , CSVBASE([[キャラ:モスマン]] , GETNUM(BASE , "LV") , 0) + RAND:3
ENDSELECT
