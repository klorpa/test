;コロシアム
;とりあえず今の所戦闘のテスト用
;クリアフラグにダンジョンフラグ:100:Xを使用


@SHOPCOMABLE_103
;パーティに一人以上いるなら
LOCAL = 0
REPEAT CHARANUM
	SIF CFLAG:COUNT:PTフラグ == 2
		LOCAL:1 += 1
REND

FOR LOCAL, 0, 999
	TRYCCALLFORM PLAYABLE_EVENT_{LOCAL}
		IF RESULT
			LOCAL:2 += 1
		ENDIF
	CATCH
	ENDCATCH
NEXT

RESULTS = Event
IF LOCAL:1 > 0 && LOCAL:2 > 0
	RETURN 1
ELSE
	RETURN 0
ENDIF


@SHOW_EVENT
CUSTOMDRAWLINE =

FOR LOCAL, 0, 999
	TFLAG:LOCAL = 0
	RESULTS = 
	TRYCCALLFORM PLAYABLE_EVENT_{LOCAL}
		IF RESULT
			TFLAG:LOCAL = 1
			IF RESULTS != ""
				PRINTFORML [{LOCAL}] - %RESULTS%
			ENDIF
		ENDIF
	CATCH
		
	ENDCATCH
NEXT

@SHOP_COM_103
CALL SHOW_EVENT
PRINTL [1000] Return

DRAWLINE
PRINTL Which event happens?

$INPUT_LOOP
INPUT
IF RESULT == 1000
	FLAG:ショップコマンド = 0
	RETURN 0
ELSEIF RESULT < 0 || RESULT >= VARSIZE("TFLAG")
	GOTO INPUT_LOOP
ELSEIF TFLAG:RESULT || FLAG:DEBUG
	FLAG:進行中イベント = RESULT
	TRYCALLFORM SHOPCOM_EVENT_{RESULT}
	FOR LOCAL,0,CHARANUM
		SIF CFLAG:LOCAL:悪魔変身 == 1
			CALL ACTION_2310 , LOCAL , 0
	NEXT
	FLAG:進行中イベント = 0
	FLAG:ショップコマンド = 0
	IF RESULT == 1
		VARSET TFLAG,-1
		BEGIN TURNEND
	ENDIF
ELSE
	GOTO INPUT_LOOP
ENDIF

VARSET TFLAG,-1
RETURN 0


