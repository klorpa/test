;-------------------------------------------------
;バイブなど付けっぱなしアイテムのチェック
;-------------------------------------------------
@EQUIP_CHECK
;着衣の処理
CALL EQUIP_CLOTHES
;着衣のソース増加効果
CALL CHECK_SOURCE,MASTER
CALL CHECK_SOURCE,TARGET
SIF ASSI > -1
	CALL CHECK_SOURCE,ASSI


;クリキャップ装着中
SIF TEQUIP:11
	CALL EQUIP_COM42

;オナホール装着中
SIF TEQUIP:12
	CALL EQUIP_COM43

;バイブ装着中
SIF TEQUIP:13
	CALL EQUIP_COM44

;アナルバイブ装着中
SIF TEQUIP:14
	CALL EQUIP_COM45

;アナルビーズ使用中
SIF TEQUIP:15
	CALL EQUIP_COM46

;二プルキャップ装着中
SIF TEQUIP:16
	CALL EQUIP_COM47

;搾乳器装着中
SIF TEQUIP:17
	CALL EQUIP_COM49

;三角木馬装着中
SIF TEQUIP:41
	CALL EQUIP_COM108

;リボン装着中
SIF TEQUIP:42
	CALL EQUIP_COM109

;クリキャップ装着中(調教者)
SIF TEQUIP:PLAYER:11
	CALL EQUIP_COM50

;オナホール装着中(調教者)
SIF TEQUIP:PLAYER:12
	CALL EQUIP_COM51

;バイブ装着中(調教者)
SIF TEQUIP:PLAYER:13
	CALL EQUIP_COM52

;アナルバイブ装着中(調教者)
SIF TEQUIP:PLAYER:14
	CALL EQUIP_COM53

;アナルビーズ使用中(調教者)
SIF TEQUIP:PLAYER:15
	CALL EQUIP_COM54

;二プルキャップ装着中(調教者)
SIF TEQUIP:PLAYER:16
	CALL EQUIP_COM55

;搾乳器装着中(調教者)
SIF TEQUIP:PLAYER:17
	CALL EQUIP_COM56

;アイマスク装着中
SIF TEQUIP:18
	CALL EQUIP_COM105

;縄で緊縛中
SIF TEQUIP:19
	CALL EQUIP_COM106

;ボールギャグ装着中
SIF TEQUIP:20
	CALL EQUIP_COM107

;浣腸＋アナルプラグ装着中
SIF TEQUIP:21
	CALL EQUIP_COM146

;拡張バルーン装着中
SIF TEQUIP:22
	CALL EQUIP_COM148

;アナル電極装着中
SIF TEQUIP:23
	CALL EQUIP_COM149

;乳房電極装着中
SIF TEQUIP:24
	CALL EQUIP_COM150

;触手調教中
SIF TEQUIP:25
	CALL EQUIP_COM160

;ビデオ撮影中
SIF TEQUIP:28
	CALL EQUIP_COM183


;野外プレイ中(廃ビル)
SIF TEQUIP:29 & 1
	CALL EQUIP_COM184_B

;野外プレイ中(森林)
SIF TEQUIP:29 & 2
	CALL EQUIP_COM184_F

;野外プレイ中(公園)
SIF TEQUIP:29 & 4
	CALL EQUIP_COM184_P

;野外プレイ中(水辺)
SIF TEQUIP:29 & 8
	CALL EQUIP_COM184_U

;野外プレイ中(共通)
SIF TEQUIP:29 && FLAG:46
	CALL EQUIP_COM184

;羞恥プレイ中
SIF TEQUIP:30
	CALL EQUIP_COM186

;お風呂場プレイ中
SIF TEQUIP:31
	CALL EQUIP_COM187

;シャワー使用中
SIF TEQUIP:32
	CALL EQUIP_COM188

;新妻プレイ中
SIF TEQUIP:33
	CALL EQUIP_COM189

;強精神薬の効果発揮中／強精神薬の反動処理
SIF TEQUIP:34
	CALL EQUIP_COM191

;触手口辱中
SIF TEQUIP:36
	CALL EQUIP_COM168

RETURN 1


;-------------------------------------------------
;主人による調教のボーナス
;-------------------------------------------------
@MASTER_SKILL_CHECK, ARG
;依存度ボーナス
IF ASSIPLAY == 0
	;正ベクトル
	IF CFLAG:2 >= 5000
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ, 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:情愛 , 1.50
		
		TIMES SOURCE:ARG:不潔 , 0.50
		TIMES SOURCE:ARG:逸脱 , 0.50
	ELSEIF CFLAG:2 >= 2000
		TIMES SOURCE:ARG:快Ｃ , 1.20
		TIMES SOURCE:ARG:快Ｖ, 1.20
		TIMES SOURCE:ARG:快Ａ , 1.20
		TIMES SOURCE:ARG:快Ｂ , 1.20
		TIMES SOURCE:ARG:情愛 , 1.30
		
		TIMES SOURCE:ARG:不潔 , 0.70
		TIMES SOURCE:ARG:逸脱 , 0.70
	ELSEIF CFLAG:2 >= 1000
		TIMES SOURCE:ARG:快Ｃ , 1.10
		TIMES SOURCE:ARG:快Ｖ, 1.10
		TIMES SOURCE:ARG:快Ａ , 1.10
		TIMES SOURCE:ARG:快Ｂ , 1.10
		TIMES SOURCE:ARG:情愛 , 1.20
		
		TIMES SOURCE:ARG:不潔 , 0.80
		TIMES SOURCE:ARG:逸脱 , 0.80
	ELSEIF CFLAG:2 >= 500
		TIMES SOURCE:ARG:情愛 , 1.10
		
		TIMES SOURCE:ARG:不潔 , 0.90
		TIMES SOURCE:ARG:逸脱 , 0.90
	;負ベクトル
	ELSEIF CFLAG:2 <= -5000
		TIMES SOURCE:ARG:恐れ , 1.40
		TIMES SOURCE:ARG:中毒充足 , 1.40
		TIMES SOURCE:ARG:屈従 , 1.50
		
		TIMES SOURCE:ARG:鬱屈 , 0.50
		TIMES SOURCE:ARG:反感 , 0.50
	ELSEIF CFLAG:2 <= -2000
		TIMES SOURCE:ARG:恐れ , 1.20
		TIMES SOURCE:ARG:中毒充足 , 1.20
		TIMES SOURCE:ARG:屈従 , 1.30
		
		TIMES SOURCE:ARG:鬱屈 , 0.70
		TIMES SOURCE:ARG:反感 , 0.70
	ELSEIF CFLAG:2 <= -1000
		TIMES SOURCE:ARG:恐れ , 1.10
		TIMES SOURCE:ARG:中毒充足 , 1.10
		TIMES SOURCE:ARG:屈従 , 1.20
		
		TIMES SOURCE:ARG:鬱屈 , 0.80
		TIMES SOURCE:ARG:反感 , 0.80
	ELSEIF CFLAG:2 <= -500
		TIMES SOURCE:ARG:屈従 , 1.10
		
		TIMES SOURCE:ARG:鬱屈 , 0.90
		TIMES SOURCE:ARG:反感 , 0.90
	ENDIF
ENDIF

;-------------------------------------------------
;処女喪失時の処理
;-------------------------------------------------
@LOST_VIRGIN
IF TALENT:0 && TFLAG:19
	PRINTW Virginity Lost
	;TALENT:TARGET:0 = 0
	;処女喪失フラグ(今回のコマンド)
	TFLAG:3 = 1
	;処女喪失フラグ(今回の調教)
	TFLAG:31 = 1
	;処女喪失フラグ(ビデオ撮影)
	IF TEQUIP:28
		CALL ADDS_ABNORMAL_EXP, "Lost virginity（Filming）", TARGET
		TFLAG:39 = 1
	ENDIF
	;貞操観念
	IF TALENT:TARGET:30
		TIMES SOURCE:TARGET:情愛 , 0.60
		TIMES SOURCE:TARGET:反感 , 10.00
	;貞操観念+恋慕or親愛（主人による処女喪失のみ）
	ELSEIF TALENT:TARGET:30 && TFLAG:19 && !IS_LOVER(TARGET)
		TIMES SOURCE:TARGET:情愛 , 1.20
		TIMES SOURCE:TARGET:反感 , 0.50
	;貞操無頓着
	ELSEIF TALENT:TARGET:31
		TIMES SOURCE:TARGET:情愛 , 0.60
		TIMES SOURCE:TARGET:反感 , 0.50
	ENDIF
	;指挿入れの慣らしギミック処理
	IF PALAM:TARGET:1 >= 80
		TIMES SOURCE:TARGET:快Ｖ, 1.50
		TIMES SOURCE:TARGET:情愛 , 1.20
		TIMES SOURCE:TARGET:痛み , 0.80
		TIMES SOURCE:TARGET:反感 , 0.80
	ELSEIF PALAM:TARGET:1 >= 60
		TIMES SOURCE:TARGET:快Ｖ, 1.40
		TIMES SOURCE:TARGET:情愛 , 1.15
		TIMES SOURCE:TARGET:痛み , 0.85
		TIMES SOURCE:TARGET:反感 , 0.85
	ELSEIF PALAM:TARGET:1 >= 40
		TIMES SOURCE:TARGET:快Ｖ, 1.30
		TIMES SOURCE:TARGET:情愛 , 1.10
		TIMES SOURCE:TARGET:痛み , 0.90
		TIMES SOURCE:TARGET:反感 , 0.90
	ELSEIF PALAM:TARGET:1 >= 20
		TIMES SOURCE:TARGET:快Ｖ, 1.20
		TIMES SOURCE:TARGET:情愛 , 1.05
		TIMES SOURCE:TARGET:痛み , 0.95
		TIMES SOURCE:TARGET:反感 , 0.95
	ENDIF
	;陥落素質による処理
	IF TFLAG:20
		;恋慕かつ相手が主人
		IF TALENT:TARGET:3 && TFLAG:20
			;PRINTFORML %CALLNAME:TARGET%は%CALLNAME:MASTER%に処女を捧げられた事に幸福を感じているようだ……
			TFLAG:150 = 2
			TIMES SOURCE:TARGET:情愛 , 2.00
			TIMES SOURCE:TARGET:反感 , 0.30
		;親愛かつ相手が主人
		ELSEIF TALENT:TARGET:6 && TFLAG:20
			;PRINTFORML %CALLNAME:TARGET%は%CALLNAME:MASTER%が初めての相手である事にこの上ない幸せを感じているようだ……
			TFLAG:150 = 2
			TIMES SOURCE:TARGET:情愛 , 2.00
			TIMES SOURCE:TARGET:反感 , 0.10
		ENDIF
		;行為によって、LoveEXPを加算する
		;正常位
		IF SELECTCOM == 60
			;PRINTFORML %EXPNAME:23%+10
			CALL ADDS_EXP("愛情経験", 10, TARGET)
		;後背位
		ELSEIF SELECTCOM == 61
			;PRINTFORML %EXPNAME:23%+5
			CALL ADDS_EXP("愛情経験", 5, TARGET)
		;騎乗位
		ELSEIF SELECTCOM == 66
			;PRINTFORML %EXPNAME:23%+5
			CALL ADDS_EXP("愛情経験", 5, TARGET)
		;対面座位
		ELSEIF SELECTCOM == 68
			;PRINTFORML %EXPNAME:23%+8
			CALL ADDS_EXP("愛情経験", 8, TARGET)
		;背面座位
		ELSEIF SELECTCOM == 69
			;PRINTFORML %EXPNAME:23%+5
			CALL ADDS_EXP("愛情経験", 5, TARGET)
		;３Ｐ
		ELSEIF SELECTCOM == 500
			;PRINTFORML %EXPNAME:23%+5
			CALL ADDS_EXP("愛情経験", 5, TARGET)
		;乱れ牡丹
		ELSEIF SELECTCOM == 504
			;PRINTFORML %EXPNAME:23%+5
			CALL ADDS_EXP("愛情経験", 5, TARGET)
		;騎乗乳房自慰
		ELSEIF SELECTCOM == 505
			;PRINTFORML %EXPNAME:23%+5
			CALL ADDS_EXP("愛情経験", 5, TARGET)
		ENDIF
	ENDIF
ENDIF

;-------------------------------------------------
;再生処女喪失のチェック
;-------------------------------------------------
IF TALENT:TARGET:1 && TFLAG:19
	PRINTW Restored Virginity Lost
	;TALENT:TARGET:1 = 0
	;指挿入れの慣らしギミック処理
	IF PALAM:TARGET:1 >= 80
		TIMES SOURCE:TARGET:痛み , 0.80
	ELSEIF PALAM:TARGET:1 >= 60
		TIMES SOURCE:TARGET:痛み , 0.85
	ELSEIF PALAM:TARGET:1 >= 40
		TIMES SOURCE:TARGET:痛み , 0.90
	ELSEIF PALAM:TARGET:1 >= 20
		TIMES SOURCE:TARGET:痛み , 0.95
	ENDIF
ENDIF



;-------------------------------------------------
;技巧のチェック
;-------------------------------------------------
@TECHNIQUE_CHECK, ARG, ARG:1
;行為をしている者の技巧をチェックする
;奴隷の場合
;IF TFLAG:28 == 1
	;奴隷のABL:技巧
	IF ABL:ARG:2 == 0
		;TIMES SOURCE:ARG:快Ｃ , 0.50
		;TIMES SOURCE:ARG:快Ｖ, 0.50
		;TIMES SOURCE:ARG:快Ａ , 0.50
		;TIMES SOURCE:ARG:快Ｂ , 0.50
		TIMES SOURCE:(ARG:1):0 , 0.50
		TIMES SOURCE:(ARG:1):1 , 0.50
		TIMES SOURCE:(ARG:1):2 , 0.50
		TIMES SOURCE:(ARG:1):3 , 0.50
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.00
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.00
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.00
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.00
		TIMES SOURCE:ARG:性行動 , 0.50
	ELSEIF ABL:ARG:2 == 1
		;TIMES SOURCE:ARG:快Ｃ , 0.60
		;TIMES SOURCE:ARG:快Ｖ, 0.60
		;TIMES SOURCE:ARG:快Ａ , 0.60
		;TIMES SOURCE:ARG:快Ｂ , 0.60
		TIMES SOURCE:(ARG:1):0 , 0.60
		TIMES SOURCE:(ARG:1):1 , 0.60
		TIMES SOURCE:(ARG:1):2 , 0.60
		TIMES SOURCE:(ARG:1):3 , 0.60
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.05
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.05
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.05
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.05
		TIMES SOURCE:ARG:性行動 , 0.55
	ELSEIF ABL:ARG:2 == 2
		;TIMES SOURCE:ARG:快Ｃ , 0.80
		;TIMES SOURCE:ARG:快Ｖ, 0.80
		;TIMES SOURCE:ARG:快Ａ , 0.80
		;TIMES SOURCE:ARG:快Ｂ , 0.80
		TIMES SOURCE:(ARG:1):0 , 0.80
		TIMES SOURCE:(ARG:1):1 , 0.80
		TIMES SOURCE:(ARG:1):2 , 0.80
		TIMES SOURCE:(ARG:1):3 , 0.80
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.10
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.10
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.10
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.10
		TIMES SOURCE:ARG:性行動 , 0.70
	ELSEIF ABL:ARG:2 == 3
		;TIMES SOURCE:ARG:快Ｃ , 1.00
		;TIMES SOURCE:ARG:快Ｖ, 1.00
		;TIMES SOURCE:ARG:快Ａ , 1.00
		;TIMES SOURCE:ARG:快Ｂ , 1.00
		TIMES SOURCE:(ARG:1):0 , 1.00
		TIMES SOURCE:(ARG:1):1 , 1.00
		TIMES SOURCE:(ARG:1):2 , 1.00
		TIMES SOURCE:(ARG:1):3 , 1.00
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.15
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.15
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.15
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.15
		TIMES SOURCE:ARG:性行動 , 0.90
	ELSEIF ABL:ARG:2 == 4
		;TIMES SOURCE:ARG:快Ｃ , 1.20
		;TIMES SOURCE:ARG:快Ｖ, 1.20
		;TIMES SOURCE:ARG:快Ａ , 1.20
		;TIMES SOURCE:ARG:快Ｂ , 1.20
		TIMES SOURCE:(ARG:1):0 , 1.20
		TIMES SOURCE:(ARG:1):1 , 1.20
		TIMES SOURCE:(ARG:1):2 , 1.20
		TIMES SOURCE:(ARG:1):3 , 1.20
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.20
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.20
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.20
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.20
		TIMES SOURCE:ARG:性行動 , 1.20
	ELSEIF ABL:ARG:2 == 5
		;TIMES SOURCE:ARG:快Ｃ , 1.50
		;TIMES SOURCE:ARG:快Ｖ, 1.50
		;TIMES SOURCE:ARG:快Ａ , 1.50
		;TIMES SOURCE:ARG:快Ｂ , 1.50
		TIMES SOURCE:(ARG:1):0 , 1.50
		TIMES SOURCE:(ARG:1):1 , 1.50
		TIMES SOURCE:(ARG:1):2 , 1.50
		TIMES SOURCE:(ARG:1):3 , 1.50
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.25
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.25
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.25
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.25
		TIMES SOURCE:ARG:性行動 , 1.50
	ELSEIF ABL:ARG:2 == 6
		;TIMES SOURCE:ARG:快Ｃ , 1.80
		;TIMES SOURCE:ARG:快Ｖ, 1.80
		;TIMES SOURCE:ARG:快Ａ , 1.80
		;TIMES SOURCE:ARG:快Ｂ , 1.80
		TIMES SOURCE:ARG:性行動 , 1.80
		TIMES SOURCE:(ARG:1):0 , 1.80
		TIMES SOURCE:(ARG:1):1 , 1.80
		TIMES SOURCE:(ARG:1):2 , 1.80
		TIMES SOURCE:(ARG:1):3 , 1.80
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.30
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.30
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.30
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.30
	ELSEIF ABL:ARG:2 == 7
		;TIMES SOURCE:ARG:快Ｃ , 2.10
		;TIMES SOURCE:ARG:快Ｖ, 2.10
		;TIMES SOURCE:ARG:快Ａ , 2.10
		;TIMES SOURCE:ARG:快Ｂ , 2.10
		TIMES SOURCE:ARG:性行動 , 2.10
		TIMES SOURCE:(ARG:1):0 , 2.10
		TIMES SOURCE:(ARG:1):1 , 2.10
		TIMES SOURCE:(ARG:1):2 , 2.10
		TIMES SOURCE:(ARG:1):3 , 2.10
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.35
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.35
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.35
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.35
	ELSEIF ABL:ARG:2 == 8
		;TIMES SOURCE:ARG:快Ｃ , 2.30
		;TIMES SOURCE:ARG:快Ｖ, 2.30
		;TIMES SOURCE:ARG:快Ａ , 2.30
		;TIMES SOURCE:ARG:快Ｂ , 2.30
		TIMES SOURCE:ARG:性行動 , 2.30
		TIMES SOURCE:(ARG:1):0 , 2.30
		TIMES SOURCE:(ARG:1):1 , 2.30
		TIMES SOURCE:(ARG:1):2 , 2.30
		TIMES SOURCE:(ARG:1):3 , 2.30
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.35
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.35
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.35
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.35
	ELSEIF ABL:ARG:2 == 9
		;TIMES SOURCE:ARG:快Ｃ , 2.45
		;TIMES SOURCE:ARG:快Ｖ, 2.45
		;TIMES SOURCE:ARG:快Ａ , 2.45
		;TIMES SOURCE:ARG:快Ｂ , 2.45
		TIMES SOURCE:ARG:性行動 , 2.45
		TIMES SOURCE:(ARG:1):0 , 2.45
		TIMES SOURCE:(ARG:1):1 , 2.45
		TIMES SOURCE:(ARG:1):2 , 2.45
		TIMES SOURCE:(ARG:1):3 , 2.45
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.40
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.40
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.40
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.40
	ELSEIF ABL:ARG:2 == 10
		;TIMES SOURCE:ARG:快Ｃ , 2.80
		;TIMES SOURCE:ARG:快Ｖ, 2.80
		;TIMES SOURCE:ARG:快Ａ , 2.80
		;TIMES SOURCE:ARG:快Ｂ , 2.80
		TIMES SOURCE:ARG:性行動 , 2.80
		TIMES SOURCE:(ARG:1):0 , 2.80
		TIMES SOURCE:(ARG:1):1 , 2.80
		TIMES SOURCE:(ARG:1):2 , 2.80
		TIMES SOURCE:(ARG:1):3 , 2.80
		TIMES SOURCE:(ARG:1):道具快Ｃ , 1.45
		TIMES SOURCE:(ARG:1):道具快Ｖ , 1.45
		TIMES SOURCE:(ARG:1):道具快Ａ , 1.45
		TIMES SOURCE:(ARG:1):道具快Ｂ , 1.45
	ELSE
		SOURCE:ARG:性行動 = (SOURCE:ARG:性行動 * ABL:ARG:2 * 10 - 30) / 100
		SOURCE:(ARG:1):0 = (SOURCE:(ARG:1):0 * ABL:ARG:2 * 10 - 30) / 100
		SOURCE:(ARG:1):1 = (SOURCE:(ARG:1):1 * ABL:ARG:2 * 10 - 30) / 100
		SOURCE:(ARG:1):2 = (SOURCE:(ARG:1):2 * ABL:ARG:2 * 10 - 30) / 100
		SOURCE:(ARG:1):3 = (SOURCE:(ARG:1):3 * ABL:ARG:2 * 10 - 30) / 100
	ENDIF
	SIF TFLAG:28 & 2
		CALL ADDS_EXP("調教経験", 1, ARG)
;調教者の場合
;ELSEIF TFLAG:28 == 0
;調教者のABL:技巧
;IF ABL:(ARG:1):2 == 0
;	TIMES SOURCE:ARG:快Ｃ , 0.50
;	TIMES SOURCE:ARG:快Ｖ, 0.50
;	TIMES SOURCE:ARG:快Ａ , 0.50
;	TIMES SOURCE:ARG:快Ｂ , 0.50
;	TIMES SOURCE:(ARG:1):0 , 0.50
;	TIMES SOURCE:(ARG:1):1 , 0.50
;	TIMES SOURCE:(ARG:1):2 , 0.50
;	TIMES SOURCE:(ARG:1):3 , 0.50
;ELSEIF ABL:(ARG:1):2 == 1
;	TIMES SOURCE:ARG:快Ｃ , 0.60
;	TIMES SOURCE:ARG:快Ｖ, 0.60
;	TIMES SOURCE:ARG:快Ａ , 0.60
;	TIMES SOURCE:ARG:快Ｂ , 0.60
;	TIMES SOURCE:(ARG:1):0 , 0.60
;	TIMES SOURCE:(ARG:1):1 , 0.60
;	TIMES SOURCE:(ARG:1):2 , 0.60
;	TIMES SOURCE:(ARG:1):3 , 0.60
;ELSEIF ABL:(ARG:1):2 == 2
;	TIMES SOURCE:ARG:快Ｃ , 0.80
;	TIMES SOURCE:ARG:快Ｖ, 0.80
;	TIMES SOURCE:ARG:快Ａ , 0.80
;	TIMES SOURCE:ARG:快Ｂ , 0.80
;	TIMES SOURCE:(ARG:1):0 , 0.80
;	TIMES SOURCE:(ARG:1):1 , 0.80
;	TIMES SOURCE:(ARG:1):2 , 0.80
;	TIMES SOURCE:(ARG:1):3 , 0.80
;ELSEIF ABL:(ARG:1):2 == 3
;	TIMES SOURCE:ARG:快Ｃ , 1.00
;	TIMES SOURCE:ARG:快Ｖ, 1.00
;	TIMES SOURCE:ARG:快Ａ , 1.00
;	TIMES SOURCE:ARG:快Ｂ , 1.00
;	TIMES SOURCE:(ARG:1):0 , 1.00
;	TIMES SOURCE:(ARG:1):1 , 1.00
;	TIMES SOURCE:(ARG:1):2 , 1.00
;	TIMES SOURCE:(ARG:1):3 , 1.00
;ELSEIF ABL:(ARG:1):2 == 4
;	TIMES SOURCE:ARG:快Ｃ , 1.20
;	TIMES SOURCE:ARG:快Ｖ, 1.20
;	TIMES SOURCE:ARG:快Ａ , 1.20
;	TIMES SOURCE:ARG:快Ｂ , 1.20
;	TIMES SOURCE:(ARG:1):0 , 1.20
;	TIMES SOURCE:(ARG:1):1 , 1.20
;	TIMES SOURCE:(ARG:1):2 , 1.20
;	TIMES SOURCE:(ARG:1):3 , 1.20
;ELSEIF ABL:(ARG:1):2 == 5
;	TIMES SOURCE:ARG:快Ｃ , 1.50
;	TIMES SOURCE:ARG:快Ｖ, 1.50
;	TIMES SOURCE:ARG:快Ａ , 1.50
;	TIMES SOURCE:ARG:快Ｂ , 1.50
;	TIMES SOURCE:(ARG:1):0 , 1.50
;	TIMES SOURCE:(ARG:1):1 , 1.50
;	TIMES SOURCE:(ARG:1):2 , 1.50
;	TIMES SOURCE:(ARG:1):3 , 1.50
;ELSEIF ABL:(ARG:1):2 == 6
;	TIMES SOURCE:ARG:快Ｃ , 1.80
;	TIMES SOURCE:ARG:快Ｖ, 1.80
;	TIMES SOURCE:ARG:快Ａ , 1.80
;	TIMES SOURCE:ARG:快Ｂ , 1.80
;	TIMES SOURCE:(ARG:1):0 , 1.80
;	TIMES SOURCE:(ARG:1):1 , 1.80
;	TIMES SOURCE:(ARG:1):2 , 1.80
;	TIMES SOURCE:(ARG:1):3 , 1.80
;ELSEIF ABL:(ARG:1):2 == 7
;	TIMES SOURCE:ARG:快Ｃ , 2.10
;	TIMES SOURCE:ARG:快Ｖ, 2.10
;	TIMES SOURCE:ARG:快Ａ , 2.10
;	TIMES SOURCE:ARG:快Ｂ , 2.10
;	TIMES SOURCE:ARG:性行動 , 2.10
;	TIMES SOURCE:(ARG:1):0 , 2.10
;	TIMES SOURCE:(ARG:1):1 , 2.10
;	TIMES SOURCE:(ARG:1):2 , 2.10
;	TIMES SOURCE:(ARG:1):3 , 2.10
;ELSEIF ABL:(ARG:1):2 == 8
;	TIMES SOURCE:ARG:快Ｃ , 2.30
;	TIMES SOURCE:ARG:快Ｖ, 2.30
;	TIMES SOURCE:ARG:快Ａ , 2.30
;	TIMES SOURCE:ARG:快Ｂ , 2.30
;	TIMES SOURCE:ARG:性行動 , 2.30
;	TIMES SOURCE:(ARG:1):0 , 2.30
;	TIMES SOURCE:(ARG:1):1 , 2.30
;	TIMES SOURCE:(ARG:1):2 , 2.30
;	TIMES SOURCE:(ARG:1):3 , 2.30
;ELSEIF ABL:(ARG:1):2 == 9
;	TIMES SOURCE:ARG:快Ｃ , 2.45
;	TIMES SOURCE:ARG:快Ｖ, 2.45
;	TIMES SOURCE:ARG:快Ａ , 2.45
;	TIMES SOURCE:ARG:快Ｂ , 2.45
;	TIMES SOURCE:ARG:性行動 , 2.45
;	TIMES SOURCE:(ARG:1):0 , 2.45
;	TIMES SOURCE:(ARG:1):1 , 2.45
;	TIMES SOURCE:(ARG:1):2 , 2.45
;	TIMES SOURCE:(ARG:1):3 , 2.45
;ELSEIF ABL:(ARG:1):2 == 10
;	TIMES SOURCE:ARG:快Ｃ , 2.80
;	TIMES SOURCE:ARG:快Ｖ, 2.80
;	TIMES SOURCE:ARG:快Ａ , 2.80
;	TIMES SOURCE:ARG:快Ｂ , 2.80
;	TIMES SOURCE:ARG:性行動 , 2.80
;	TIMES SOURCE:(ARG:1):0 , 2.80
;	TIMES SOURCE:(ARG:1):1 , 2.80
;	TIMES SOURCE:(ARG:1):2 , 2.80
;	TIMES SOURCE:(ARG:1):3 , 2.80
;ENDIF
;EXP:(ARG:1):70 += 1
;ENDIF


;-------------------------------------------------
;強精神薬による絶頂キャンセル
;-------------------------------------------------
@ECST_CANCEL, ARG

;SOURCE.ERBの絶頂処理を流用

C = 0
V = 0
A = 0
B = 0

;絶頂Ｃ
IF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 5
	C = 5
	CDOWN:ARG:0 = (PALAMLV:4 * 5 - 1000)
	PRINTL 究極絶頂Ｃキャンセル
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 4
	C = 4
	CDOWN:ARG:0 = (PALAMLV:4 * 4 - 1000)
	PRINTL 最強絶頂Ｃキャンセル
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 3
	C = 3
	CDOWN:ARG:0 = (PALAMLV:4 * 3 - 1000)
	PRINTL 超強絶頂Ｃキャンセル
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 2
	C = 2
	CDOWN:ARG:0 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｃキャンセル
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4
	C = 1
	PALAM:ARG:0 = 5000
	CUP:ARG:0 = 0
	PRINTL 絶頂Ｃキャンセル
ENDIF
;CDOWN:ARG:1で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:0 + PALAM:ARG:0 - CDOWN:ARG:0 >= PALAMLV:4
	CDOWN:ARG:0 = CUP:ARG:0 + PALAM:ARG:0 - PALAMLV:4 + 1

;絶頂Ｖ
IF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 5
	V = 5
	CDOWN:ARG:1 = (PALAMLV:4 * 5 - 1000)
	PRINTL 究極絶頂Ｖキャンセル
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 4
	V = 4
	CDOWN:ARG:1 = (PALAMLV:4 * 4 - 1000)
	PRINTL 最強絶頂Ｖキャンセル
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 3
	V = 3
	CDOWN:ARG:1 = (PALAMLV:4 * 3 - 1000)
	PRINTL 超強絶頂Ｖキャンセル
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 2
	V = 2
	CDOWN:ARG:1 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｖキャンセル
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4
	V = 1
	CDOWN:ARG:1 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｖキャンセル
ENDIF
;CDOWN:ARG:1で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:1 + PALAM:ARG:1 - CDOWN:ARG:1 >= PALAMLV:4
	CDOWN:ARG:1 = CUP:ARG:1 + PALAM:ARG:1 - PALAMLV:4 + 1

;絶頂Ａ
IF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 5
	A = 5
	CDOWN:ARG:2 = (PALAMLV:4 * 5 - 1000)
	PRINTL 究極絶頂Ａキャンセル
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 4
	A = 4
	CDOWN:ARG:2 = (PALAMLV:4 * 4 - 1000)
	PRINTL 最強絶頂Ａキャンセル
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 3
	A = 3
	CDOWN:ARG:2 = (PALAMLV:4 * 3 - 1000)
	PRINTL 超強絶頂Ａキャンセル
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 2
	A = 2
	CDOWN:ARG:2 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ａキャンセル
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4
	A = 1
	CDOWN:ARG:2 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ａキャンセル
ENDIF
;CDOWN:ARG:2で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:2 + PALAM:ARG:2 - CDOWN:ARG:2 >= PALAMLV:4
	CDOWN:ARG:2 = CUP:ARG:2 + PALAM:ARG:2 - PALAMLV:4 + 1

;絶頂Ｂ
IF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 5
	B = 5
	CDOWN:ARG:3 = (PALAMLV:4 * 5 - 1000)
	PRINTL 究極絶頂Ｂキャンセル
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 4
	B = 4
	CDOWN:ARG:3 = (PALAMLV:4 * 4 - 1000)
	PRINTL 最強絶頂Ｂキャンセル
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 3
	B = 3
	CDOWN:ARG:3 = (PALAMLV:4 * 3 - 1000)
	PRINTL 超強絶頂Ｂキャンセル
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 2
	B = 2
	CDOWN:ARG:3 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｂキャンセル
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4
	B = 1
	CDOWN:ARG:3 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｂキャンセル
ENDIF
;CDOWN:ARG:3で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:3 + PALAM:ARG:3 - CDOWN:ARG:3 >= PALAMLV:4
	CDOWN:ARG:3 = CUP:ARG:3 + PALAM:ARG:3 - PALAMLV:4 + 1
	
;止められた絶頂回数をTFLAG:44〜TFLAG:47に記録
TFLAG:44 += C
TFLAG:45 += V
TFLAG:46 += A
TFLAG:47 += B

RETURN 1

;-------------------------------------------------
;絶頂処理
;-------------------------------------------------
@ORGASM_ADD, ARG
C = 0
V = 0
A = 0
B = 0

;強精神薬の副作用を適用する
IF TEQUIP:ARG:34 == 1
	CALL REACT_DRUG, ARG
ENDIF

;絶頂Ｃ
IF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 5
	C = 5
	CDOWN:ARG:0 = (PALAMLV:4 * 5 - 1000)
	NOWEX:ARG:0 = 5
	;PRINTFORML 究極絶頂Ｃ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 4
	C = 4
	CDOWN:ARG:0 = (PALAMLV:4 * 4 - 1000)
	NOWEX:ARG:0 = 4
	;PRINTFORML 最強絶頂Ｃ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 3
	C = 3
	CDOWN:ARG:0 = (PALAMLV:4 * 3 - 1000)
	NOWEX:ARG:0 = 3
	;PRINTFORML 超強絶頂Ｃ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4 * 2
	C = 2
	CDOWN:ARG:0 = (PALAMLV:4 * 2 - 1000)
	NOWEX:ARG:0 = 2
	;PRINTFORML 強絶頂Ｃ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:0 + PALAM:ARG:0 >= PALAMLV:4
	C = 1
	CDOWN:ARG:0 = (PALAMLV:4 - 1000)
	NOWEX:ARG:0 = 1
	;PRINTFORML 絶頂Ｃ\@ARG == PLAYER?(調教者)#\@
ENDIF
;CDOWN:ARG:0で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:0 + PALAM:ARG:0 - CDOWN:ARG:0 >= PALAMLV:4
	CDOWN:ARG:0 = CUP:ARG:0 + PALAM:ARG:0 - PALAMLV:4 + 1

;絶頂Ｖ
IF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 5
	V = 5
	CDOWN:ARG:1 = (PALAMLV:4 * 5 - 1000)
	NOWEX:ARG:1 = 5
	;PRINTFORML 究極絶頂Ｖ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 4
	V = 4
	CDOWN:ARG:1 = (PALAMLV:4 * 4 - 1000)
	NOWEX:ARG:1 = 4
	;PRINTFORML 最強絶頂Ｖ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 3
	V = 3
	CDOWN:ARG:1 = (PALAMLV:4 * 3 - 1000)
	NOWEX:ARG:1 = 3
	;PRINTFORML 超強絶頂Ｖ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4 * 2
	V = 2
	CDOWN:ARG:1 = (PALAMLV:4 * 2 - 1000)
	NOWEX:ARG:1 = 2
	;PRINTFORML 強絶頂Ｖ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:1 + PALAM:ARG:1 >= PALAMLV:4
	V = 1
	CDOWN:ARG:1 = (PALAMLV:4 - 1000)
	NOWEX:ARG:1 = 1
	;PRINTFORML 絶頂Ｖ\@ARG == PLAYER?(調教者)#\@
ENDIF
;CDOWN:ARG:1で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:1 + PALAM:ARG:1 - CDOWN:ARG:1 >= PALAMLV:4
	CDOWN:ARG:1 = CUP:ARG:1 + PALAM:ARG:1 - PALAMLV:4 + 1

;絶頂Ａ
IF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 5
	A = 5
	CDOWN:ARG:2 = (PALAMLV:4 * 5 - 1000)
	NOWEX:ARG:2 = 5
	;PRINTFORML 究極絶頂Ａ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 4
	A = 4
	CDOWN:ARG:2 = (PALAMLV:4 * 4 - 1000)
	NOWEX:ARG:2 = 4
	;PRINTFORML 最強絶頂Ａ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 3
	A = 3
	CDOWN:ARG:2 = (PALAMLV:4 * 3 - 1000)
	NOWEX:ARG:2 = 3
	;PRINTFORML 超強絶頂Ａ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4 * 2
	A = 2
	CDOWN:ARG:2 = (PALAMLV:4 * 2 - 1000)
	NOWEX:ARG:2 = 2
	;PRINTFORML 強絶頂Ａ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:2 + PALAM:ARG:2 >= PALAMLV:4
	A = 1
	CDOWN:ARG:2 = (PALAMLV:4 - 1000)
	NOWEX:ARG:2 = 1
	;PRINTFORML 絶頂Ａ\@ARG == PLAYER?(調教者)#\@
ENDIF
;CDOWN:ARG:2で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:2 + PALAM:ARG:2 - CDOWN:ARG:2 >= PALAMLV:4
	CDOWN:ARG:2 = CUP:ARG:2 + PALAM:ARG:2 - PALAMLV:4 + 1

;絶頂Ｂ
IF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 5
	B = 5
	CDOWN:ARG:3 = (PALAMLV:4 * 5 - 1000)
	NOWEX:ARG:3 = 5
	;PRINTFORML 究極絶頂Ｂ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 4
	B = 4
	CDOWN:ARG:3 = (PALAMLV:4 * 4 - 1000)
	NOWEX:ARG:3 = 4
	;PRINTFORML 最強絶頂Ｂ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 3
	B = 3
	CDOWN:ARG:3 = (PALAMLV:4 * 3 - 1000)
	NOWEX:ARG:3 = 3
	;PRINTFORML 超強絶頂Ｂ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4 * 2
	B = 2
	CDOWN:ARG:3 = (PALAMLV:4 * 2 - 1000)
	NOWEX:ARG:3 = 2
	;PRINTFORML 強絶頂Ｂ\@ARG == PLAYER?(調教者)#\@
ELSEIF CUP:ARG:3 + PALAM:ARG:3 >= PALAMLV:4
	B = 1
	CDOWN:ARG:3 = (PALAMLV:4 - 1000)
	NOWEX:ARG:3 = 1
	;PRINTFORML 絶頂Ｂ\@ARG == PLAYER?(調教者)#\@
ENDIF
;CDOWN:ARG:3で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF CUP:ARG:3 + PALAM:ARG:3 - CDOWN:ARG:3 >= PALAMLV:4
	CDOWN:ARG:3 = CUP:ARG:3 + PALAM:ARG:3 - PALAMLV:4 + 1

;-------------------------------------------------
;絶頂時の追加処理
;-------------------------------------------------
SIF ARG == TARGET
	TFLAG:絶頂の強度 = C + V + A + B
SIF	ARG == PLAYER
	TFLAG:調教者絶頂強度 = C + V + A + B
IF ARG == TARGET
	;快楽刻印の処理
	;絶頂の部位と強度の合計が一定以上で刻印を取得する
	R = C+V*2+A*2+B
	;Rが4以上で快楽刻印３に相当
	IF R >= 4 && MARK:1 < 3
		TFLAG:200 = 3
	;Rが3以上で快楽刻印２に相当
	ELSEIF R >= 3 && MARK:1 < 2
		TFLAG:200 = 2
	;Rが2以上で快楽刻印１に相当
	ELSEIF R >= 2 && MARK:1 < 1
		TFLAG:200 = 1
	ENDIF
ENDIF

LOCAL = 0

IF C >= 5 && V >= 5 && A >= 5 && B >= 5
	LOCAL = 40
	C *= 40
	V *= 40
	A *= 40
	B *= 40
ELSEIF C >= 4 && V >= 4 && A >= 4 && B >= 4
	LOCAL = 32
	C *= 32
	V *= 32
	A *= 32
	B *= 32
ELSEIF C >= 3 && V >= 3 && A >= 3 && B >= 3
	LOCAL = 24
	C *= 24
	V *= 24
	A *= 24
	B *= 24
ELSEIF C >= 2 && V >= 2 && A >= 2 && B >= 2
	LOCAL = 16
	C *= 16
	V *= 16
	A *= 16
	B *= 16
ELSEIF C && V && A && B
	LOCAL = 8
	C *= 8
	V *= 8
	A *= 8
	B *= 8
ELSEIF C && V && A
	LOCAL = 4
	C *= 4
	V *= 4
	A *= 4
ELSEIF B && V && A
	LOCAL = 4
	B *= 4
	V *= 4
	A *= 4
ELSEIF C && B && A
	LOCAL = 4
	C *= 4
	B *= 4
	A *= 4
ELSEIF C && V && B
	LOCAL = 4
	C *= 4
	V *= 4
	B *= 4
ELSEIF C && V
	LOCAL = 2
	C *= 2
	V *= 2
ELSEIF C && A
	LOCAL = 2
	C *= 2
	A *= 2
ELSEIF V && A
	LOCAL = 2
	V *= 2
	A *= 2
ELSEIF C && B
	LOCAL = 2
	C *= 2
	B *= 2
ELSEIF V && B
	LOCAL = 2
	V *= 2
	B *= 2
ELSEIF A && B
	LOCAL = 2
	A *= 2
	B *= 2
ENDIF

IF LOCAL > 0 && CFLAG:ＭＡＧ非被吸収 == 0 && ARG == TARGET
	LOCAL *= MAXBASE:PLAYER:LV * 20 * (5+MAX(ABL:PLAYER:従順,ABL:PLAYER:欲望,ABL:PLAYER:技巧))/5
	CALL DRAIN_MAG,TARGET,LOCAL,PLAYER
ENDIF

IF C
	SOURCE:ARG:露出 += 500 * C
	SOURCE:ARG:屈従 += 200 * C
	SOURCE:ARG:反感 += 150 * C
	SIF TALENT:ARG:オトコ && TALENT:ARG:男の娘 == 0
		SOURCE:ARG:反感 -= 150 * C
	DOWNBASE:ARG:0 += 20
	DOWNBASE:ARG:1 += 10
ENDIF
IF V
	SOURCE:ARG:欲情 += 800 * V
	SOURCE:ARG:恭順 += 500 * V
	SOURCE:ARG:露出 += 700 * V
	SOURCE:ARG:屈従 += 400 * V
	SOURCE:ARG:反感 += 300 * V
	DOWNBASE:ARG:0 += 40
	DOWNBASE:ARG:1 += 20
ENDIF
IF A
	SOURCE:ARG:欲情 += 500 * A
	SOURCE:ARG:恭順 += 700 * A
	SOURCE:ARG:露出 += 900 * A
	SOURCE:ARG:屈従 += 500 * A
	SOURCE:ARG:反感 += 400 * A
	SIF TALENT:ARG:オトコ && TALENT:ARG:男の娘 == 0
		SOURCE:ARG:反感 += 400 * A
	SIF TALENT:ARG:オトコ && TALENT:ARG:男の娘 == 0
		SOURCE:ARG:逸脱 += 200 * A
	
	DOWNBASE:ARG:0 += 60
	DOWNBASE:ARG:1 += 30
ENDIF
IF B
	SOURCE:ARG:露出 += 500 * B
	SOURCE:ARG:屈従 += 200 * B
	SOURCE:ARG:反感 += 150 * B
	SIF TALENT:ARG:オトコ && TALENT:ARG:男の娘 == 0
		SOURCE:ARG:反感 += 150 * B
	SIF TALENT:ARG:オトコ && TALENT:ARG:男の娘 == 0
		SOURCE:ARG:逸脱 += 100 * B
	DOWNBASE:ARG:0 += 20
	DOWNBASE:ARG:1 += 10
ENDIF

;絶頂による欲望ＬＶアップ
L = 0
SIF C >= 2 || B >= 2 || V || A
	L = 1
SIF V >= 2 || A >= 2
	L = 2
SIF (C >= 2 && B >= 2) || (C >= 2 && V) || (C >= 2 && A) || (B >= 2 && V) || (B >= 2 && A) && (V && A)
	L = 2
SIF (C && B && V) || (C && B && A) || (C && V && A) || (V && A && B)
	L = 3
SIF C && V && A && B
	L = 4
IF ARG == TARGET
	;自制心があると１下がる
	SIF TALENT:ARG:20
		L -= 1

	IF ABL:ARG:1 < L
		ABL:ARG:1 = L
		PRINT そして
		PRINTS ABLNAME_E(1)
		PRINT がLV
		PRINTV L
		PRINTL になった
		;欲望の上昇による[抑圧]の消滅をチェック
		CALL YOKUBO_UP_CHECK
	ENDIF
ENDIF

;絶頂回数を増やす
EX:ARG:0 += C
EX:ARG:1 += V
EX:ARG:2 += A
EX:ARG:3 += B

;ClimaxEXPを増やす
;EXP:ARG:2 += C+V+A+B
CALL ADDS_EXP("絶頂経験", C+V+A+B, ARG)
RETURN 1


;-------------------------------------------------
;強精神薬の副作用
;-------------------------------------------------
@REACT_DRUG, ARG
;仕様説明：
;@ECST_CANCELでEX:11〜EX:14に記録してきた絶頂回数を解放します。
;パッチ詰め合わせではTFLAG:44〜TFLAG:47を代わりに使用。内訳は
;TFLAG:44 = EX:11(Ｃ絶頂処理)の代わり、TFLAG:45 = EX:12(Ｖ絶頂処理)の代わり、
;TFLAG:46 = EX:13(Ａ絶頂処理)の代わり、TFLAG:47 = EX:14(Ｂ絶頂処理)の代わり
;記録してきた絶頂回数１回につき、該当する部位の快ソース（UP:0,1,2,3）を２倍にします。
;１回のコマンドでひとつの部位につき１回ずつこの倍化処理を行い、
;EX:11〜EX:14の合計が０になったとき、反動が解除されます。
;-------------------------------------------------
;ＣPleasureの処理
IF TFLAG:44 > 0 && CUP:ARG:0 > 0
	CUP:ARG:0 *= 2
	TFLAG:44 -= 1
ENDIF
;快Ｖの処理
IF TFLAG:45 > 0 && CUP:ARG:1 > 0
	CUP:ARG:1 *= 2
	TFLAG:45 -= 1
ENDIF
;快Ａの処理
IF TFLAG:46 > 0 && CUP:ARG:2 > 0
	CUP:ARG:2 *= 2
	TFLAG:46 -= 1
ENDIF
;快Ｂの処理
IF TFLAG:47 > 0 && CUP:ARG:3 > 0
	CUP:ARG:3 *= 2
	TFLAG:47 -= 1
ENDIF
;反動の終了チェック
SIF TFLAG:44 + TFLAG:45 + TFLAG:46 + TFLAG:47 == 0
	TEQUIP:34 = 0

RETURN 1


;-------------------------------------------------
;調教対象の射精チェック
;-------------------------------------------------
@TARGET_EJAC_CHECK
SIF TALENT:139 == 0 && !IS_MALE(TARGET)
	RETURN 0

A = CUP:TARGET:0 + CUP:TARGET:1 + CUP:TARGET:2 + CUP:TARGET:3

;自制心
SIF TALENT:20
	A /= 2

;快感に素直
SIF TALENT:70
	TIMES A , 1.20

;快感の否定（淫乱、娼婦で無効）
SIF TALENT:71 && (TALENT:4 == 0 && TALENT:7 == 0)
	TIMES A , 0.80

;媚薬
SIF TEQUIP:26
	A *= 2

;利尿剤
SIF TEQUIP:27
	A /= 2

;射精の再装填期間中は射精ゲージの増加は20分の1に
SIF CFLAG:TARGET:9 > 0
	A /= 20

;射精の限界が来ている場合は、射精ゲージの増加はしない
IF CFLAG:TARGET:11 == 0
	A = 0
	BASE:2 = 0
ENDIF

BASE:2 += A

S = BASE:2
EJAC = MAXBASE:2
IF TEQUIP:42 == 0
	IF  S > EJAC * 5
		E = 5
	ELSEIF  S > EJAC * 4
		E = 4
	ELSEIF  S > EJAC * 3
		E = 3
	ELSEIF  S > EJAC * 2
		E = 2
	ELSEIF S > EJAC
		E = 1
	ELSE
		E = 0
	ENDIF
	
	;究極射精
	IF E == 5
		DOWNBASE:TARGET:0 += 20
		DOWNBASE:TARGET:1 += 100
	
		IF EXP:TARGET:3 < EXPLV:1
			SOURCE:TARGET:露出 += 10000
			SOURCE:TARGET:屈従 += 5000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 200
			ELSE
				SOURCE:TARGET:不潔 += 2000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:2
			SOURCE:TARGET:露出 += 5000
			SOURCE:TARGET:屈従 += 3000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 150
			ELSE
				SOURCE:TARGET:不潔 += 1500
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:3
			SOURCE:TARGET:露出 += 3000
			SOURCE:TARGET:屈従 += 1500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 100
			ELSE
				SOURCE:TARGET:不潔 += 1000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:4
			SOURCE:TARGET:露出 += 1500
			SOURCE:TARGET:屈従 += 800
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 70
			ELSE
				SOURCE:TARGET:不潔 += 700
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:5
			SOURCE:TARGET:露出 += 1000
			SOURCE:TARGET:屈従 += 500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 40
			ELSE
				SOURCE:TARGET:不潔 += 400
			ENDIF
		ELSE
			SOURCE:TARGET:露出 += 500
			SOURCE:TARGET:屈従 += 300
		ENDIF
	
;		PRINTS NAME:TARGET
;		PRINTL 大量射精
;		PRINTL SemenEXP＋１
;		PRINTL CumEXP＋５
;		IF EXP:TARGET:3 == 0 && !IS_MALE(TARGET)
;			EXP:TARGET:50 += 1
;			PRINTL AbnormalEXP＋1
;			CALL ADDS_ABNORMAL_EXP("Ejaculation", TARGET)
;		ENDIF
		CALL ADDS_EXP("精液経験", 1, TARGET)
		CALL ADDS_EXP("射精経験", 5, TARGET)
;		EXP:TARGET:20 += 1
;		EXP:TARGET:3 += 5
	
		CALL IN_VAGINA_CHECK_T
	
		;Ｐに精液汚れ
		CALL SET_STAIN("ペニス", "精液", TARGET)
	
		BASE:2 -= EJAC*5
		SIF BASE:2 >= EJAC
			BASE:2 = EJAC-1

		;調教対象が射精フラグ
		TFLAG:10 = 5
		NOWEX:5 += 1
		EX:5 += 1
	;最強射精
	ELSEIF E == 4
		DOWNBASE:TARGET:0 += 20
		DOWNBASE:TARGET:1 += 100
	
		IF EXP:TARGET:3 < EXPLV:1
			SOURCE:TARGET:露出 += 10000
			SOURCE:TARGET:屈従 += 5000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 200
			ELSE
				SOURCE:TARGET:不潔 += 2000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:2
			SOURCE:TARGET:露出 += 5000
			SOURCE:TARGET:屈従 += 3000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 150
			ELSE
				SOURCE:TARGET:不潔 += 1500
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:3
			SOURCE:TARGET:露出 += 3000
			SOURCE:TARGET:屈従 += 1500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 100
			ELSE
				SOURCE:TARGET:不潔 += 1000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:4
			SOURCE:TARGET:露出 += 1500
			SOURCE:TARGET:屈従 += 800
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 70
			ELSE
				SOURCE:TARGET:不潔 += 700
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:5
			SOURCE:TARGET:露出 += 1000
			SOURCE:TARGET:屈従 += 500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 40
			ELSE
				SOURCE:TARGET:不潔 += 400
			ENDIF
		ELSE
			SOURCE:TARGET:露出 += 500
			SOURCE:TARGET:屈従 += 300
		ENDIF
	
;		PRINTS NAME:TARGET
;		PRINTL 大量射精
;		PRINTL SemenEXP＋１
;		PRINTL CumEXP＋４
;		IF EXP:TARGET:3 == 0 && !IS_MALE(TARGET)
;			EXP:TARGET:50 += 1
;			PRINTL AbnormalEXP＋1
;			CALL ADDS_ABNORMAL_EXP("Ejaculation", TARGET)
;		ENDIF
		CALL ADDS_EXP("精液経験", 1, TARGET)
		CALL ADDS_EXP("射精経験", 4, TARGET)
;		EXP:TARGET:20 += 1
;		EXP:TARGET:3 += 4
	
		CALL IN_VAGINA_CHECK_T
	
		;Ｐに精液汚れ
		CALL SET_STAIN("ペニス", "精液", TARGET)
	
		BASE:2 -= EJAC*4
		SIF BASE:2 >= EJAC
			BASE:2 = EJAC-1

		;調教対象が射精フラグ
		TFLAG:10 = 4
		NOWEX:5 += 1
		EX:5 += 1
	;超大量射精
	ELSEIF E == 3
		DOWNBASE:TARGET:0 += 20
		DOWNBASE:TARGET:1 += 100
	
		IF EXP:TARGET:3 < EXPLV:1
			SOURCE:TARGET:露出 += 10000
			SOURCE:TARGET:屈従 += 5000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 200
			ELSE
				SOURCE:TARGET:不潔 += 2000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:2
			SOURCE:TARGET:露出 += 5000
			SOURCE:TARGET:屈従 += 3000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 150
			ELSE
				SOURCE:TARGET:不潔 += 1500
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:3
			SOURCE:TARGET:露出 += 3000
			SOURCE:TARGET:屈従 += 1500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 100
			ELSE
				SOURCE:TARGET:不潔 += 1000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:4
			SOURCE:TARGET:露出 += 1500
			SOURCE:TARGET:屈従 += 800
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 70
			ELSE
				SOURCE:TARGET:不潔 += 700
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:5
			SOURCE:TARGET:露出 += 1000
			SOURCE:TARGET:屈従 += 500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 40
			ELSE
				SOURCE:TARGET:不潔 += 400
			ENDIF
		ELSE
			SOURCE:TARGET:露出 += 500
			SOURCE:TARGET:屈従 += 300
		ENDIF
	
;		PRINTS NAME:TARGET
;		PRINTL 大量射精
;		PRINTL SemenEXP＋１
;		PRINTL CumEXP＋３
;		IF EXP:TARGET:3 == 0 && !IS_MALE(TARGET)
;			EXP:TARGET:50 += 1
;			PRINTL AbnormalEXP＋1
;			CALL ADDS_ABNORMAL_EXP("Ejaculation", TARGET)
;		ENDIF
		CALL ADDS_EXP("精液経験", 1, TARGET)
		CALL ADDS_EXP("射精経験", 3, TARGET)
;		EXP:TARGET:20 += 1
;		EXP:TARGET:3 += 3
	
		CALL IN_VAGINA_CHECK_T
	
		;Ｐに精液汚れ
		CALL SET_STAIN("ペニス", "精液", TARGET)
	
		BASE:2 -= EJAC*3
		SIF BASE:2 >= EJAC
			BASE:2 = EJAC-1

		;調教対象が射精フラグ
		TFLAG:10 = 3
		NOWEX:5 += 1
		EX:5 += 1
	;大量射精
	ELSEIF E == 2
		DOWNBASE:TARGET:0 += 20
		DOWNBASE:TARGET:1 += 100
	
		IF EXP:TARGET:3 < EXPLV:1
			SOURCE:TARGET:露出 += 10000
			SOURCE:TARGET:屈従 += 5000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 200
			ELSE
				SOURCE:TARGET:不潔 += 2000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:2
			SOURCE:TARGET:露出 += 5000
			SOURCE:TARGET:屈従 += 3000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 150
			ELSE
				SOURCE:TARGET:不潔 += 1500
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:3
			SOURCE:TARGET:露出 += 3000
			SOURCE:TARGET:屈従 += 1500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 100
			ELSE
				SOURCE:TARGET:不潔 += 1000
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:4
			SOURCE:TARGET:露出 += 1500
			SOURCE:TARGET:屈従 += 800
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 70
			ELSE
				SOURCE:TARGET:不潔 += 700
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:5
			SOURCE:TARGET:露出 += 1000
			SOURCE:TARGET:屈従 += 500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 40
			ELSE
				SOURCE:TARGET:不潔 += 400
			ENDIF
		ELSE
			SOURCE:TARGET:露出 += 500
			SOURCE:TARGET:屈従 += 300
		ENDIF
	
;		PRINTS NAME:TARGET
;		PRINTL 大量射精
;		PRINTL SemenEXP＋１
;		PRINTL CumEXP＋２
;		IF EXP:TARGET:3 == 0 && !IS_MALE(TARGET)
;			EXP:TARGET:50 += 1
;			PRINTL AbnormalEXP＋1
;			CALL ADDS_ABNORMAL_EXP("Ejaculation", TARGET)
;		ENDIF
		CALL ADDS_EXP("精液経験", 1, TARGET)
		CALL ADDS_EXP("射精経験", 2, TARGET)
;		EXP:TARGET:20 += 1
;		EXP:TARGET:3 += 2
	
		CALL IN_VAGINA_CHECK_T
	
		;Ｐに精液汚れ
		CALL SET_STAIN("ペニス", "精液", TARGET)
	
		BASE:2 -= EJAC*2
		SIF BASE:2 >= EJAC
			BASE:2 = EJAC-1

		;調教対象が射精フラグ
		TFLAG:10 = 2
		NOWEX:5 += 1
		EX:5 += 1
	;通常の射精
	ELSEIF E == 1
		DOWNBASE:TARGET:1 += 40
	
		IF EXP:TARGET:3 < EXPLV:1
			SOURCE:TARGET:露出 += 5000
			SOURCE:TARGET:屈従 += 2500
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 90
			ELSE
				SOURCE:TARGET:不潔 += 900
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:2
			SOURCE:TARGET:露出 += 2500
			SOURCE:TARGET:屈従 += 2000
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 70
			ELSE
				SOURCE:TARGET:不潔 += 700
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:3
			SOURCE:TARGET:露出 += 1000
			SOURCE:TARGET:屈従 += 800
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 50
			ELSE
				SOURCE:TARGET:不潔 += 500
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:4
			SOURCE:TARGET:露出 += 800
			SOURCE:TARGET:屈従 += 600
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 35
			ELSE
				SOURCE:TARGET:不潔 += 350
			ENDIF
		ELSEIF EXP:TARGET:3 < EXPLV:5
			SOURCE:TARGET:露出 += 400
			SOURCE:TARGET:屈従 += 400
			IF TALENT:オトコ
				SOURCE:TARGET:不潔 += 20
			ELSE
				SOURCE:TARGET:不潔 += 200
			ENDIF
		ELSE
			SOURCE:TARGET:露出 += 200
			SOURCE:TARGET:屈従 += 250
		ENDIF
	
	;	PRINTS NAME:TARGET
	;	PRINTL Ejaculation
	;	PRINTL CumEXP＋１
;		IF EXP:TARGET:3 == 0 && !IS_MALE(TARGET)
			;EXP:TARGET:50 += 1
			;PRINTL AbnormalEXP＋1
;			CALL ADDS_ABNORMAL_EXP("Ejaculation", TARGET)
;		ENDIF
		CALL ADDS_EXP("射精経験", 1, TARGET)
		;EXP:TARGET:3 += 1
	
		CALL IN_VAGINA_CHECK_T
	
		;Ｐに精液汚れ
		CALL SET_STAIN("ペニス", "精液", TARGET)
	
		BASE:2 -= EJAC
		SIF BASE:2 >= EJAC
			BASE:2 = EJAC-1
	
		;調教対象が射精フラグ
		TFLAG:10 = 1
		NOWEX:5 += 1
		EX:5 += 1
	ENDIF
	
	IF CFLAG:ＭＡＧ非被吸収 == 0 && E > 0
		LOCAL = 2 * BASE:PLAYER:LV * E * 20 * (5+MAX(ABL:PLAYER:従順,ABL:PLAYER:欲望,ABL:PLAYER:技巧))/5
		CALL DRAIN_MAG,TARGET,LOCAL,PLAYER
	ENDIF
	;射精には再装填の期間を設ける
	;通常射精時
	SIF E == 1
		CFLAG:TARGET:9 = 3
	;大量射精時
	SIF E == 2
		CFLAG:TARGET:9 = 5
	;大量射精時
	SIF E == 3
		CFLAG:TARGET:9 = 6
	;大量射精時
	SIF E == 4
		CFLAG:TARGET:9 = 7
	;大量射精時
	SIF E == 5
		CFLAG:TARGET:9 = 2
	
	;射精残弾減少
	SIF E > 0
		CFLAG:TARGET:11 -= 1
ENDIF
;-------------------------------------------------
;噴乳チェック(ARG:行為者、ARG:1被行為者)
;-------------------------------------------------
@MILK_CHECK, ARG, ARG:1
#DIM 変数A
#DIM 変数B
SIF TALENT:ARG:149 == 0
	RETURN 0

変数A = CUP:ARG:0 / 5 + CUP:ARG:1 / 5 + CUP:ARG:2 / 5 + CUP:ARG:3 * 3

;自制心
SIF TALENT:ARG:20
	変数A /= 2

;快感に素直
SIF TALENT:ARG:70
	TIMES 変数A , 1.20

;快感の否定（淫乱、娼婦で無効）
SIF TALENT:ARG:71 && IS_BITCHY(ARG) == 0
	TIMES 変数A , 0.80

;B鈍感;鈍感と敏感の番号ミス修正＆なぜか敏感を計算していなかったので追加
SIF TALENT:ARG:107
	TIMES 変数A , 0.80

;B敏感
SIF TALENT:ARG:108
	TIMES 変数A , 1.20

;媚薬
SIF TEQUIP:ARG:26
	変数A *= 2

;利尿剤
SIF TEQUIP:ARG:27
	変数A /= 2

;調教者が幼児退行
SIF TALENT:(ARG:1):150
	TIMES 変数A , 1.20

;調教者が幼稚
SIF TALENT:(ARG:1):151
	TIMES 変数A , 1.20

;貧乳
SIF TALENT:ARG:109
	TIMES 変数A , 0.75

;絶壁;なぜか絶壁を計算していなかったので追加
SIF TALENT:ARG:110
	TIMES 変数A , 0.50

;噴乳中毒のレベルを見る
IF ABL:ARG:19 == 0
	TIMES 変数A , 1.00
ELSEIF ABL:ARG:19 == 1
	TIMES 変数A , 1.05
ELSEIF ABL:ARG:19 == 2
	TIMES 変数A , 1.10
ELSEIF ABL:ARG:19 == 3
	TIMES 変数A , 1.20
ELSEIF ABL:ARG:19 == 4
	TIMES 変数A , 1.30
ELSEIF ABL:ARG:19 == 5
	TIMES 変数A , 1.50
ELSE
	変数A = 変数A * ABL:ARG:19 * 30 / 100
ENDIF

;ここで毎ターン500加算されていたのを修正
変数A = 変数A / 2
BASE:ARG:母乳 += 変数A

IF  BASE:ARG:3 > MAXBASE:ARG:3 * 5
	変数B = 5
ELSEIF  BASE:ARG:3 > MAXBASE:ARG:3 * 4
	変数B = 4
ELSEIF  BASE:ARG:3 > MAXBASE:ARG:3 * 3
	変数B = 3
ELSEIF  BASE:ARG:3 > MAXBASE:ARG:3 * 2
	変数B = 2
ELSEIF BASE:ARG:3 > MAXBASE:ARG:3
	変数B = 1
ELSE
	変数B = 0
ENDIF

;究極噴乳
IF 変数B == 5
	DOWNBASE:ARG:0 += 20
	DOWNBASE:ARG:1 += 100

	IF EXP:ARG:54 < EXPLV:1
		SOURCE:ARG:露出 += 10000
		SOURCE:ARG:屈従 += 5000
		SOURCE:ARG:不潔 += 2000
	ELSEIF EXP:ARG:54 < EXPLV:2
		SOURCE:ARG:露出 += 5000
		SOURCE:ARG:屈従 += 3000
		SOURCE:ARG:不潔 += 1500
	ELSEIF EXP:ARG:54 < EXPLV:3
		SOURCE:ARG:露出 += 3000
		SOURCE:ARG:屈従 += 1500
		SOURCE:ARG:不潔 += 1000
	ELSEIF EXP:ARG:54 < EXPLV:4
		SOURCE:ARG:露出 += 1500
		SOURCE:ARG:屈従 += 800
		SOURCE:ARG:不潔 += 700
	ELSEIF EXP:ARG:54 < EXPLV:5
		SOURCE:ARG:露出 += 1000
		SOURCE:ARG:屈従 += 500
		SOURCE:ARG:不潔 += 400
	ELSE
		SOURCE:ARG:露出 += 500
		SOURCE:ARG:屈従 += 300
	ENDIF

	;PRINTFORML %CALLNAME:ARG%は乳首から大量の母乳を噴出した
	;PRINTL 噴乳経験＋５
	SIF EXP:ARG:54 == 0
		CALL ADDS_ABNORMAL_EXP("Milk Geyser", ARG)
	CALL ADDS_EXP("噴乳経験", 5, ARG)
	;EXP:ARG:54 += 5
	;Ｂに母乳汚れ
	STAIN:ARG:5 |= 16

	BASE:ARG:3 -= MAXBASE:ARG:3*5
	SIF BASE:ARG:3 >= MAXBASE:ARG:3
		BASE:ARG:3 = MAXBASE:ARG:3-1

	;調教対象が噴乳フラグ
	IF ARG == MASTER
		TFLAG:主人が噴乳 += 5
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:主人が搾乳中 += 5
	ELSEIF  ARG == ASSI
		TFLAG:助手が噴乳 += 5
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:助手が搾乳中 += 5
	ELSE
		TFLAG:調教対象が噴乳 += 5
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:搾乳中 += 5
	ENDIF

;なぜか:4が使われていたけれど噴乳は:10なのだから:10ではないのか？CSVにも:4は何も書かれていないし
;	NOWEX:ARG:4 += 5
;	EX:ARG:4 += 5
	NOWEX:ARG:10 += 5
	EX:ARG:10 += 5
;最強噴乳
ELSEIF 変数B == 4
	DOWNBASE:ARG:0 += 20
	DOWNBASE:ARG:1 += 100

	IF EXP:ARG:54 < EXPLV:1
		SOURCE:ARG:露出 += 10000
		SOURCE:ARG:屈従 += 5000
		SOURCE:ARG:不潔 += 2000
	ELSEIF EXP:ARG:54 < EXPLV:2
		SOURCE:ARG:露出 += 5000
		SOURCE:ARG:屈従 += 3000
		SOURCE:ARG:不潔 += 1500
	ELSEIF EXP:ARG:54 < EXPLV:3
		SOURCE:ARG:露出 += 3000
		SOURCE:ARG:屈従 += 1500
		SOURCE:ARG:不潔 += 1000
	ELSEIF EXP:ARG:54 < EXPLV:4
		SOURCE:ARG:露出 += 1500
		SOURCE:ARG:屈従 += 800
		SOURCE:ARG:不潔 += 700
	ELSEIF EXP:ARG:54 < EXPLV:5
		SOURCE:ARG:露出 += 1000
		SOURCE:ARG:屈従 += 500
		SOURCE:ARG:不潔 += 400
	ELSE
		SOURCE:ARG:露出 += 500
		SOURCE:ARG:屈従 += 300
	ENDIF

	;PRINTFORML %CALLNAME:ARG%は乳首から大量の母乳を噴出した
	;PRINTL 噴乳経験＋４
	SIF EXP:ARG:54 == 0
		CALL ADDS_ABNORMAL_EXP("Milk Geyser", ARG)
	CALL ADDS_EXP("噴乳経験", 4, ARG)
	;EXP:ARG:54 += 4
	;Ｂに母乳汚れ
	STAIN:ARG:5 |= 16

	BASE:ARG:3 -= MAXBASE:ARG:3*4
	SIF BASE:ARG:3 >= MAXBASE:ARG:3
		BASE:ARG:3 = MAXBASE:ARG:3 -1

	;調教対象が噴乳フラグ
	IF ARG == MASTER
		TFLAG:主人が噴乳 += 4
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:主人が搾乳中 += 4
	ELSEIF  ARG == ASSI
		TFLAG:助手が噴乳 += 4
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:助手が搾乳中 += 4
	ELSE
		TFLAG:調教対象が噴乳 += 4
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:搾乳中 += 4
	ENDIF

	NOWEX:ARG:10 += 4
	EX:ARG:10 += 4
;超大量噴乳
ELSEIF E == 3
	DOWNBASE:ARG:0 += 20
	DOWNBASE:ARG:1 += 100

	IF EXP:ARG:54 < EXPLV:1
		SOURCE:ARG:露出 += 10000
		SOURCE:ARG:屈従 += 5000
		SOURCE:ARG:不潔 += 2000
	ELSEIF EXP:ARG:54 < EXPLV:2
		SOURCE:ARG:露出 += 5000
		SOURCE:ARG:屈従 += 3000
		SOURCE:ARG:不潔 += 1500
	ELSEIF EXP:ARG:54 < EXPLV:3
		SOURCE:ARG:露出 += 3000
		SOURCE:ARG:屈従 += 1500
		SOURCE:ARG:不潔 += 1000
	ELSEIF EXP:ARG:54 < EXPLV:4
		SOURCE:ARG:露出 += 1500
		SOURCE:ARG:屈従 += 800
		SOURCE:ARG:不潔 += 700
	ELSEIF EXP:ARG:54 < EXPLV:5
		SOURCE:ARG:露出 += 1000
		SOURCE:ARG:屈従 += 500
		SOURCE:ARG:不潔 += 400
	ELSE
		SOURCE:ARG:露出 += 500
		SOURCE:ARG:屈従 += 300
	ENDIF

	;PRINTFORML %CALLNAME:ARG%は乳首から大量の母乳を噴出した
	;PRINTL 噴乳経験＋３
	SIF EXP:ARG:54 == 0
		CALL ADDS_ABNORMAL_EXP("Milk Geyser", ARG)
	CALL ADDS_EXP("噴乳経験", 3, ARG)
	;Ｂに母乳汚れ
	STAIN:ARG:5 |= 16

	BASE:ARG:3 -= MAXBASE:ARG:3 *3
	SIF BASE:ARG:3 >= MAXBASE:ARG:3
		BASE:ARG:3 = MAXBASE:ARG:3 -1

	;調教対象が噴乳フラグ
	IF ARG == MASTER
		TFLAG:主人が噴乳 += 3
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:主人が搾乳中 += 3
	ELSEIF  ARG == ASSI
		TFLAG:助手が噴乳 += 3
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:助手が搾乳中 += 3
	ELSE
		TFLAG:調教対象が噴乳 += 3
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:搾乳中 += 3
	ENDIF

	NOWEX:ARG:10 += 3
	EX:ARG:10 += 3
;大量噴乳
ELSEIF 変数B == 2
	DOWNBASE:ARG:0 += 20
	DOWNBASE:ARG:1 += 100

	IF EXP:ARG:54 < EXPLV:1
		SOURCE:ARG:露出 += 10000
		SOURCE:ARG:屈従 += 5000
		SOURCE:ARG:不潔 += 2000
	ELSEIF EXP:ARG:54 < EXPLV:2
		SOURCE:ARG:露出 += 5000
		SOURCE:ARG:屈従 += 3000
		SOURCE:ARG:不潔 += 1500
	ELSEIF EXP:ARG:54 < EXPLV:3
		SOURCE:ARG:露出 += 3000
		SOURCE:ARG:屈従 += 1500
		SOURCE:ARG:不潔 += 1000
	ELSEIF EXP:ARG:54 < EXPLV:4
		SOURCE:ARG:露出 += 1500
		SOURCE:ARG:屈従 += 800
		SOURCE:ARG:不潔 += 700
	ELSEIF EXP:ARG:54 < EXPLV:5
		SOURCE:ARG:露出 += 1000
		SOURCE:ARG:屈従 += 500
		SOURCE:ARG:不潔 += 400
	ELSE
		SOURCE:ARG:露出 += 500
		SOURCE:ARG:屈従 += 300
	ENDIF

	;PRINTFORML %CALLNAME:ARG%は乳首から大量の母乳を噴出した
	;PRINTL 噴乳経験＋２
	SIF EXP:ARG:54 == 0
		CALL ADDS_ABNORMAL_EXP("Milk Geyser", ARG)
	CALL ADDS_EXP("噴乳経験", 2, ARG)
	;Ｂに母乳汚れ
	STAIN:ARG:5 |= 16

	BASE:ARG:3 -= MAXBASE:ARG:3 *2
	SIF BASE:ARG:3 >= MAXBASE:ARG:3
		BASE:ARG:3 = MAXBASE:ARG:3 -1

	;調教対象が噴乳フラグ
	IF ARG == MASTER
		TFLAG:主人が噴乳 += 2
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:主人が搾乳中 += 2
	ELSEIF  ARG == ASSI
		TFLAG:助手が噴乳 += 2
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:助手が搾乳中 += 2
	ELSE
		TFLAG:調教対象が噴乳 += 2
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:搾乳中 += 2
	ENDIF

	NOWEX:ARG:10 += 2
	EX:ARG:10 += 2
;通常の噴乳
ELSEIF 変数B == 1
	DOWNBASE:ARG:1 += 40

	IF EXP:ARG:54 < EXPLV:1
		SOURCE:ARG:露出 += 5000
		SOURCE:ARG:屈従 += 2500
		SOURCE:ARG:不潔 += 900
	ELSEIF EXP:ARG:54 < EXPLV:2
		SOURCE:ARG:露出 += 2500
		SOURCE:ARG:屈従 += 2000
		SOURCE:ARG:不潔 += 700
	ELSEIF EXP:ARG:54 < EXPLV:3
		SOURCE:ARG:露出 += 1000
		SOURCE:ARG:屈従 += 800
		SOURCE:ARG:不潔 += 500
	ELSEIF EXP:ARG:54 < EXPLV:4
		SOURCE:ARG:露出 += 800
		SOURCE:ARG:屈従 += 600
		SOURCE:ARG:不潔 += 350
	ELSEIF EXP:ARG:54 < EXPLV:5
		SOURCE:ARG:露出 += 400
		SOURCE:ARG:屈従 += 400
		SOURCE:ARG:不潔 += 200
	ELSE
		SOURCE:ARG:露出 += 200
		SOURCE:ARG:屈従 += 250
	ENDIF

	;PRINTFORML %CALLNAME:ARG%は乳首から母乳を垂れ流した
	;PRINTL 噴乳経験＋１
	SIF EXP:ARG:54 == 0
		CALL ADDS_ABNORMAL_EXP("Milk Geyser", ARG)
	CALL ADDS_EXP("噴乳経験", 1, ARG)
	;Ｂに母乳汚れ
	STAIN:ARG:5 |= 16

	BASE:ARG:3 -= MAXBASE:ARG:3
	SIF BASE:ARG:3 >= MAXBASE:ARG:3
		BASE:ARG:3 = MAXBASE:ARG:3 -1

	;調教対象が噴乳フラグ
	IF ARG == MASTER
		TFLAG:主人が噴乳 += 1
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:主人が搾乳中 += 1
	ELSEIF  ARG == ASSI
		TFLAG:助手が噴乳 += 1
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:助手が搾乳中 += 1
	ELSE
		TFLAG:調教対象が噴乳 += 1
		;搾乳器で母乳が集められているかチェック
		SIF TEQUIP:ARG:17
			TFLAG:搾乳中 += 1
	ENDIF

	NOWEX:ARG:10 += 1
	EX:ARG:10 += 1
ENDIF

IF CFLAG:ARG:ＭＡＧ非被吸収 == 0 && 変数B > 0
	LOCAL = 2 * BASE:(ARG:1):LV * 変数B * 20 * (5+MAX(ABL:(ARG:1):従順,ABL:(ARG:1):欲望,ABL:(ARG:1):技巧))/5
	CALL DRAIN_MAG,ARG,LOCAL,ARG:1
ENDIF

;-------------------------------------------------
;同性の場合のチェック
;-------------------------------------------------
@SOURCE_SEX_CHECK, ARG, ARG:1

IF (!TALENT:ARG:獣 || TALENT:ARG:鳥) && (TALENT:(ARG:1):獣 || TALENT:(ARG:1):鳥)
	;ABL:獣姦中毒をみる
	IF ABL:ARG:22 == 0
		TIMES SOURCE:ARG:快Ｃ , 0.75
		TIMES SOURCE:ARG:快Ｖ , 0.75
		TIMES SOURCE:ARG:快Ａ , 0.75
		TIMES SOURCE:ARG:快Ｂ , 0.75
		TIMES SOURCE:ARG:達成 , 0.90
		TIMES SOURCE:ARG:屈従 , 1.20
		TIMES SOURCE:ARG:不潔 , 1.30
		TIMES SOURCE:ARG:逸脱 , 1.30
		TIMES SOURCE:ARG:反感 , 1.20
		TIMES SOURCE:ARG:鬱屈 , 1.20
	ELSEIF ABL:ARG:22 == 1
		SOURCE:ARG:9 += 100
		TIMES SOURCE:ARG:快Ｃ , 1.10
		TIMES SOURCE:ARG:快Ｖ , 1.10
		TIMES SOURCE:ARG:快Ａ , 1.10
		TIMES SOURCE:ARG:快Ｂ , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
		TIMES SOURCE:ARG:屈従 , 0.90
		TIMES SOURCE:ARG:不潔 , 0.90
		TIMES SOURCE:ARG:逸脱 , 0.90
	ELSEIF ABL:ARG:22 == 2
		SOURCE:ARG:9 += 200
		TIMES SOURCE:ARG:快Ｃ , 1.20
		TIMES SOURCE:ARG:快Ｖ , 1.20
		TIMES SOURCE:ARG:快Ａ , 1.20
		TIMES SOURCE:ARG:快Ｂ , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
		TIMES SOURCE:ARG:屈従 , 0.80
		TIMES SOURCE:ARG:不潔 , 0.80
		TIMES SOURCE:ARG:逸脱 , 0.80
	ELSEIF ABL:ARG:22 == 3
		SOURCE:ARG:9 += 350
		TIMES SOURCE:ARG:快Ｃ , 1.30
		TIMES SOURCE:ARG:快Ｖ , 1.30
		TIMES SOURCE:ARG:快Ａ , 1.30
		TIMES SOURCE:ARG:快Ｂ , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
		TIMES SOURCE:ARG:屈従 , 0.70
		TIMES SOURCE:ARG:不潔 , 0.70
		TIMES SOURCE:ARG:逸脱 , 0.70
	ELSEIF ABL:ARG:22 == 4
		SOURCE:ARG:9 += 500
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ , 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:22 == 5
		SOURCE:ARG:9 += 750
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ , 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:22 == 6
		SOURCE:ARG:9 += 1000
		TIMES SOURCE:ARG:快Ｃ , 1.50
		TIMES SOURCE:ARG:快Ｖ , 1.50
		TIMES SOURCE:ARG:快Ａ , 1.50
		TIMES SOURCE:ARG:快Ｂ , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
		TIMES SOURCE:ARG:屈従 , 0.50
		TIMES SOURCE:ARG:不潔 , 0.50
		TIMES SOURCE:ARG:逸脱 , 0.50
	ELSEIF ABL:ARG:22 == 7
		SOURCE:ARG:9 += 1200
		TIMES SOURCE:ARG:快Ｃ , 1.60
		TIMES SOURCE:ARG:快Ｖ , 1.60
		TIMES SOURCE:ARG:快Ａ , 1.60
		TIMES SOURCE:ARG:快Ｂ , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
		TIMES SOURCE:ARG:屈従 , 0.40
		TIMES SOURCE:ARG:不潔 , 0.40
		TIMES SOURCE:ARG:逸脱 , 0.40
	ELSEIF ABL:ARG:22 == 8
		SOURCE:ARG:9 += 1500
		TIMES SOURCE:ARG:快Ｃ , 1.70
		TIMES SOURCE:ARG:快Ｖ , 1.70
		TIMES SOURCE:ARG:快Ａ , 1.70
		TIMES SOURCE:ARG:快Ｂ , 1.70
		TIMES SOURCE:ARG:達成 , 1.70
		TIMES SOURCE:ARG:屈従 , 0.30
		TIMES SOURCE:ARG:不潔 , 0.30
		TIMES SOURCE:ARG:逸脱 , 0.30
	ELSEIF ABL:ARG:22 == 9
		SOURCE:ARG:9 += 1800
		TIMES SOURCE:ARG:快Ｃ , 1.80
		TIMES SOURCE:ARG:快Ｖ , 1.80
		TIMES SOURCE:ARG:快Ａ , 1.80
		TIMES SOURCE:ARG:快Ｂ , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
		TIMES SOURCE:ARG:屈従 , 0.20
		TIMES SOURCE:ARG:不潔 , 0.20
		TIMES SOURCE:ARG:逸脱 , 0.20
	ELSEIF ABL:ARG:22 == 10
		SOURCE:ARG:9 += 2500
		TIMES SOURCE:ARG:快Ｃ , 1.90
		TIMES SOURCE:ARG:快Ｖ , 1.90
		TIMES SOURCE:ARG:快Ａ , 1.90
		TIMES SOURCE:ARG:快Ｂ , 1.90
		TIMES SOURCE:ARG:達成 , 1.90
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ELSE
		SOURCE:ARG:9 += ABL:ARG:22 * 600 + 100 * (ABL:ARG:22 - 10) - 3400
		SOURCE:ARG:快Ｃ = SOURCE:ARG:快Ｃ * (ABL:ARG:22 * 10 + 90) / 100
		SOURCE:ARG:快Ｖ = SOURCE:ARG:快Ｖ * (ABL:ARG:22 * 10 + 90) / 100
		SOURCE:ARG:快Ａ = SOURCE:ARG:快Ａ * (ABL:ARG:22 * 10 + 90) / 100
		SOURCE:ARG:快Ｂ = SOURCE:ARG:快Ｂ * (ABL:ARG:22 * 10 + 90) / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:ARG:22 * 10 + 90) / 100
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ENDIF
ENDIF

IF TALENT:(ARG:1):触手 || TEQUIP:25
	;ABL:触手中毒をみる
	IF ABL:ARG:23 == 0 
		TIMES SOURCE:ARG:快Ｃ , 0.75
		TIMES SOURCE:ARG:快Ｖ , 0.75
		TIMES SOURCE:ARG:快Ａ , 0.75
		TIMES SOURCE:ARG:快Ｂ , 0.75
		TIMES SOURCE:ARG:達成 , 0.90
		TIMES SOURCE:ARG:屈従 , 1.20
		TIMES SOURCE:ARG:不潔 , 1.30
		TIMES SOURCE:ARG:恐れ , 1.20
		TIMES SOURCE:ARG:逸脱 , 1.20
		TIMES SOURCE:ARG:反感 , 1.20
		TIMES SOURCE:ARG:鬱屈 , 1.20
	ELSEIF ABL:ARG:23 == 1
		SOURCE:ARG:9 += 100
		TIMES SOURCE:ARG:快Ｃ , 1.10
		TIMES SOURCE:ARG:快Ｖ , 1.10
		TIMES SOURCE:ARG:快Ａ , 1.10
		TIMES SOURCE:ARG:快Ｂ , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
		TIMES SOURCE:ARG:屈従 , 0.90
		TIMES SOURCE:ARG:不潔 , 0.90
		TIMES SOURCE:ARG:恐れ , 0.90
		TIMES SOURCE:ARG:逸脱 , 0.90
		TIMES SOURCE:ARG:反感 , 0.90
	ELSEIF ABL:ARG:23 == 2
		SOURCE:ARG:9 += 200
		TIMES SOURCE:ARG:快Ｃ , 1.20
		TIMES SOURCE:ARG:快Ｖ , 1.20
		TIMES SOURCE:ARG:快Ａ , 1.20
		TIMES SOURCE:ARG:快Ｂ , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
		TIMES SOURCE:ARG:屈従 , 0.80
		TIMES SOURCE:ARG:不潔 , 0.80
		TIMES SOURCE:ARG:恐れ , 0.80
		TIMES SOURCE:ARG:逸脱 , 0.80
		TIMES SOURCE:ARG:反感 , 0.80
	ELSEIF ABL:ARG:23 == 3
		SOURCE:ARG:9 += 350
		TIMES SOURCE:ARG:快Ｃ , 1.30
		TIMES SOURCE:ARG:快Ｖ , 1.30
		TIMES SOURCE:ARG:快Ａ , 1.30
		TIMES SOURCE:ARG:快Ｂ , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
		TIMES SOURCE:ARG:屈従 , 0.70
		TIMES SOURCE:ARG:不潔 , 0.70
		TIMES SOURCE:ARG:恐れ , 0.70
		TIMES SOURCE:ARG:逸脱 , 0.70
		TIMES SOURCE:ARG:反感 , 0.70
	ELSEIF ABL:ARG:23 == 4
		SOURCE:ARG:9 += 500
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ , 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:恐れ , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
		TIMES SOURCE:ARG:反感 , 0.60
	ELSEIF ABL:ARG:23 == 5
		SOURCE:ARG:9 += 750
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ , 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:恐れ , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
		TIMES SOURCE:ARG:反感 , 0.60
	ELSEIF ABL:ARG:23 == 6
		SOURCE:ARG:9 += 1000
		TIMES SOURCE:ARG:快Ｃ , 1.50
		TIMES SOURCE:ARG:快Ｖ , 1.50
		TIMES SOURCE:ARG:快Ａ , 1.50
		TIMES SOURCE:ARG:快Ｂ , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
		TIMES SOURCE:ARG:屈従 , 0.50
		TIMES SOURCE:ARG:不潔 , 0.50
		TIMES SOURCE:ARG:恐れ , 0.50
		TIMES SOURCE:ARG:逸脱 , 0.50
		TIMES SOURCE:ARG:反感 , 0.50
	ELSEIF ABL:ARG:23 == 7
		SOURCE:ARG:9 += 1200
		TIMES SOURCE:ARG:快Ｃ , 1.60
		TIMES SOURCE:ARG:快Ｖ , 1.60
		TIMES SOURCE:ARG:快Ａ , 1.60
		TIMES SOURCE:ARG:快Ｂ , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
		TIMES SOURCE:ARG:屈従 , 0.40
		TIMES SOURCE:ARG:不潔 , 0.40
		TIMES SOURCE:ARG:恐れ , 0.40
		TIMES SOURCE:ARG:逸脱 , 0.40
		TIMES SOURCE:ARG:反感 , 0.40
	ELSEIF ABL:ARG:23 == 8
		SOURCE:ARG:9 += 1500
		TIMES SOURCE:ARG:快Ｃ , 1.70
		TIMES SOURCE:ARG:快Ｖ , 1.70
		TIMES SOURCE:ARG:快Ａ , 1.70
		TIMES SOURCE:ARG:快Ｂ , 1.70
		TIMES SOURCE:ARG:達成 , 1.70
		TIMES SOURCE:ARG:屈従 , 0.30
		TIMES SOURCE:ARG:不潔 , 0.30
		TIMES SOURCE:ARG:恐れ , 0.30
		TIMES SOURCE:ARG:逸脱 , 0.30
		TIMES SOURCE:ARG:反感 , 0.30
	ELSEIF ABL:ARG:23 == 9
		SOURCE:ARG:9 += 1800
		TIMES SOURCE:ARG:快Ｃ , 1.80
		TIMES SOURCE:ARG:快Ｖ , 1.80
		TIMES SOURCE:ARG:快Ａ , 1.80
		TIMES SOURCE:ARG:快Ｂ , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
		TIMES SOURCE:ARG:屈従 , 0.20
		TIMES SOURCE:ARG:不潔 , 0.20
		TIMES SOURCE:ARG:恐れ , 0.20
		TIMES SOURCE:ARG:逸脱 , 0.20
		TIMES SOURCE:ARG:反感 , 0.20
	ELSEIF ABL:ARG:23 == 10
		SOURCE:ARG:9 += 2500
		TIMES SOURCE:ARG:快Ｃ , 1.90
		TIMES SOURCE:ARG:快Ｖ , 1.90
		TIMES SOURCE:ARG:快Ａ , 1.90
		TIMES SOURCE:ARG:快Ｂ , 1.90
		TIMES SOURCE:ARG:達成 , 1.90
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:恐れ , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
		TIMES SOURCE:ARG:反感 , 0.10
	ELSE
		SOURCE:ARG:9 += ABL:ARG:23 * 600 + 100 * (ABL:ARG:23 - 10) - 3400
		SOURCE:ARG:快Ｃ = SOURCE:ARG:快Ｃ * (ABL:ARG:23 * 10 + 90) / 100
		SOURCE:ARG:快Ｖ = SOURCE:ARG:快Ｖ * (ABL:ARG:23 * 10 + 90) / 100
		SOURCE:ARG:快Ａ = SOURCE:ARG:快Ａ * (ABL:ARG:23 * 10 + 90) / 100
		SOURCE:ARG:快Ｂ = SOURCE:ARG:快Ｂ * (ABL:ARG:23 * 10 + 90) / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:ARG:23 * 10 + 90) / 100
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:恐れ , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
		TIMES SOURCE:ARG:反感 , 0.10
	ENDIF
ENDIF

SIF (!IS_GAY(ARG, ARG:1))
	RETURN 0

;レズ
IF IS_LESBIAN(ARG, ARG:1)
	;ABL:レズっ気をみる
	IF ABL:ARG:11 == 0
		TIMES SOURCE:ARG:屈従 , 1.20
		TIMES SOURCE:ARG:逸脱 , 1.20
	ELSEIF ABL:ARG:11 == 1
		TIMES SOURCE:ARG:達成 , 1.10
	ELSEIF ABL:ARG:11 == 2
		TIMES SOURCE:ARG:達成 , 1.20
		TIMES SOURCE:ARG:屈従 , 0.90
		TIMES SOURCE:ARG:逸脱 , 0.90
	ELSEIF ABL:ARG:11 == 3
		TIMES SOURCE:ARG:達成 , 1.30
		TIMES SOURCE:ARG:屈従 , 0.80
		TIMES SOURCE:ARG:逸脱 , 0.80
	ELSEIF ABL:ARG:11 == 4
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.70
		TIMES SOURCE:ARG:逸脱 , 0.70
	ELSEIF ABL:ARG:11 == 5
		TIMES SOURCE:ARG:達成 , 1.50
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:11 == 6
		TIMES SOURCE:ARG:達成 , 1.60
		TIMES SOURCE:ARG:屈従 , 0.50
		TIMES SOURCE:ARG:逸脱 , 0.50
	ELSEIF ABL:ARG:11 == 7
		TIMES SOURCE:ARG:達成 , 1.70
		TIMES SOURCE:ARG:屈従 , 0.40
		TIMES SOURCE:ARG:逸脱 , 0.40
	ELSEIF ABL:ARG:11 == 8
		TIMES SOURCE:ARG:達成 , 1.80
		TIMES SOURCE:ARG:屈従 , 0.30
		TIMES SOURCE:ARG:逸脱 , 0.30
	ELSEIF ABL:ARG:11 == 9
		TIMES SOURCE:ARG:達成 , 1.90
		TIMES SOURCE:ARG:屈従 , 0.20
		TIMES SOURCE:ARG:逸脱 , 0.20
	ELSE
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:ARG:11 * 10 + 100) / 100
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ENDIF
	
	;ABL:レズ中毒をみる
	IF ABL:ARG:17 == 1
		SOURCE:ARG:9 += 100
		TIMES SOURCE:ARG:快Ｃ , 1.10
		TIMES SOURCE:ARG:快Ｖ , 1.10
		TIMES SOURCE:ARG:快Ａ , 1.10
		TIMES SOURCE:ARG:快Ｂ , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
		TIMES SOURCE:ARG:屈従 , 0.90
		TIMES SOURCE:ARG:不潔 , 0.90
		TIMES SOURCE:ARG:逸脱 , 0.90
	ELSEIF ABL:ARG:17 == 2
		SOURCE:ARG:9 += 200
		TIMES SOURCE:ARG:快Ｃ , 1.20
		TIMES SOURCE:ARG:快Ｖ , 1.20
		TIMES SOURCE:ARG:快Ａ , 1.20
		TIMES SOURCE:ARG:快Ｂ , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
		TIMES SOURCE:ARG:屈従 , 0.80
		TIMES SOURCE:ARG:不潔 , 0.80
		TIMES SOURCE:ARG:逸脱 , 0.80
	ELSEIF ABL:ARG:17 == 3
		SOURCE:ARG:9 += 350
		TIMES SOURCE:ARG:快Ｃ , 1.30
		TIMES SOURCE:ARG:快Ｖ , 1.30
		TIMES SOURCE:ARG:快Ａ , 1.30
		TIMES SOURCE:ARG:快Ｂ , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
		TIMES SOURCE:ARG:屈従 , 0.70
		TIMES SOURCE:ARG:不潔 , 0.70
		TIMES SOURCE:ARG:逸脱 , 0.70
	ELSEIF ABL:ARG:17 == 4
		SOURCE:ARG:9 += 500
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ , 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:17 == 5
		SOURCE:ARG:中毒充足 += 750
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ, 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:17 == 6
		SOURCE:ARG:中毒充足 += 1000
		TIMES SOURCE:ARG:快Ｃ , 1.50
		TIMES SOURCE:ARG:快Ｖ, 1.50
		TIMES SOURCE:ARG:快Ａ , 1.50
		TIMES SOURCE:ARG:快Ｂ , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
		TIMES SOURCE:ARG:屈従 , 0.50
		TIMES SOURCE:ARG:不潔 , 0.50
		TIMES SOURCE:ARG:逸脱 , 0.50
	ELSEIF ABL:ARG:17 == 7
		SOURCE:ARG:中毒充足 += 1200
		TIMES SOURCE:ARG:快Ｃ , 1.60
		TIMES SOURCE:ARG:快Ｖ, 1.60
		TIMES SOURCE:ARG:快Ａ , 1.60
		TIMES SOURCE:ARG:快Ｂ , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
		TIMES SOURCE:ARG:屈従 , 0.40
		TIMES SOURCE:ARG:不潔 , 0.40
		TIMES SOURCE:ARG:逸脱 , 0.40
	ELSEIF ABL:ARG:17 == 8
		SOURCE:ARG:中毒充足 += 1500
		TIMES SOURCE:ARG:快Ｃ , 1.70
		TIMES SOURCE:ARG:快Ｖ, 1.70
		TIMES SOURCE:ARG:快Ａ , 1.70
		TIMES SOURCE:ARG:快Ｂ , 1.70
		TIMES SOURCE:ARG:達成 , 1.70
		TIMES SOURCE:ARG:屈従 , 0.30
		TIMES SOURCE:ARG:不潔 , 0.30
		TIMES SOURCE:ARG:逸脱 , 0.30
	ELSEIF ABL:ARG:17 == 9
		SOURCE:ARG:中毒充足 += 1800
		TIMES SOURCE:ARG:快Ｃ , 1.80
		TIMES SOURCE:ARG:快Ｖ, 1.80
		TIMES SOURCE:ARG:快Ａ , 1.80
		TIMES SOURCE:ARG:快Ｂ , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
		TIMES SOURCE:ARG:屈従 , 0.20
		TIMES SOURCE:ARG:不潔 , 0.20
		TIMES SOURCE:ARG:逸脱 , 0.20
	ELSEIF ABL:ARG:17 == 10
		SOURCE:ARG:中毒充足 += 2500
		TIMES SOURCE:ARG:快Ｃ , 1.90
		TIMES SOURCE:ARG:快Ｖ, 1.90
		TIMES SOURCE:ARG:快Ａ , 1.90
		TIMES SOURCE:ARG:快Ｂ , 1.90
		TIMES SOURCE:ARG:達成 , 1.90
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ELSE
		SOURCE:ARG:9 += ABL:ARG:17 * 600 + 100 * (ABL:ARG:17 - 10) - 3400
		SOURCE:ARG:快Ｃ = SOURCE:ARG:快Ｃ * (ABL:ARG:17 * 10 + 90) / 100
		SOURCE:ARG:快Ｖ = SOURCE:ARG:快Ｖ * (ABL:ARG:17 * 10 + 90) / 100
		SOURCE:ARG:快Ａ = SOURCE:ARG:快Ａ * (ABL:ARG:17 * 10 + 90) / 100
		SOURCE:ARG:快Ｂ = SOURCE:ARG:快Ｂ * (ABL:ARG:17 * 10 + 90) / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:ARG:17 * 10 + 90) / 100
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ENDIF

	;調教者のABL:レズっ気
	IF ABL:(ARG:1):11 == 0
		TIMES SOURCE:ARG:情愛 , 0.50
		TIMES SOURCE:ARG:達成 , 0.50
	ELSEIF ABL:(ARG:1):11 == 1
		TIMES SOURCE:ARG:情愛 , 0.70
		TIMES SOURCE:ARG:達成 , 0.70
	ELSEIF ABL:(ARG:1):11 == 2
		TIMES SOURCE:ARG:情愛 , 0.90
		TIMES SOURCE:ARG:達成 , 0.90
	ELSEIF ABL:(ARG:1):11 == 3
		TIMES SOURCE:ARG:情愛 , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
	ELSEIF ABL:(ARG:1):11 == 4
		TIMES SOURCE:ARG:情愛 , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
	ELSEIF ABL:(ARG:1):11 == 5
		TIMES SOURCE:ARG:情愛 , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
	ELSEIF ABL:(ARG:1):11 == 6
		TIMES SOURCE:ARG:情愛 , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
	ELSEIF ABL:(ARG:1):11 == 7
		TIMES SOURCE:ARG:情愛 , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
	ELSEIF ABL:(ARG:1):11 == 8
		TIMES SOURCE:ARG:情愛 , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
	ELSEIF ABL:(ARG:1):11 == 9
		TIMES SOURCE:ARG:情愛 , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
	ELSEIF ABL:(ARG:1):11 == 10
		TIMES SOURCE:ARG:情愛 , 2.00
		TIMES SOURCE:ARG:達成 , 2.00
	ELSE
		SOURCE:ARG:情愛 = SOURCE:ARG:情愛 * ABL:(ARG:1):11 * 20 / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * ABL:(ARG:1):11 * 20 / 100
	ENDIF

	;調教者のABL:レズ中毒
	IF ABL:(ARG:1):17 == 1
		TIMES SOURCE:ARG:情愛 , 1.10
		TIMES SOURCE:ARG:性行動 , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
	ELSEIF ABL:(ARG:1):17 == 2
		TIMES SOURCE:ARG:情愛 , 1.20
		TIMES SOURCE:ARG:性行動 , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
	ELSEIF ABL:(ARG:1):17 == 3
		TIMES SOURCE:ARG:情愛 , 1.30
		TIMES SOURCE:ARG:性行動 , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
	ELSEIF ABL:(ARG:1):17 == 4
		TIMES SOURCE:ARG:情愛 , 1.40
		TIMES SOURCE:ARG:性行動 , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
	ELSEIF ABL:(ARG:1):17 == 5
		TIMES SOURCE:ARG:情愛 , 1.50
		TIMES SOURCE:ARG:性行動 , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
	ELSEIF ABL:(ARG:1):17 == 6
		TIMES SOURCE:ARG:情愛 , 1.60
		TIMES SOURCE:ARG:性行動 , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
	ELSEIF ABL:(ARG:1):17 == 7
		TIMES SOURCE:ARG:情愛 , 1.70
		TIMES SOURCE:ARG:性行動 , 1.70
		TIMES SOURCE:ARG:達成 , 1.70
	ELSEIF ABL:(ARG:1):17 == 8
		TIMES SOURCE:ARG:情愛 , 1.80
		TIMES SOURCE:ARG:性行動 , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
	ELSEIF ABL:(ARG:1):17 == 9
		TIMES SOURCE:ARG:情愛 , 1.90
		TIMES SOURCE:ARG:性行動 , 1.90
		TIMES SOURCE:ARG:達成 , 1.90
	ELSEIF ABL:(ARG:1):17 == 10
		TIMES SOURCE:ARG:情愛 , 2.00
		TIMES SOURCE:ARG:性行動 , 2.00
		TIMES SOURCE:ARG:達成 , 2.00
	ELSE
		SOURCE:ARG:情愛 = SOURCE:ARG:情愛 * (ABL:(ARG:1):17 * 10 + 90) / 100
		SOURCE:ARG:性行動 = SOURCE:ARG:性行動 * (ABL:(ARG:1):17 * 10 + 90) / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:(ARG:1):17 * 10 + 90) / 100
	ENDIF

	;調教者の自制心
	IF TALENT:(ARG:1):20
		TIMES SOURCE:ARG:性行動 , 0.50
		TIMES SOURCE:ARG:達成 , 0.50
	ENDIF
ENDIF

;ＢＬ
IF IS_GAY(ARG, ARG:1)
	;ABL:ＢＬっ気をみる
	IF ABL:ARG:20 == 0 && TALENT:(ARG:1):男の娘 == 0
		TIMES SOURCE:ARG:屈従 , 1.20
		TIMES SOURCE:ARG:逸脱 , 1.20
	ELSEIF ABL:ARG:20 == 1
		TIMES SOURCE:ARG:達成 , 1.10
	ELSEIF ABL:ARG:20 == 2
		TIMES SOURCE:ARG:達成 , 1.20
		TIMES SOURCE:ARG:屈従 , 0.90
		TIMES SOURCE:ARG:逸脱 , 0.90
	ELSEIF ABL:ARG:20 == 3
		TIMES SOURCE:ARG:達成 , 1.30
		TIMES SOURCE:ARG:屈従 , 0.80
		TIMES SOURCE:ARG:逸脱 , 0.80
	ELSEIF ABL:ARG:20 == 4
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.70
		TIMES SOURCE:ARG:逸脱 , 0.70
	ELSEIF ABL:ARG:20 == 5
		TIMES SOURCE:ARG:達成 , 1.50
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:20 == 6
		TIMES SOURCE:ARG:達成 , 1.60
		TIMES SOURCE:ARG:屈従 , 0.50
		TIMES SOURCE:ARG:逸脱 , 0.50
	ELSEIF ABL:ARG:20 == 7
		TIMES SOURCE:ARG:達成 , 1.70
		TIMES SOURCE:ARG:屈従 , 0.40
		TIMES SOURCE:ARG:逸脱 , 0.40
	ELSEIF ABL:ARG:20 == 8
		TIMES SOURCE:ARG:達成 , 1.80
		TIMES SOURCE:ARG:屈従 , 0.30
		TIMES SOURCE:ARG:逸脱 , 0.30
	ELSEIF ABL:ARG:20 == 9
		TIMES SOURCE:ARG:達成 , 1.90
		TIMES SOURCE:ARG:屈従 , 0.20
		TIMES SOURCE:ARG:逸脱 , 0.20
	ELSEIF ABL:ARG:20 == 10
		TIMES SOURCE:ARG:達成 , 2.00
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ELSEIF ABL:ARG:20 > 10
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:ARG:20 * 10 + 100) / 100
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ENDIF
	
	;ABL:ＢＬ中毒をみる
	IF ABL:ARG:21 == 1
		SOURCE:ARG:中毒充足 += 100
		TIMES SOURCE:ARG:快Ｃ , 1.10
		TIMES SOURCE:ARG:快Ｖ, 1.10
		TIMES SOURCE:ARG:快Ａ , 1.10
		TIMES SOURCE:ARG:快Ｂ , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
		TIMES SOURCE:ARG:屈従 , 0.90
		TIMES SOURCE:ARG:不潔 , 0.90
		TIMES SOURCE:ARG:逸脱 , 0.90
	ELSEIF ABL:ARG:21 == 2
		SOURCE:ARG:中毒充足 += 200
		TIMES SOURCE:ARG:快Ｃ , 1.20
		TIMES SOURCE:ARG:快Ｖ, 1.20
		TIMES SOURCE:ARG:快Ａ , 1.20
		TIMES SOURCE:ARG:快Ｂ , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
		TIMES SOURCE:ARG:屈従 , 0.80
		TIMES SOURCE:ARG:不潔 , 0.80
		TIMES SOURCE:ARG:逸脱 , 0.80
	ELSEIF ABL:ARG:21 == 3
		SOURCE:ARG:中毒充足 += 350
		TIMES SOURCE:ARG:快Ｃ , 1.30
		TIMES SOURCE:ARG:快Ｖ, 1.30
		TIMES SOURCE:ARG:快Ａ , 1.30
		TIMES SOURCE:ARG:快Ｂ , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
		TIMES SOURCE:ARG:屈従 , 0.70
		TIMES SOURCE:ARG:不潔 , 0.70
		TIMES SOURCE:ARG:逸脱 , 0.70
	ELSEIF ABL:ARG:21 == 4
		SOURCE:ARG:中毒充足 += 500
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ, 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:21 == 5
		SOURCE:ARG:中毒充足 += 750
		TIMES SOURCE:ARG:快Ｃ , 1.40
		TIMES SOURCE:ARG:快Ｖ, 1.40
		TIMES SOURCE:ARG:快Ａ , 1.40
		TIMES SOURCE:ARG:快Ｂ , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
		TIMES SOURCE:ARG:屈従 , 0.60
		TIMES SOURCE:ARG:不潔 , 0.60
		TIMES SOURCE:ARG:逸脱 , 0.60
	ELSEIF ABL:ARG:21 == 6
		SOURCE:ARG:中毒充足 += 1000
		TIMES SOURCE:ARG:快Ｃ , 1.50
		TIMES SOURCE:ARG:快Ｖ, 1.50
		TIMES SOURCE:ARG:快Ａ , 1.50
		TIMES SOURCE:ARG:快Ｂ , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
		TIMES SOURCE:ARG:屈従 , 0.50
		TIMES SOURCE:ARG:不潔 , 0.50
		TIMES SOURCE:ARG:逸脱 , 0.50
	ELSEIF ABL:ARG:21 == 7
		SOURCE:ARG:中毒充足 += 1200
		TIMES SOURCE:ARG:快Ｃ , 1.60
		TIMES SOURCE:ARG:快Ｖ, 1.60
		TIMES SOURCE:ARG:快Ａ , 1.60
		TIMES SOURCE:ARG:快Ｂ , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
		TIMES SOURCE:ARG:屈従 , 0.40
		TIMES SOURCE:ARG:不潔 , 0.40
		TIMES SOURCE:ARG:逸脱 , 0.40
	ELSEIF ABL:ARG:21 == 8
		SOURCE:ARG:中毒充足 += 1500
		TIMES SOURCE:ARG:快Ｃ , 1.70
		TIMES SOURCE:ARG:快Ｖ, 1.70
		TIMES SOURCE:ARG:快Ａ , 1.70
		TIMES SOURCE:ARG:快Ｂ , 1.70
		TIMES SOURCE:ARG:達成 , 1.70
		TIMES SOURCE:ARG:屈従 , 0.30
		TIMES SOURCE:ARG:不潔 , 0.30
		TIMES SOURCE:ARG:逸脱 , 0.30
	ELSEIF ABL:ARG:21 == 9
		SOURCE:ARG:中毒充足 += 1800
		TIMES SOURCE:ARG:快Ｃ , 1.80
		TIMES SOURCE:ARG:快Ｖ, 1.80
		TIMES SOURCE:ARG:快Ａ , 1.80
		TIMES SOURCE:ARG:快Ｂ , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
		TIMES SOURCE:ARG:屈従 , 0.20
		TIMES SOURCE:ARG:不潔 , 0.20
		TIMES SOURCE:ARG:逸脱 , 0.20
	ELSEIF ABL:ARG:21 == 10
		SOURCE:ARG:中毒充足 += 2500
		TIMES SOURCE:ARG:快Ｃ , 1.90
		TIMES SOURCE:ARG:快Ｖ, 1.90
		TIMES SOURCE:ARG:快Ａ , 1.90
		TIMES SOURCE:ARG:快Ｂ , 1.90
		TIMES SOURCE:ARG:達成 , 1.90
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ELSEIF ABL:ARG:21 > 10
		SOURCE:ARG:9 += ABL:10 * 600 + 100 * (ABL:10 - 10) - 3400
		SOURCE:ARG:快Ｃ = SOURCE:ARG:快Ｃ * (ABL:10 * 10 + 90) / 100
		SOURCE:ARG:快Ｖ = SOURCE:ARG:快Ｖ * (ABL:10 * 10 + 90) / 100
		SOURCE:ARG:快Ａ = SOURCE:ARG:快Ａ * (ABL:10 * 10 + 90) / 100
		SOURCE:ARG:快Ｂ = SOURCE:ARG:快Ｂ * (ABL:10 * 10 + 90) / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:10 * 10 + 90) / 100
		TIMES SOURCE:ARG:屈従 , 0.10
		TIMES SOURCE:ARG:不潔 , 0.10
		TIMES SOURCE:ARG:逸脱 , 0.10
	ENDIF

	;調教者のABL:ＢＬっ気
	IF ABL:(ARG:1):20 == 0 && TALENT:男の娘 == 0
		TIMES SOURCE:ARG:情愛 , 0.50
		TIMES SOURCE:ARG:達成 , 0.50
	ELSEIF ABL:(ARG:1):20 == 1 && TALENT:男の娘 == 0
		TIMES SOURCE:ARG:情愛 , 0.70
		TIMES SOURCE:ARG:達成 , 0.70
	ELSEIF ABL:(ARG:1):20 == 2 && TALENT:男の娘 == 0
		TIMES SOURCE:ARG:情愛 , 0.90
		TIMES SOURCE:ARG:達成 , 0.90
	ELSEIF ABL:(ARG:1):20 == 3
		TIMES SOURCE:ARG:情愛 , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
	ELSEIF ABL:(ARG:1):20 == 4
		TIMES SOURCE:ARG:情愛 , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
	ELSEIF ABL:(ARG:1):20 == 5
		TIMES SOURCE:ARG:情愛 , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
	ELSEIF ABL:(ARG:1):20 == 6
		TIMES SOURCE:ARG:情愛 , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
	ELSEIF ABL:(ARG:1):20 == 7
		TIMES SOURCE:ARG:情愛 , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
	ELSEIF ABL:(ARG:1):20 == 8
		TIMES SOURCE:ARG:情愛 , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
	ELSEIF ABL:(ARG:1):20 == 9
		TIMES SOURCE:ARG:情愛 , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
	ELSEIF ABL:(ARG:1):20 == 10
		TIMES SOURCE:ARG:情愛 , 2.00
		TIMES SOURCE:ARG:達成 , 2.00
	ELSEIF ABL:(ARG:1):20 > 10
		SOURCE:ARG:情愛 = SOURCE:ARG:情愛 * ABL:(ARG:1):20 * 20 / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * ABL:(ARG:1):20 * 20 / 100
	ENDIF

	;調教者のABL:ＢＬ中毒
	IF ABL:(ARG:1):21 == 1
		TIMES SOURCE:ARG:情愛 , 1.10
		TIMES SOURCE:ARG:性行動 , 1.10
		TIMES SOURCE:ARG:達成 , 1.10
	ELSEIF ABL:(ARG:1):21 == 2
		TIMES SOURCE:ARG:情愛 , 1.20
		TIMES SOURCE:ARG:性行動 , 1.20
		TIMES SOURCE:ARG:達成 , 1.20
	ELSEIF ABL:(ARG:1):21 == 3
		TIMES SOURCE:ARG:情愛 , 1.30
		TIMES SOURCE:ARG:性行動 , 1.30
		TIMES SOURCE:ARG:達成 , 1.30
	ELSEIF ABL:(ARG:1):21 == 4
		TIMES SOURCE:ARG:情愛 , 1.40
		TIMES SOURCE:ARG:性行動 , 1.40
		TIMES SOURCE:ARG:達成 , 1.40
	ELSEIF ABL:(ARG:1):21 == 5
		TIMES SOURCE:ARG:情愛 , 1.50
		TIMES SOURCE:ARG:性行動 , 1.50
		TIMES SOURCE:ARG:達成 , 1.50
	ELSEIF ABL:(ARG:1):21 == 6
		TIMES SOURCE:ARG:情愛 , 1.60
		TIMES SOURCE:ARG:性行動 , 1.60
		TIMES SOURCE:ARG:達成 , 1.60
	ELSEIF ABL:(ARG:1):21 == 7
		TIMES SOURCE:ARG:情愛 , 1.70
		TIMES SOURCE:ARG:性行動 , 1.70
		TIMES SOURCE:ARG:達成 , 1.70
	ELSEIF ABL:(ARG:1):21 == 8
		TIMES SOURCE:ARG:情愛 , 1.80
		TIMES SOURCE:ARG:性行動 , 1.80
		TIMES SOURCE:ARG:達成 , 1.80
	ELSEIF ABL:(ARG:1):21 == 9
		TIMES SOURCE:ARG:情愛 , 1.90
		TIMES SOURCE:ARG:性行動 , 1.90
		TIMES SOURCE:ARG:達成 , 1.90
	ELSEIF ABL:(ARG:1):21 == 10
		TIMES SOURCE:ARG:情愛 , 2.00
		TIMES SOURCE:ARG:性行動 , 2.00
		TIMES SOURCE:ARG:達成 , 2.00
	ELSE
		SOURCE:ARG:情愛 = SOURCE:ARG:情愛 * (ABL:(ARG:1):21 * 10 + 90) / 100
		SOURCE:ARG:性行動 = SOURCE:ARG:性行動 * (ABL:(ARG:1):21 * 10 + 90) / 100
		SOURCE:ARG:達成 = SOURCE:ARG:達成 * (ABL:(ARG:1):21 * 10 + 90) / 100
	ENDIF

	;調教者の自制心
	IF TALENT:(ARG:1):20 && TALENT:男の娘 == 0
		TIMES SOURCE:ARG:性行動 , 0.50
		TIMES SOURCE:ARG:達成 , 0.50
	ENDIF
ENDIF

;オトコは女相手だとボーナス、女嫌いは恋慕ルート＋相手が主人じゃないと無効
IF (TALENT:ARG:オトコ && TALENT:(ARG:1):オトコ == 0) && (TALENT:ARG:女嫌い && !((TALENT:ARG:恋慕 || TALENT:ARG:親愛) && (ARG:1) == MASTER))
	TIMES SOURCE:ARG:快Ｃ , 1.30
	TIMES SOURCE:ARG:性行動 , 1.30
	TIMES SOURCE:ARG:達成 , 1.30
	TIMES SOURCE:ARG:欲情 , 1.30
	
ENDIF

@PLAYER_SKILL_CHECK, ARG, ARG:1
;調教者のTALENT:解放をみる
IF TALENT:(ARG:1):33
	TIMES SOURCE:ARG:快Ｃ , 1.20
	TIMES SOURCE:ARG:快Ｖ, 1.20
	TIMES SOURCE:ARG:快Ａ , 1.20
	TIMES SOURCE:ARG:快Ｂ , 1.20
	TIMES SOURCE:ARG:情愛 , 1.20
ENDIF
;調教者のTALENT:両刀をみる
IF TALENT:(ARG:1):81
	TIMES SOURCE:ARG:情愛 , 1.20
	TIMES SOURCE:ARG:性行動 , 1.20
	TIMES SOURCE:ARG:達成 , 1.20
ENDIF
;調教者のTALENT:サドをみる
SIF TALENT:(ARG:1):83
	TIMES SOURCE:ARG:恐れ , 1.50
;調教者のTALENT:LittleDevilをみる
SIF TALENT:(ARG:1):87
	TIMES SOURCE:ARG:露出 , 1.50
;調教者のTALENT:魅惑をみる
IF TALENT:(ARG:1):93
	TIMES SOURCE:ARG:不潔 , 0.50
	TIMES SOURCE:ARG:逸脱 , 0.50

	TIMES SOURCE:ARG:快Ｃ , 1.20
	TIMES SOURCE:ARG:快Ｖ, 1.20
	TIMES SOURCE:ARG:快Ａ , 1.20
	TIMES SOURCE:ARG:快Ｂ , 1.20
	TIMES SOURCE:ARG:性行動 , 1.20
ENDIF
;調教者のTALENT:MysteriousCharmをみる
IF TALENT:(ARG:1):94
	TIMES SOURCE:ARG:不潔 , 0.50
	TIMES SOURCE:ARG:逸脱 , 0.50

	TIMES SOURCE:ARG:快Ｃ , 1.20
	TIMES SOURCE:ARG:快Ｖ, 1.20
	TIMES SOURCE:ARG:快Ａ , 1.20
	TIMES SOURCE:ARG:快Ｂ , 1.20
	TIMES SOURCE:ARG:性行動 , 1.20
	TIMES SOURCE:ARG:達成 , 1.50
ENDIF

;-------------------------------------------------
;絶頂時の放尿処理
;-------------------------------------------------
@ORGASM_ADD_URINE, ARG
SIF TFLAG:29 == 0
	RETURN 0

IF TFLAG:29 >= 7 && TEQUIP:27 && TALENT:57
	;PRINTFORML %EXPNAME:31%＋５
	;EXP:ARG:31 += 5
	CALL ADDS_EXP("放尿経験", 5, ARG)
ELSEIF TFLAG:29 >= 7 && TEQUIP:27
	;PRINTFORML %EXPNAME:31%＋４
	;EXP:ARG:31 += 4
	CALL ADDS_EXP("放尿経験", 4, ARG)
ELSEIF TFLAG:29 >= 7 && TALENT:57
	;PRINTFORML %EXPNAME:31%＋３
	;EXP:ARG:31 += 3
	CALL ADDS_EXP("放尿経験", 3, ARG)
ELSEIF P >= 5 && TEQUIP:27 && TALENT:57
	;PRINTFORML %EXPNAME:31%＋４
	;EXP:ARG:31 += 4
	CALL ADDS_EXP("放尿経験", 4, ARG)
ELSEIF TFLAG:29 >= 5 && TEQUIP:27
	;PRINTFORML %EXPNAME:31%＋３
	;EXP:ARG:31 += 3
	CALL ADDS_EXP("放尿経験", 3, ARG)
ELSEIF TFLAG:29 >= 5 && TALENT:57
	;PRINTFORML %EXPNAME:31%＋２
	;EXP:ARG:31 += 2
	CALL ADDS_EXP("放尿経験", 2, ARG)
ELSEIF TFLAG:29 >= 3 && TEQUIP:27 && TALENT:57
	;PRINTFORML %EXPNAME:31%＋３
	;EXP:ARG:31 += 3
	CALL ADDS_EXP("放尿経験", 3, ARG)
ELSEIF TFLAG:29 >= 3 && TEQUIP:27
	;PRINTFORML %EXPNAME:31%＋２
	;EXP:ARG:31 += 2
	CALL ADDS_EXP("放尿経験", 2, ARG)
ELSEIF TFLAG:29 >= 3 && TALENT:57
	;PRINTFORML %EXPNAME:31%＋１
	;EXP:ARG:31 += 1
	CALL ADDS_EXP("放尿経験", 1, ARG)
ELSEIF TFLAG:29 >= 1 && TEQUIP:27 && TALENT:57
	;PRINTFORML %EXPNAME:31%＋２
	;EXP:ARG:31 += 2
	CALL ADDS_EXP("放尿経験", 2, ARG)
ELSEIF TFLAG:29 >= 1 && TEQUIP:27
	;PRINTFORML %EXPNAME:31%＋１
	;EXP:ARG:31 += 1
	CALL ADDS_EXP("放尿経験", 1, ARG)
ENDIF
SIF TEQUIP:27 && (TFLAG:29 >= 3 || TALENT:57)
	TEQUIP:27 = 0

;-------------------------------------------------
;刻印取得のチェック
;-------------------------------------------------
@MARK_GOT_CHECK
;-------------------------------------------------
;PainSeal
;-------------------------------------------------
IF CUP:TARGET:10 >= 2000 && CUP:TARGET:10 < 4000 && MARK:0 <= 0
	TFLAG:22 = 1
ELSEIF CUP:TARGET:10 >= 4000 && CUP:TARGET:10 < 8000 && MARK:0 <= 1
	TFLAG:22 = 2
	;気丈・感情乏しいの場合は苦痛刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:12 == 0 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF CUP:TARGET:10 >= 8000 && MARK:0 <= 2
	TFLAG:22 = 3
	;気丈・感情乏しいの場合は苦痛刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:12 == 0 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ENDIF


;-------------------------------------------------
;PleasureSeal
;-------------------------------------------------
IF TFLAG:200 == 1 && MARK:1 <= 0
	TFLAG:23 = 1
ELSEIF TFLAG:200 == 2 && MARK:1 <= 1
	TFLAG:23 = 2
ELSEIF TFLAG:200 == 3 && MARK:1 <= 2
	TFLAG:23 = 3
	;自制心・感情乏しいの場合は快楽刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:20 == 0 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ENDIF

;-------------------------------------------------
;SubmissionSeal
;-------------------------------------------------
A = CUP:TARGET:0 + CUP:TARGET:1 + CUP:TARGET:2 + CUP:TARGET:3

;快楽によるLvUPは10番+取得した屈服刻印のレベルのTFLAGを与える
IF A >= 1000 && A < 2400 && MARK:1 > MARK:2 && MARK:2 <= 0
	TFLAG:24 = 11
ELSEIF A >= 2400 && A < 6000 && MARK:1 > MARK:2 && MARK:2 <= 1
	TFLAG:24 = 12
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF A >= 6000 && MARK:1 > MARK:2 && MARK:2 <= 2
	TFLAG:24 = 13
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 <= 1 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ENDIF


A = CUP:TARGET:10 + CUP:TARGET:11

;苦痛と恐怖によるLvUPは20番+取得した屈服刻印のレベルのTFLAGを与える
IF A >= 1000 && A < 2400 && MARK:2 <= 0
	TFLAG:24 = 21
ELSEIF A >= 2400 && A < 6000 && MARK:2 <= 1
	TFLAG:24 = 22
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF A >= 6000 && MARK:2 <= 2
	TFLAG:24 = 23
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 <= 1 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ENDIF


A = CUP:TARGET:5 + CUP:TARGET:7

;恭順と屈服によるLvUPは30番+取得した屈服刻印のレベルのTFLAGを与える
IF A >= 1000 && A < 2400 && MARK:2 <= 0
	TFLAG:24 = 31
ELSEIF A >= 2400 && A < 6000 && MARK:2 <= 1
	TFLAG:24 = 32
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF A >= 6000 && MARK:2 <= 2
	TFLAG:24 = 33
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 <= 1 && TALENT:22 == 0
		TFLAG:25 = 1
	ENDIF
ENDIF

;-------------------------------------------------
;RejectionSeal
;------------------------------------------------- 
A = CUP:TARGET:12+CUP:TARGET:13
IF A >= 500 && A < 1200 && MARK:4 <= 0 && TFLAG:150 == 0
	TFLAG:21 = 1
ELSEIF A >= 1200 && A < 3000 && MARK:4 <= 1 && TFLAG:150 == 0
	TFLAG:21 = 2
	;感情乏しいの場合は反発刻印による従順ダウンはなし
	IF ABL:0 == 1 && TALENT:22 == 0
		TFLAG:25 = 1
	ELSEIF ABL:0 == 2 && TALENT:22 == 0
		TFLAG:25 = 2
	ENDIF
ELSEIF A >= 3000 && MARK:4 <= 2 && TFLAG:150 == 0
	TFLAG:21 = 3
	;感情乏しいの場合は反発刻印による従順ダウンはなし
	IF ABL:0 > 0 && ABL:0 <= 2 && TALENT:22 == 0
		TFLAG:25 = 1
	ELSEIF ABL:0 == 3 && TALENT:22 == 0
		TFLAG:25 = 2
	ENDIF
ENDIF
TFLAG:150 = 0


;-------------------------------------------------
;刻印取得の処理
;-------------------------------------------------
@MARK_GOT_RESULT
GETCOLOR
LOCAL = RESULT
IF TFLAG:21 || TFLAG:22 || TFLAG:23 || TFLAG:24
	TWAIT 1, 1
	SETCOLOR COLOR("red")
ENDIF
;------------------------------------------------- 
;PainSeal
;------------------------------------------------- 
IF TFLAG:22 == 1
	PRINTFORMW %CALLNAME:TARGET% aquired Pain Seal LV1
	;%CALLNAME:TARGET%は苦痛刻印LV1を得た
	MARK:0 = 1
ELSEIF TFLAG:22 == 2
	PRINTFORML %CALLNAME:TARGET% aquired Pain Seal LV2
	MARK:0 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW And Obedience became LV1
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:22 == 3
	PRINTFORML %CALLNAME:TARGET% aquired Pain Seal LV3
	MARK:0 = 3
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTL And Obedience became LV1
		ABL:0 = 1
	ENDIF
	IF TALENT:PLAYER:83
		CALL ADDS_ABNORMAL_EXP("Pain seal LV3（Sadist）", TARGET)
		;PRINTFORML 【%CALLNAME:PLAYER%がサド】
		;PRINTFORMW %EXPNAME:50%＋２
		;EXP:TARGET:50 += 2
	ELSEIF TALENT:PLAYER:53 && SELECTCOM == 104
		CALL ADDS_ABNORMAL_EXP("Pain seal LV3（Needle Mastery）", TARGET)
		;PRINTFORML 【%CALLNAME:PLAYER%が針さばき】
		;PRINTFORMW %EXPNAME:50%＋２
		;EXP:TARGET:50 += 2
	ELSE
		CALL ADDS_ABNORMAL_EXP("Pain seal LV3", TARGET)
;		PRINTFORMW %EXPNAME:50%＋１
;		EXP:TARGET:50 += 1
	ENDIF
ENDIF


;------------------------------------------------- 
;PleasureSeal
;------------------------------------------------- 
IF TFLAG:23 == 1
	PRINTFORMW %CALLNAME:TARGET% aquired Pleasure Seal LV1
	;%CALLNAME:TARGET%は快楽刻印LV1を得た
	MARK:1 = 1
ELSEIF TFLAG:23 == 2
	PRINTFORMW %CALLNAME:TARGET% aquired Pleasure Seal LV2
	MARK:1 = 2
ELSEIF TFLAG:23 == 3
	PRINTFORML %CALLNAME:TARGET% aquired Pleasure Seal LV3
	MARK:1 = 3
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW And Obedience became LV1
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ENDIF


;------------------------------------------------- 
;SubmissionSeal
;------------------------------------------------- 
;快楽による刻印
IF TFLAG:24 == 11
	PRINTFORMW %CALLNAME:TARGET% aquired Submission seal LV1
	;%CALLNAME:TARGET%は屈服刻印LV1を得た
	MARK:2 = 1
ELSEIF TFLAG:24 == 12
	PRINTFORML %CALLNAME:TARGET% aquired Submission seal LV2
	;%CALLNAME:TARGET%は屈服刻印LV2を得た
	MARK:2 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW And Obedience became LV1
		;そして従順がLV1になった
		ABL:0 = 1
	ENDIF
ELSEIF TFLAG:24 == 13
	PRINTFORML %CALLNAME:TARGET% aquired Submission seal LV3
	;%CALLNAME:TARGET%は屈服刻印LV3を得た
	MARK:2 = 3
	IF TFLAG:25 == 1 && ABL:0 <= 1
		PRINTW And Obedience became LV2
		;そして従順がLV2になった
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
;xPAINx、恐怖による刻印
ELSEIF TFLAG:24 == 21
	PRINTFORMW %CALLNAME:TARGET% aquired Submission seal LV1
	MARK:2 = 1
ELSEIF TFLAG:24 == 22
	PRINTFORML %CALLNAME:TARGET% aquired Submission seal LV2
	MARK:2 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW And Obedience became LV1
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:24 == 23
	PRINTFORML %CALLNAME:TARGET% aquired Submission seal LV3
	MARK:2 = 3
	IF TFLAG:25 == 1  && ABL:0 <= 1
		PRINTW And Obedience became LV2
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
;SURREN、恭順による刻印
ELSEIF TFLAG:24 == 31
	PRINTFORMW %CALLNAME:TARGET% aquired Submission seal LV1
	MARK:2 = 1
ELSEIF TFLAG:24 == 32
	PRINTFORML %CALLNAME:TARGET% aquired Submission seal LV2
	MARK:2 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW And Obedience became LV1
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:24 == 33
	PRINTFORML %CALLNAME:TARGET% aquired Submission seal LV3
	MARK:2 = 3
	IF TFLAG:25 == 1 && ABL:0 <= 1
		PRINTW And Obedience became LV2
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
ENDIF


;------------------------------------------------- 
;RejectionSeal
;------------------------------------------------- 
IF TFLAG:21 == 1
	PRINTFORMW %CALLNAME:TARGET% aquired Rejection seal LV1
	;%CALLNAME:TARGET%は反発刻印LV1を得た
	MARK:3 = 1
	MARK:4 = 1
ELSEIF TFLAG:21 == 2
	PRINTFORML %CALLNAME:TARGET% aquired Rejection seal LV2
	MARK:3 = 2
	MARK:4 = 2
	IF TFLAG:25 == 1
		PRINTW And Obedience fell to LV0
		ABL:0 = 0
	ELSEIF TFLAG:25 == 2
		PRINTW And Obedience fell to LV1
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:21 == 3
	PRINTFORML %CALLNAME:TARGET% aquired Rejection seal LV3
	MARK:3 = 3
	MARK:4 = 3
	IF TFLAG:25 == 1
		PRINTW And Obedience fell to LV0
		;そして従順がLV0に下がった
		ABL:0 = 0
	ELSEIF TFLAG:25 == 2
		PRINTW And Obedience fell to LV2
		;そして従順がLV2に下がった
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
ENDIF
SETCOLOR LOCAL
;-------------------------------------------------
;従順の上昇による[抵抗]の消滅をチェック
;-------------------------------------------------
@JUJUN_UP_CHECK
IF ABL:0 >= 3 && TALENT:34
	PRINTS NAME:TARGET
	PRINT  has lost [
	;は[
	PRINTS TALENTNAME_E(34)
	PRINTL ].
	; ]を失った
	TALENT:34 = 0
	PRINTL Denial orb gain is halfed.
	;PRINTL 否定の珠が半分になった
	JUEL:100 /= 2
ENDIF

;-------------------------------------------------
;欲望の上昇による[抑圧]の消滅をチェック
;-------------------------------------------------
@YOKUBO_UP_CHECK
IF ABL:1 >= 3 && TALENT:32
	PRINTS NAME:TARGET
	PRINT  has lost[
	PRINTS TALENTNAME_E(32)
	PRINTL ].
	TALENT:32 = 0
	PRINTL Denial orb gain is halfed.
	JUEL:100 /= 2
ENDIF

;-------------------------------------------------
;MasoEXP、ServicPlsEXPのチェック
;-------------------------------------------------
@EXP_GOT_CHECK, ARG, ARG:1
;奉仕系である、奉仕快楽のチェック
A = CUP:ARG:0+CUP:ARG:1+CUP:ARG:2+CUP:ARG:3
E = 0

IF CUP:ARG:6 < 100
	A = 0
ELSEIF CUP:ARG:6 < 300
	A *= 2
ELSEIF CUP:ARG:6 < 700
	A *= 3
ELSEIF CUP:ARG:6 < 1500
	A *= 4
ELSE
	A *= 5
ENDIF

IF TFLAG:100
	IF A >= 12000
		E = 16
		TIMES CUP:ARG:11 , 0.65
		TIMES CUP:ARG:12 , 0.30
	ELSEIF A >= 8000
		E = 12
		TIMES CUP:ARG:11 , 0.70
		TIMES CUP:ARG:12 , 0.40
	ELSEIF A >= 5000
		E = 8
		TIMES CUP:ARG:11 , 0.75
		TIMES CUP:ARG:12 , 0.50
	ELSEIF A >= 3000
		E = 4
		TIMES CUP:ARG:11 , 0.80
		TIMES CUP:ARG:12 , 0.60
	ELSEIF A >= 2000
		E = 2
		TIMES CUP:ARG:11 , 0.85
		TIMES CUP:ARG:12 , 0.70
	ELSEIF A >= 1000
		E = 1
		TIMES CUP:ARG:11 , 0.90
		TIMES CUP:ARG:12 , 0.80
	ENDIF
	SIF ARG == PLAYER
		TIMES E , 0.20
	IF E
;		PRINT ServicPlsEXP+
;		PRINTVL E
;		EXP:ARG:21 += E
;		TFLAG:26 = E
		IF TEQUIP:ARG:主導権 == 0 || ((TALENT:ARG:恋慕 || TALENT:ARG:親愛) && ARG:1 == MASTER)
			CALL ADDS_EXP("奉仕快楽経験", E, ARG)
		ELSE
			CALL ADDS_EXP("嗜虐快楽経験", E * (ABL:ARG:サドっ気/2 + 1) / 5, ARG)
		ENDIF
	ENDIF
ENDIF

;苦痛快楽のチェック
E = 0
IF CUP:ARG:6 >= 3000 && CUP:ARG:10 >= 2000
	E = 16
	TIMES CUP:ARG:11 , 0.65
ELSEIF CUP:ARG:6 >= 2500 && CUP:ARG:10 >= 1500
	E = 12
	TIMES CUP:ARG:11 , 0.70
ELSEIF CUP:ARG:6 >= 1500 && CUP:ARG:10 >= 1000
	E = 8
	TIMES CUP:ARG:11 , 0.75
ELSEIF CUP:ARG:6 >= 1000 && CUP:ARG:10 >= 500
	E = 4
	TIMES CUP:ARG:11 , 0.80
ELSEIF CUP:ARG:6 >= 600 && CUP:ARG:10 >= 300
	E = 2
	TIMES CUP:ARG:11 , 0.85
ELSEIF CUP:ARG:6 >= 300 && CUP:ARG:10 >= 100
	E = 1
	TIMES CUP:ARG:11 , 0.90
ENDIF
IF E > 0
;	PRINT MasoEXP+
	;PRINTVL E
	;EXP:ARG:30 += E
	;TFLAG:27 = E
	CALL ADDS_EXP("苦痛快楽経験", E, ARG)
	;SadoEXP
	E = ABL:(ARG:1):10+ABL:ARG:9
	E -= 1
	IF E > 0
;		PRINTFORM %CALLNAME:(ARG:1)%の
;		PRINT SadoEXP+
;		PRINTVL E
;		EXP:(ARG:1):32 += E
;		TFLAG:28 = E
		CALL ADDS_EXP("嗜虐快楽経験", E, ARG:1)
	ENDIF
ENDIF


