@SOURCE_CHECK
#DIM CHARA, 2
#DIM PCOUNT, 2
#DIM 絶頂数 , 1
CHARA = TARGET
CHARA:1 = PLAYER

;-------------------------------------------------
;バイブなど付けっぱなしアイテムのチェック
;-------------------------------------------------
CALL EQUIP_CHECK

;-------------------------------------------------
;主人、同性、調教者の能力の処理
;-------------------------------------------------
CALL SOURCE_SEX_CHECK, TARGET, PLAYER
CALL SOURCE_SEX_CHECK, PLAYER, TARGET
CALL PLAYER_SKILL_CHECK, TARGET, PLAYER
CALL PLAYER_SKILL_CHECK, PLAYER, TARGET

;-------------------------------------------------
;処女喪失の処理
;-------------------------------------------------
CALL LOST_VIRGIN

;-------------------------------------------------
;依存度チェック
;-------------------------------------------------
CALL MASTER_DEPENDENCE_CHECK


;-------------------------------------------------
;技巧のチェック(ARGが行為者、ARG:1が被行為者)
;-------------------------------------------------
;行為者の判定(1が立つ時、TARGET→PLAYER、2が立つ時、PLAYER→TARGET)
;TFLAG:28はSadoEXPの記録としても使われている…
SIF TFLAG:28 & 1
	CALL TECHNIQUE_CHECK, CHARA, CHARA:1
SIF TFLAG:28 & 2
	CALL TECHNIQUE_CHECK, CHARA:1, CHARA
SIF TFLAG:28 & 4
	CALL TECHNIQUE_CHECK, CHARA, CHARA
SIF TFLAG:28 & 8
	CALL TECHNIQUE_CHECK, CHARA:1, CHARA:1

;暫定での手抜き追加処理
DOWNBASE:CHARA:体力 += LOSEBASE:体力
DOWNBASE:CHARA:気力 += LOSEBASE:気力
LOSEBASE:体力 = 0
LOSEBASE:気力 = 0
FOR LOCAL,0,VARSIZE("PALAM")
	CUP:TARGET:LOCAL += UP:LOCAL
	CDOWN:TARGET:LOCAL += DOWN:LOCAL
	UP:LOCAL = 0
	DOWN:LOCAL = 0
NEXT
;ここまででPLAYERの同性の中毒充足など処理されないソースが入ってる可能性があるのでとりあえず消しておく
FOR LOCAL, 4, VARSIZE("SOURCE")
	SIF GROUPMATCH(LOCAL , 7 , 11 , 20 , 21 , 22 , 23)
		CONTINUE
	SOURCE:PLAYER:LOCAL = 0
NEXT
;-------------------------------------------------
;調教者のソースチェック
;-------------------------------------------------
;CALL SOURCE_CHECK_PLAYER
FOR PCOUNT, 0, 2
	IF PCOUNT == 1
		CHARA = PLAYER
		CHARA:1 = TARGET
	ENDIF
	
	SOURCE:CHARA:快Ｃ += SOURCE:CHARA:道具快Ｃ
	SOURCE:CHARA:道具快Ｃ = 0
	SOURCE:CHARA:快Ｖ += SOURCE:CHARA:道具快Ｖ
	SOURCE:CHARA:道具快Ｖ = 0
	SOURCE:CHARA:快Ａ += SOURCE:CHARA:道具快Ａ
	SOURCE:CHARA:道具快Ａ = 0
	SOURCE:CHARA:快Ｂ += SOURCE:CHARA:道具快Ｂ
	SOURCE:CHARA:道具快Ｂ = 0
	
	
	;-------------------------------------------------
	;発情中のソースチェック
	;-------------------------------------------------
	IF 危険日(CHARA) > 1
		TIMES SOURCE:CHARA:快Ｃ , 1.50
		TIMES SOURCE:CHARA:快Ｖ , 1.50
		TIMES SOURCE:CHARA:快Ａ , 1.50
		TIMES SOURCE:CHARA:快Ｂ , 1.50
	ENDIF
	;相性による修正
	SOURCE:CHARA:快Ｃ *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:快Ｃ /= 100

	SOURCE:CHARA:快Ｖ *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:快Ｖ /= 100

	SOURCE:CHARA:快Ａ *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:快Ａ /= 100

	SOURCE:CHARA:快Ｂ *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:快Ｂ /= 100

	SOURCE:CHARA:情愛 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:情愛 /= 100

	SOURCE:CHARA:性行動 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:性行動 /= 100

	SOURCE:CHARA:達成 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:達成 /= 100

	SOURCE:CHARA:恐れ *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:恐れ /= 100

	SOURCE:CHARA:中毒充足 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:中毒充足 /= 100

	SOURCE:CHARA:欲情 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:欲情 /= 100

	SOURCE:CHARA:恭順 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:恭順 /= 100

	SOURCE:CHARA:屈従 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
	SOURCE:CHARA:屈従 /= 100
	;-------------------------------------------------
	;ＣPleasureのソース
	;-------------------------------------------------
	;ＣSensitiveとＣInsensitiveはここで処理
	SIF TALENT:CHARA:Ｃ鈍感
		TIMES SOURCE:CHARA:快Ｃ , 0.50
	SIF TALENT:CHARA:Ｃ敏感
		TIMES SOURCE:CHARA:快Ｃ , 2.00


	;忠誠度による修正
	;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
	;SOURCE:CHARA:快Ｃ *= LOCAL
	;SOURCE:CHARA:快Ｃ /= 500

	;C感覚
	SELECTCASE ABL:CHARA:3
		CASE  0
			TIMES SOURCE:CHARA:快Ｃ , 0.50
		CASE  1
			TIMES SOURCE:CHARA:快Ｃ , 1.80
		CASE  2
			TIMES SOURCE:CHARA:快Ｃ , 3.00
		CASE  3
			TIMES SOURCE:CHARA:快Ｃ , 5.00
		CASE  4
			TIMES SOURCE:CHARA:快Ｃ , 7.00
		CASE  5
			TIMES SOURCE:CHARA:快Ｃ , 9.00
		CASE  6
			TIMES SOURCE:CHARA:快Ｃ , 11.00
		CASE  7
			TIMES SOURCE:CHARA:快Ｃ , 13.00
		CASE  8
			TIMES SOURCE:CHARA:快Ｃ , 15.00
		CASE  9
			TIMES SOURCE:CHARA:快Ｃ , 17.00
		CASE 10
			TIMES SOURCE:CHARA:快Ｃ , 20.00
		CASEELSE
			SOURCE:CHARA:快Ｃ = SOURCE:CHARA:快Ｃ * 50 * (ABL:CHARA:3 - 6) / 10
	ENDSELECT
	LOCAL = SOURCE:CHARA:快Ｃ

	;PALAM:欲情をみる
	IF PALAM:CHARA:欲情 < PALAMLV:1
		TIMES LOCAL , 0.80
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:3
		TIMES LOCAL , 1.20
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:4
		TIMES LOCAL , 1.50
	ELSEIF PALAM:CHARA:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.80
	ENDIF

	LOCAL:1 = SOURCE:CHARA:快Ｃ

	;ABL:欲望をみる
	SELECTCASE ABL:CHARA:欲望
		CASE 0
			TIMES LOCAL:1 , 0.50
		CASE 1
			TIMES LOCAL:1 , 0.60
		CASE 2
			TIMES LOCAL:1 , 0.70
		CASE 3
			TIMES LOCAL:1 , 0.80
		CASE 4
			TIMES LOCAL:1 , 0.90
		CASE 5
			TIMES LOCAL:1 , 1.00
		CASE 6
			TIMES LOCAL:1 , 1.05
		CASE 7
			TIMES LOCAL:1 , 1.10
		CASE 8
			TIMES LOCAL:1 , 1.15
		CASE 9
			TIMES LOCAL:1 , 1.20
		CASE 10
			TIMES LOCAL:1 , 1.40
		CASEELSE
			LOCAL:1 = LOCAL:1 * (20 * ABL:CHARA:欲望 - 60) / 100
	ENDSELECT
	CUP:CHARA:快Ｃ += LOCAL
	CUP:CHARA:欲情 += LOCAL:1

	;-------------------------------------------------
	;快Ｖのソース
	;-------------------------------------------------
	;ＶSensitiveとＶInsensitiveはここで処理
	SIF TALENT:CHARA:Ｖ鈍感
		TIMES SOURCE:CHARA:快Ｖ , 0.50
	SIF TALENT:CHARA:Ｖ敏感
		TIMES SOURCE:CHARA:快Ｖ , 2.00

	;忠誠度による修正
	;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
	;SOURCE:CHARA:快Ｖ *= LOCAL
	;SOURCE:CHARA:快Ｖ /= 500

	;V感覚
	SELECTCASE ABL:CHARA:Ｖ感覚
		CASE 0
			TIMES SOURCE:CHARA:快Ｖ , 0.50
		CASE 1
			TIMES SOURCE:CHARA:快Ｖ , 1.80
		CASE 2
			TIMES SOURCE:CHARA:快Ｖ , 3.00
		CASE 3
			TIMES SOURCE:CHARA:快Ｖ , 5.00
		CASE 4
			TIMES SOURCE:CHARA:快Ｖ , 7.00
		CASE 5
			TIMES SOURCE:CHARA:快Ｖ , 9.00
		CASE 6
			TIMES SOURCE:CHARA:快Ｖ , 11.00
		CASE 7
			TIMES SOURCE:CHARA:快Ｖ , 13.00
		CASE 8
			TIMES SOURCE:CHARA:快Ｖ , 15.00
		CASE 9
			TIMES SOURCE:CHARA:快Ｖ , 17.00
		CASE 10
			TIMES SOURCE:CHARA:快Ｖ , 20.00
		CASEELSE
			SOURCE:CHARA:快Ｖ = SOURCE:CHARA:快Ｖ * 50 * (ABL:CHARA:Ｖ感覚 - 6) / 10
	ENDSELECT
	;EXP:CHARA:Ｖ経験をみる
	IF EXP:CHARA:0 < EXPLV:1
		TIMES SOURCE:CHARA:快Ｖ , 0.20
	ELSEIF EXP:CHARA:0 < EXPLV:2
		TIMES SOURCE:CHARA:快Ｖ , 0.60
	ELSEIF EXP:CHARA:0 < EXPLV:3
		TIMES SOURCE:CHARA:快Ｖ , 1.00
	ELSEIF EXP:CHARA:0 < EXPLV:4
		TIMES SOURCE:CHARA:快Ｖ , 1.20
	ELSEIF EXP:CHARA:0 < EXPLV:5
		TIMES SOURCE:CHARA:快Ｖ , 1.30
	ELSEIF EXP:CHARA:0 >= EXPLV:5
		TIMES SOURCE:CHARA:快Ｖ , 1.40
	ENDIF


	;PALAM:潤滑をみる
	IF PALAM:CHARA:潤滑 < PALAMLV:1
		TIMES SOURCE:CHARA:快Ｖ , 0.10
	ELSEIF PALAM:CHARA:潤滑 < PALAMLV:2
		TIMES SOURCE:CHARA:快Ｖ , 0.40
	ELSEIF PALAM:CHARA:潤滑 < PALAMLV:3
		TIMES SOURCE:CHARA:快Ｖ , 1.00
	ELSEIF PALAM:CHARA:潤滑 < PALAMLV:4
		TIMES SOURCE:CHARA:快Ｖ , 1.10
	ELSEIF PALAM:CHARA:潤滑 >= PALAMLV:4
		TIMES SOURCE:CHARA:快Ｖ , 1.20
	ENDIF
	LOCAL = SOURCE:CHARA:快Ｖ

	;PALAM:欲情をみる
	IF PALAM:CHARA:欲情 < PALAMLV:1
		TIMES LOCAL , 0.60
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:2
		TIMES LOCAL , 0.80
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:3
		TIMES LOCAL , 1.00
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:4
		TIMES LOCAL , 1.50
	ELSEIF PALAM:CHARA:欲情 >= PALAMLV:4
		TIMES LOCAL , 2.00
	ENDIF

	LOCAL:1 = SOURCE:CHARA:快Ｖ

	;ABL:欲望をみる
	SELECTCASE ABL:CHARA:欲望
		CASE 0
			TIMES LOCAL:1 , 0.50
		CASE 1
			TIMES LOCAL:1 , 0.60
		CASE 2
			TIMES LOCAL:1 , 0.70
		CASE 3
			TIMES LOCAL:1 , 0.80
		CASE 4
			TIMES LOCAL:1 , 0.90
		CASE 5
			TIMES LOCAL:1 , 1.00
		CASE 6
			TIMES LOCAL:1 , 1.05
		CASE 7
			TIMES LOCAL:1 , 1.10
		CASE 8
			TIMES LOCAL:1 , 1.15
		CASE 9
			TIMES LOCAL:1 , 1.20
		CASE 10
			TIMES LOCAL:1 , 1.40
		CASEELSE
			LOCAL:1 = LOCAL:1 * (20 * ABL:CHARA:欲望 - 60) / 100
	ENDSELECT
	;小人体型
	IF TALENT:CHARA:小人体型
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 1.20
		CUP:CHARA:習得 += LOCAL:1/2
	ENDIF

	CUP:CHARA:快Ｖ += LOCAL
	CUP:CHARA:欲情 += LOCAL:1

	;-------------------------------------------------
	;快Ａのソース
	;-------------------------------------------------
	;ＡSensitiveとＡInsensitiveはここで処理
	SIF TALENT:CHARA:105
		TIMES SOURCE:CHARA:快Ａ , 0.50
	SIF TALENT:CHARA:106
		TIMES SOURCE:CHARA:快Ａ , 2.00

	;男の娘
	SIF TALENT:CHARA:男の娘
		TIMES SOURCE:CHARA:快Ａ , 1.50

	;忠誠度による修正
	;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
	;SOURCE:CHARA:快Ａ *= LOCAL
	;SOURCE:CHARA:快Ａ /= 500

	;A感覚
	SELECTCASE ABL:CHARA:Ａ感覚
		CASE 0
			TIMES SOURCE:CHARA:快Ａ , 0.50
		CASE 1
			TIMES SOURCE:CHARA:快Ａ , 1.80
		CASE 2
			TIMES SOURCE:CHARA:快Ａ , 3.00
		CASE 3
			TIMES SOURCE:CHARA:快Ａ , 5.00
		CASE 4
			TIMES SOURCE:CHARA:快Ａ , 7.00
		CASE 5
			TIMES SOURCE:CHARA:快Ａ , 9.00
		CASE 6
			TIMES SOURCE:CHARA:快Ａ , 11.00
		CASE 7
			TIMES SOURCE:CHARA:快Ａ , 13.00
		CASE 8
			TIMES SOURCE:CHARA:快Ａ , 15.00
		CASE 9
			TIMES SOURCE:CHARA:快Ａ , 17.00
		CASE 10
			TIMES SOURCE:CHARA:快Ａ , 20.00
		CASEELSE
			SOURCE:CHARA:快Ａ = SOURCE:CHARA:快Ａ * 50 * (ABL:CHARA:Ａ感覚 - 6) / 10
	ENDSELECT

	;EXP:CHARA:Ａ経験をみる
	IF EXP:CHARA:1 < EXPLV:1
		TIMES SOURCE:CHARA:快Ａ , 0.10
	ELSEIF EXP:CHARA:1 < EXPLV:2
		TIMES SOURCE:CHARA:快Ａ , 0.30
	ELSEIF EXP:CHARA:1 < EXPLV:3
		TIMES SOURCE:CHARA:快Ａ , 0.50
	ELSEIF EXP:CHARA:1 < EXPLV:4
		TIMES SOURCE:CHARA:快Ａ , 1.00
	ELSEIF EXP:CHARA:1 < EXPLV:5
		TIMES SOURCE:CHARA:快Ａ , 1.20
	ELSEIF EXP:CHARA:1 >= EXPLV:5
		TIMES SOURCE:CHARA:快Ａ , 1.40
	ENDIF

	;PALAM:潤滑をみる
	IF PALAM:CHARA:潤滑 < PALAMLV:1
		TIMES SOURCE:CHARA:快Ａ , 0.40
	ELSEIF PALAM:CHARA:潤滑 < PALAMLV:2
		TIMES SOURCE:CHARA:快Ａ , 0.80
	ELSEIF PALAM:CHARA:潤滑 < PALAMLV:3
		TIMES SOURCE:CHARA:快Ａ , 1.00
	ELSEIF PALAM:CHARA:潤滑 < PALAMLV:4
		TIMES SOURCE:CHARA:快Ａ , 1.10
	ELSEIF PALAM:CHARA:潤滑 >= PALAMLV:4
		TIMES SOURCE:CHARA:快Ａ , 1.20
	ENDIF

	LOCAL = SOURCE:CHARA:快Ａ

	;PALAM:欲情をみる
	;快ＡはあまりPALAM:欲情では差が出ない
	IF PALAM:CHARA:欲情 < PALAMLV:1
		TIMES LOCAL , 0.80
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:3
		TIMES LOCAL , 1.20
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:4
		TIMES LOCAL , 1.40
	ELSEIF PALAM:CHARA:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.60
	ENDIF


	LOCAL:1 = SOURCE:CHARA:快Ａ

	;ABL:欲望をみる
	SELECTCASE ABL:CHARA:欲望
		CASE 0
			TIMES LOCAL:1 , 0.50
		CASE 1
			TIMES LOCAL:1 , 0.60
		CASE 2
			TIMES LOCAL:1 , 0.70
		CASE 3
			TIMES LOCAL:1 , 0.80
		CASE 4
			TIMES LOCAL:1 , 0.90
		CASE 5
			TIMES LOCAL:1 , 1.00
		CASE 6
			TIMES LOCAL:1 , 1.05
		CASE 7
			TIMES LOCAL:1 , 1.10
		CASE 8
			TIMES LOCAL:1 , 1.15
		CASE 9
			TIMES LOCAL:1 , 1.20
		CASE 10
			TIMES LOCAL:1 , 1.40
		CASEELSE
			LOCAL:1 = LOCAL:1 * (20 * ABL:CHARA:欲望 - 60) / 100
	ENDSELECT

	;小人体型
	IF TALENT:CHARA:小人体型
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.50
	ENDIF



	;快Aのソースが0以上で処女で貞操観念のとき、屈服のソースを三分の一にする
	IF EXP:CHARA:0 == 0 && TALENT:CHARA:30 && SOURCE:CHARA:快Ａ > 0
		SOURCE:CHARA:屈従 /= 3
	ENDIF

	CUP:CHARA:快Ａ += LOCAL
	CUP:CHARA:欲情 += LOCAL:1

	;-------------------------------------------------
	;快Ｂのソース
	;-------------------------------------------------
	;ＢSensitiveとＢInsensitiveはここで処理
	SIF TALENT:CHARA:107
		TIMES SOURCE:CHARA:快Ｂ , 0.50
	SIF TALENT:CHARA:108
		TIMES SOURCE:CHARA:快Ｂ , 2.00

	;男の娘
	SIF TALENT:CHARA:男の娘
		TIMES SOURCE:CHARA:快Ｂ , 1.50

	;忠誠度による修正
	;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
	;SOURCE:CHARA:快Ｂ *= LOCAL
	;SOURCE:CHARA:快Ｂ /= 500





	;B感覚
	SELECTCASE ABL:CHARA:Ｂ感覚
		CASE  0
			TIMES SOURCE:CHARA:快Ｂ , 0.50
		CASE  1
			TIMES SOURCE:CHARA:快Ｂ , 1.80
		CASE  2
			TIMES SOURCE:CHARA:快Ｂ , 3.00
		CASE  3
			TIMES SOURCE:CHARA:快Ｂ , 5.00
		CASE  4
			TIMES SOURCE:CHARA:快Ｂ , 7.00
		CASE  5
			TIMES SOURCE:CHARA:快Ｂ , 9.00
		CASE  6
			TIMES SOURCE:CHARA:快Ｂ , 11.00
		CASE  7
			TIMES SOURCE:CHARA:快Ｂ , 13.00
		CASE  8
			TIMES SOURCE:CHARA:快Ｂ , 15.00
		CASE  9
			TIMES SOURCE:CHARA:快Ｂ , 17.00
		CASE 10
			TIMES SOURCE:CHARA:快Ｂ , 20.00
		CASEELSE
			SOURCE:CHARA:快Ｂ = SOURCE:CHARA:快Ｂ * 50 * (ABL:CHARA:Ｂ感覚 - 6) / 10
	ENDSELECT
	LOCAL = SOURCE:CHARA:快Ｂ

	;PALAM:欲情をみる
	IF PALAM:CHARA:欲情 < PALAMLV:1
		TIMES LOCAL , 0.80
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:3
		TIMES LOCAL , 1.20
	ELSEIF PALAM:CHARA:欲情 < PALAMLV:4
		TIMES LOCAL , 1.50
	ELSEIF PALAM:CHARA:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.80
	ENDIF

	LOCAL:1 = SOURCE:CHARA:快Ｂ

	;ABL:欲望をみる
	SELECTCASE ABL:CHARA:欲望
		CASE 0
			TIMES LOCAL:1 , 0.50
		CASE 1
			TIMES LOCAL:1 , 0.60
		CASE 2
			TIMES LOCAL:1 , 0.70
		CASE 3
			TIMES LOCAL:1 , 0.80
		CASE 4
			TIMES LOCAL:1 , 0.90
		CASE 5
			TIMES LOCAL:1 , 1.00
		CASE 6
			TIMES LOCAL:1 , 1.05
		CASE 7
			TIMES LOCAL:1 , 1.10
		CASE 8
			TIMES LOCAL:1 , 1.15
		CASE 9
			TIMES LOCAL:1 , 1.20
		CASE 10
			TIMES LOCAL:1 , 1.40
		CASEELSE
			LOCAL:1 = LOCAL:1 * (20 * ABL:CHARA:欲望 - 60) / 100
	ENDSELECT

	CUP:CHARA:快Ｂ += LOCAL
	CUP:CHARA:欲情 += LOCAL:1

	;-------------------------------------------------
	;同じコマンドの連続実行による上下の処理（快楽系）
	;-------------------------------------------------
	IF SELECTCOM == PREVCOM
		;CUP:CHARA:快ＣＶＡＢは絶頂に絡むので先に処理してある
		CUP:CHARA:快Ｃ /= 2
		CUP:CHARA:快Ｖ /= 2
		CUP:CHARA:快Ａ /= 2
		CUP:CHARA:快Ｂ /= 2
	ENDIF

	;-------------------------------------------------
	;気力０による上下の処理（快楽系）
	;-------------------------------------------------
	IF BASE:CHARA:気力 <= 0
		;CUP:CHARA:快ＣＶＡＢは絶頂に絡むので先に処理してある
		CUP:CHARA:快Ｃ /= 2
		CUP:CHARA:快Ｖ /= 2
		CUP:CHARA:快Ａ /= 2
		CUP:CHARA:快Ｂ /= 2
	ENDIF

	;-------------------------------------------------
	;相性による上下の処理（快楽系）
	;-------------------------------------------------
	;R = NO:PLAYER
	;IF RELATION:R != 0
	;	CUP:CHARA:快Ｃ *= RELATION:R
	;	CUP:CHARA:快Ｃ /= 100
	;	CUP:CHARA:快Ｖ *= RELATION:R
	;	CUP:CHARA:快Ｖ /= 100
	;	CUP:CHARA:快Ａ *= RELATION:R
	;	CUP:CHARA:快Ａ /= 100
	;	CUP:CHARA:快Ｂ *= RELATION:R
	;	CUP:CHARA:快Ｂ /= 100
	;ENDIF

	;-------------------------------------------------
	;快感の否定は、快ソースの数値に応じて、抑鬱増加（淫乱、娼婦で無効）
	;-------------------------------------------------
	SIF TALENT:CHARA:71 && (TALENT:CHARA:4 == 0 && TALENT:CHARA:7 == 0)
		SOURCE:CHARA:鬱屈 += (CUP:CHARA:快Ｃ+UP:1+CUP:CHARA:快Ａ+CUP:CHARA:快Ｂ)/10

	;-------------------------------------------------
	;素質などによる上下の処理（快楽系）
	;-------------------------------------------------
	;媚薬
	IF TEQUIP:CHARA:Aphrodisiac
		TIMES CUP:CHARA:快Ｃ , 2.00
		TIMES CUP:CHARA:快Ｖ , 2.00
		TIMES CUP:CHARA:快Ａ , 2.00
		TIMES CUP:CHARA:快Ｂ , 2.00
	ENDIF

	;利尿剤
	IF TEQUIP:CHARA:Diuretic
		TIMES CUP:CHARA:快Ｃ , 0.70
		TIMES CUP:CHARA:快Ｖ , 0.70
		TIMES CUP:CHARA:快Ａ , 0.70
		TIMES CUP:CHARA:快Ｂ , 0.70
	ENDIF

	;-------------------------------------------------
	;陥落素質
	;-------------------------------------------------
	;淫乱
	IF TALENT:CHARA:淫乱
		TIMES CUP:CHARA:快Ｃ , 1.20
		TIMES CUP:CHARA:快Ｖ , 1.20
		TIMES CUP:CHARA:快Ａ , 1.20
		TIMES CUP:CHARA:快Ｂ , 1.20
	ENDIF

	;娼婦
	IF TALENT:CHARA:娼婦
		TIMES CUP:CHARA:快Ｃ , 1.50
		TIMES CUP:CHARA:快Ｖ , 1.50
		TIMES CUP:CHARA:快Ａ , 1.50
		TIMES CUP:CHARA:快Ｂ , 1.50
	ENDIF

	;-------------------------------------------------
	;素質
	;-------------------------------------------------
	;自制心
	IF TALENT:CHARA:20
		TIMES CUP:CHARA:快Ｃ , 0.70
		TIMES CUP:CHARA:快Ｖ , 0.90
		TIMES CUP:CHARA:快Ａ , 1.00
		TIMES CUP:CHARA:快Ｂ , 0.70
	ENDIF

	;即落ち
	IF TALENT:CHARA:73
		TIMES CUP:CHARA:快Ｃ , 2.00
		TIMES CUP:CHARA:快Ｖ , 2.00
		TIMES CUP:CHARA:快Ａ , 2.00
		TIMES CUP:CHARA:快Ｂ , 2.00
	ENDIF
	;自慰狂い
	SIF TALENT:CHARA:74
		TIMES CUP:CHARA:快Ｃ , 1.20
	;セックス狂い
	SIF TALENT:CHARA:75
		TIMES CUP:CHARA:快Ｖ , 1.20
	;尻穴狂い
	SIF TALENT:CHARA:76
		TIMES CUP:CHARA:快Ａ , 1.20
	;淫乳
	SIF TALENT:CHARA:77
		TIMES CUP:CHARA:快Ｂ , 1.20

	;オトコ
	IF IS_MALE(TARGET)
		TIMES CUP:CHARA:快Ａ , 1.30
	ENDIF

	;-------------------------------------------------
	;難易度による上下の処理（快楽系）
	;-------------------------------------------------
	;EASY
	IF FLAG:4 == 1
		TIMES CUP:CHARA:快Ｃ , 1.60
		TIMES CUP:CHARA:快Ｖ , 1.60
		TIMES CUP:CHARA:快Ａ , 1.60
		TIMES CUP:CHARA:快Ｂ , 1.60
	;NORMAL
	ELSEIF FLAG:4 == 2
		TIMES CUP:CHARA:快Ｃ , 1.20
		TIMES CUP:CHARA:快Ｖ , 1.20
		TIMES CUP:CHARA:快Ａ , 1.20
		TIMES CUP:CHARA:快Ｂ , 1.20
	;HARD
	ELSEIF FLAG:4 == 3
		TIMES CUP:CHARA:快Ｃ , 0.80
		TIMES CUP:CHARA:快Ｖ , 0.80
		TIMES CUP:CHARA:快Ａ , 0.80
		TIMES CUP:CHARA:快Ｂ , 0.80
	ENDIF


	;指挿入れの慣らしギミック用処理、V経験が0の時は快Vは99で最大にする
	LOCAL = CUP:CHARA:快Ｖ + PALAM:CHARA:快Ｖ
	IF LOCAL >= 100 && EXP:CHARA:0 == 0
		CUP:CHARA:快Ｖ = 0
		PALAM:CHARA:快Ｖ = 99
	ENDIF

	;-------------------------------------------------
	;愛液処理
	;-------------------------------------------------
	LOCAL = CUP:CHARA:快Ｃ + CUP:CHARA:快Ｖ + CUP:CHARA:快Ａ + CUP:CHARA:快Ｂ
	;FEELＣ＋FEELＶ＋FEELＡ＋快Ｂが合わせて100以上上昇ならその20%の液体のソースが加わる（オトコはダメ）
	IF LOCAL > 100
		;濡れやすいと濡れにくいはここで処理
		SIF TALENT:CHARA:42
			TIMES LOCAL , 3.00
		SIF TALENT:CHARA:43
			TIMES LOCAL , 0.40
		CUP:CHARA:潤滑 += LOCAL / 5
	ENDIF
	;-------------------------------------------------
	;強精神薬による絶頂キャンセル
	;-------------------------------------------------
	IF TEQUIP:CHARA:強精神薬 > 1
		CALL ECST_CANCEL, CHARA
	;-------------------------------------------------
	;絶頂処理
	;-------------------------------------------------
	ELSE
		CALL ORGASM_ADD, CHARA
	ENDIF

	;-------------------------------------------------
	;液体のソース
	;-------------------------------------------------
	LOCAL = SOURCE:CHARA:液体

	;小人体型
	IF TALENT:CHARA:小人体型 == 0 && TALENT:(CHARA:1):小人体型
		SIF SELECTCOM != 180
			TIMES SOURCE:CHARA:液体 , 0.40
	ENDIF

	CUP:CHARA:潤滑 += SOURCE:CHARA:液体

	;-------------------------------------------------
	;欲情のソース
	;-------------------------------------------------

	;忠誠度による修正
	;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))

	;SOURCE:CHARA:欲情 *= LOCAL
	;SOURCE:CHARA:欲情 /= 500

	LOCAL = SOURCE:CHARA:欲情

	;欲望を見る
	SELECTCASE ABL:CHARA:欲望
		CASE 0
			TIMES LOCAL , 0.00
		CASE 1
			TIMES LOCAL , 0.40
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 1.20
		CASE 4
			TIMES LOCAL , 1.60
		CASE 5
			TIMES LOCAL , 2.00
		CASE 6
			TIMES LOCAL , 2.40
		CASE 7
			TIMES LOCAL , 2.80
		CASE 8
			TIMES LOCAL , 3.20
		CASE 9
			TIMES LOCAL , 3.60
		CASE 10
			TIMES LOCAL , 5.00
		CASEELSE
			LOCAL = LOCAL * (ABL:CHARA:欲望 * 15 - 100) / 10
	ENDSELECT
	CUP:CHARA:欲情 += LOCAL
	;-------------------------------------------------
	;痛みのソース
	;-------------------------------------------------
	LOCAL = SOURCE:CHARA:痛み
	LOCAL:1 = SOURCE:CHARA:痛み
	LOCAL:2 = SOURCE:CHARA:痛み/20


	;忠誠度による修正
	;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
	;B *= LOCAL
	;B /= 500

	;相性による修正
	IF CHARA == TARGET
		LOCAL:1 *= LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/4 , 75, 125)
		LOCAL:1 /= 100
	ENDIF


	;Masochism
	SELECTCASE ABL:CHARA:マゾっ気
		CASE 0
			TIMES LOCAL:1 , 0.00
		CASE 1
			TIMES LOCAL:1 , 0.10
		CASE 2
			TIMES LOCAL:1 , 0.20
		CASE 3
			TIMES LOCAL:1 , 0.30
		CASE 4
			TIMES LOCAL:1 , 0.45
		CASE 5
			TIMES LOCAL:1 , 0.60
		CASE 6
			TIMES LOCAL:1 , 0.75
		CASE 7
			TIMES LOCAL:1 , 0.90
		CASE 8
			TIMES LOCAL:1 , 1.20
		CASE 9
			TIMES LOCAL:1 , 1.50
		CASE 10
			TIMES LOCAL:1 , 3.00
		CASEELSE
			LOCAL:1 = LOCAL:1 * (ABL:CHARA:マゾっ気 * 30) / 100
	ENDSELECT
	;小人体型
	IF TALENT:CHARA:小人体型
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 0.75
	ENDIF

	;調教者が【Sadist】
	SIF TALENT:PLAYER:83 && TARGET == CHARA
		TIMES LOCAL:1 , 2.50

	;臆病
	SIF TALENT:CHARA:10
		TIMES LOCAL:2 , 2.00

	;マゾっ気があるとPALAM:欲情も上がる
	;そのとき調教者が【Sadist】だと効果的
	;苦痛に応じて恐怖のソースが増加する
	CUP:CHARA:苦痛 += LOCAL
	CUP:CHARA:欲情 += LOCAL:1
	CUP:CHARA:恐怖 += LOCAL:2

NEXT
CHARA = TARGET
CHARA:1 = PLAYER

;-------------------------------------------------
;調教対象の射精チェック（ふたなり・オトコ）
;-------------------------------------------------
CALL TARGET_EJAC_CHECK
;-------------------------------------------------
;主人・助手の射精チェック（ふたなり・オトコ）
;-------------------------------------------------
CALL EJAC_CHECK , MASTER
SIF ASSI > -1
	CALL EJAC_CHECK , ASSI
;-------------------------------------------------
;噴乳チェック
;-------------------------------------------------
CALL MILK_CHECK, CHARA, CHARA:1
CALL MILK_CHECK, CHARA:1, CHARA

;-------------------------------------------------
;情愛のソース
;-------------------------------------------------

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))

;SOURCE:CHARA:情愛 *= LOCAL
;SOURCE:CHARA:情愛 /= 500

LOCAL = SOURCE:CHARA:情愛

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 0.10
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 5.00
	CASE 10
		TIMES LOCAL , 6.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:従順 - 4)
ENDSELECT
LOCAL:1 = SOURCE:CHARA:情愛

;欲望を見る
SELECTCASE ABL:CHARA:欲望
	CASE 0
		TIMES LOCAL:1 , 0.00
	CASE 1
		TIMES LOCAL:1 , 0.40
	CASE 2
		TIMES LOCAL:1 , 0.80
	CASE 3
		TIMES LOCAL:1 , 1.20
	CASE 4
		TIMES LOCAL:1 , 1.60
	CASE 5
		TIMES LOCAL:1 , 2.00
	CASE 6
		TIMES LOCAL:1 , 2.40
	CASE 7
		TIMES LOCAL:1 , 2.80
	CASE 8
		TIMES LOCAL:1 , 3.20
	CASE 9
		TIMES LOCAL:1 , 3.60
	CASE 10
		TIMES LOCAL:1 , 5.00
	CASEELSE
		LOCAL:1 = LOCAL:1 * ABL:CHARA:欲望 * 50 / 100
ENDSELECT
CUP:CHARA:恭順 += LOCAL
CUP:CHARA:欲情 += LOCAL:1

;-------------------------------------------------
;性行動のソース
;-------------------------------------------------

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
;SOURCE:CHARA:性行動 *= LOCAL
;SOURCE:CHARA:性行動 /= 500

LOCAL = SOURCE:CHARA:性行動

;ABL:技巧をみる
SELECTCASE ABL:CHARA:技巧
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.80
	CASE 3
		TIMES LOCAL , 2.40
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.60
	CASE 6
		TIMES LOCAL , 4.20
	CASE 7
		TIMES LOCAL , 4.80
	CASE 8
		TIMES LOCAL , 5.40
	CASE 9
		TIMES LOCAL , 6.00
	CASE 10
		TIMES LOCAL , 7.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:技巧 - 3)
ENDSELECT
;ABL:奉仕精神をみる
SELECTCASE ABL:CHARA:奉仕精神
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASE 5
		TIMES LOCAL , 1.70
	CASE 6
		TIMES LOCAL , 2.00
	CASE 7
		TIMES LOCAL , 2.40
	CASE 8
		TIMES LOCAL , 2.80
	CASE 9
		TIMES LOCAL , 4.00
	CASE 10
		TIMES LOCAL , 5.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:奉仕精神 - 5)
ENDSELECT
CUP:CHARA:習得 += LOCAL

;-------------------------------------------------
;達成のソース
;-------------------------------------------------

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
;SOURCE:CHARA:達成 *= LOCAL
;SOURCE:CHARA:達成 /= 500

LOCAL = SOURCE:CHARA:達成

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
	CASE 4
		TIMES LOCAL , 2.50
	CASE 5
		TIMES LOCAL , 3.00
	CASE 6
		TIMES LOCAL , 3.50
	CASE 7
		TIMES LOCAL , 4.00
	CASE 8
		TIMES LOCAL , 4.50
	CASE 9
		TIMES LOCAL , 5.00
	CASE 10
		TIMES LOCAL , 6.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:従順 - 4)
ENDSELECT
;ABL:奉仕精神をみる
SELECTCASE ABL:CHARA:奉仕精神
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 4.50
	CASE 10
		TIMES LOCAL , 6.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:奉仕精神 * 150 - 900 ) / 100
ENDSELECT
CUP:CHARA:恭順 += LOCAL



;-------------------------------------------------
;恐れのソース
;-------------------------------------------------

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
;SOURCE:CHARA:恐れ *= LOCAL
;SOURCE:CHARA:恐れ /= 500

LOCAL = SOURCE:CHARA:恐れ

;ABL:従順をみる（恐怖よりは畏怖に近いと解釈）
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.50
	CASE 6
		TIMES LOCAL , 4.00
	CASE 7
		TIMES LOCAL , 4.50
	CASE 8
		TIMES LOCAL , 5.00
	CASE 9
		TIMES LOCAL , 5.50
	CASE 10
		TIMES LOCAL , 7.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:従順 * 150 - 800 ) / 100
ENDSELECT
CUP:CHARA:恐怖 += LOCAL

;-------------------------------------------------
;中毒充足のソース
;-------------------------------------------------

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))

;SOURCE:CHARA:中毒充足 *= LOCAL
;SOURCE:CHARA:中毒充足 /= 500

LOCAL = SOURCE:CHARA:中毒充足
LOCAL:1 = SOURCE:CHARA:中毒充足

;Desire
SELECTCASE ABL:CHARA:欲望
	CASE 0
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.50
	CASE  1
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 0.70
	CASE  2
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.90
	CASE  3
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.10
	CASE  4
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.30
	CASE  5
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 1.50
	CASE  6
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 1.70
	CASE  7
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 1.90
	CASE  8
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 2.10
	CASE  9
		TIMES LOCAL , 2.20
		TIMES LOCAL:1 , 2.30
	CASE 10
		TIMES LOCAL , 2.50
		TIMES LOCAL:1 , 2.70
	CASEELSE
		LOCAL = LOCAL * ABL:CHARA:欲望 * 25 / 10
		LOCAL:1 = LOCAL:1 * (ABL:CHARA:欲望 * 40 - 130) / 10
ENDSELECT

CUP:CHARA:恭順 += LOCAL
CUP:CHARA:欲情 += LOCAL:1


;-------------------------------------------------
;恭順のソース
;-------------------------------------------------

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))

;SOURCE:CHARA:恭順 *= LOCAL
;SOURCE:CHARA:恭順 /= 500

LOCAL = SOURCE:CHARA:恭順

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASE 5
		TIMES LOCAL , 1.60
	CASE 6
		TIMES LOCAL , 1.80
	CASE 7
		TIMES LOCAL , 2.00
	CASE 8
		TIMES LOCAL , 2.40
	CASE 9
		TIMES LOCAL , 3.00
	CASE 10
		TIMES LOCAL , 5.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:従順 - 5) * 2 - LOCAL
ENDSELECT
CUP:CHARA:恭順 += LOCAL

;-------------------------------------------------
;露出のソース
;-------------------------------------------------
;恥じらいと恥薄いはここで処理
SIF TALENT:CHARA:35
	TIMES SOURCE:CHARA:露出 , 2.00
SIF TALENT:CHARA:36
	TIMES SOURCE:CHARA:露出 , 0.50

;潤滑アップの50％を露出のソースに加える
;ただし液体追加のソースのぶんは引く
SOURCE:CHARA:露出 += (CUP:CHARA:潤滑-SOURCE:CHARA:液体) / 2

LOCAL = SOURCE:CHARA:露出

;ABL:露出癖をみる
SELECTCASE ABL:CHARA:露出癖
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.10
	CASE 2
		TIMES LOCAL , 0.20
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.80
	CASE 6
		TIMES LOCAL , 1.00
	CASE 7
		TIMES LOCAL , 1.20
	CASE 8
		TIMES LOCAL , 1.40
	CASE 9
		TIMES LOCAL , 1.60
	CASE 10
		TIMES LOCAL , 2.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:露出癖 * 40 - 200)/ 100
ENDSELECT
LOCAL:1 = SOURCE:CHARA:露出

;PALAM:恥情をみる
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:CHARA:恥情 < PALAMLV:1
	TIMES LOCAL:1 , 1.00
ELSEIF PALAM:CHARA:恥情 < PALAMLV:2
	TIMES LOCAL:1 , 0.90
ELSEIF PALAM:CHARA:恥情 < PALAMLV:3
	TIMES LOCAL:1 , 0.80
ELSEIF PALAM:CHARA:恥情 < PALAMLV:4
	TIMES LOCAL:1 , 0.70
ELSEIF PALAM:CHARA:恥情 >= PALAMLV:4
	TIMES LOCAL:1 , 0.60
ENDIF


CUP:CHARA:欲情 += LOCAL
CUP:CHARA:恥情 += LOCAL:1


;-------------------------------------------------
;屈従のソース
;-------------------------------------------------

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))

;SOURCE:CHARA:屈従 *= LOCAL
;SOURCE:CHARA:屈従 /= 500	

LOCAL = SOURCE:CHARA:屈従

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
	CASE 4
		TIMES LOCAL , 2.50
	CASE 5
		TIMES LOCAL , 3.00
	CASE 6
		TIMES LOCAL , 3.50
	CASE 7
		TIMES LOCAL , 4.00
	CASE 8
		TIMES LOCAL , 4.50
	CASE 9
		TIMES LOCAL , 5.00
	CASE 10
		TIMES LOCAL , 6.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:従順 - 4)
ENDSELECT
;ABL:奉仕精神をみる
SELECTCASE ABL:CHARA:奉仕精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.50
	CASE 6
		TIMES LOCAL , 4.00
	CASE 7
		TIMES LOCAL , 4.50
	CASE 8
		TIMES LOCAL , 5.00
	CASE 9
		TIMES LOCAL , 5.50
	CASE 10
		TIMES LOCAL , 7.00
	CASEELSE
		LOCAL = LOCAL * (ABL:CHARA:奉仕精神 * 15 - 80) / 10
ENDSELECT
CUP:CHARA:屈服 += LOCAL

;-------------------------------------------------
;不潔のソース
;-------------------------------------------------
;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
;SOURCE:CHARA:不潔 *= 500
;SOURCE:CHARA:不潔 /= LOCAL
LOCAL = SOURCE:CHARA:不潔

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:CHARA:不快 += LOCAL


;-------------------------------------------------
;鬱屈のソース
;-------------------------------------------------
;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
;SOURCE:CHARA:鬱屈 *= 500
;SOURCE:CHARA:鬱屈 /= LOCAL
LOCAL = SOURCE:CHARA:鬱屈

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

;ABL:欲望をみる
SELECTCASE ABL:CHARA:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

CUP:CHARA:抑鬱 += LOCAL

;-------------------------------------------------
;逸脱のソース
;-------------------------------------------------
;好奇心と保守的はここで処理
SIF TALENT:CHARA:23
	TIMES SOURCE:CHARA:逸脱 , 0.80
SIF TALENT:CHARA:24
	TIMES SOURCE:CHARA:逸脱 , 2.00

;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
;SOURCE:CHARA:逸脱 *= 500
;SOURCE:CHARA:逸脱 /= LOCAL
LOCAL = SOURCE:CHARA:逸脱

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:マゾっ気をみる
SELECTCASE ABL:CHARA:マゾっ気
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:CHARA:反感 += LOCAL

;-------------------------------------------------
;反感のソース
;-------------------------------------------------
;忠誠度による修正
;LOCAL = (BASE:ARG:忠誠度 >= 500 ? LIMIT(BASE:忠誠度*3/4,500,750) # LIMIT(BASE:忠誠度/2,1,500))
;SOURCE:CHARA:反感 *= 500
;SOURCE:CHARA:反感 /= LOCAL
LOCAL = SOURCE:CHARA:反感

;ABL:従順をみる
SELECTCASE ABL:CHARA:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:奉仕精神をみる
SELECTCASE ABL:CHARA:奉仕精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:マゾっ気をみる
	SELECTCASE ABL:CHARA:マゾっ気
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:CHARA:反感 += LOCAL

;-------------------------------------------------
;素質などによる上下の処理
;-------------------------------------------------
;-------------------------------------------------
;発情
;-------------------------------------------------
IF 危険日() > 1
	TIMES CUP:CHARA:欲情 , 1.50
	TIMES CUP:CHARA:潤滑 , 1.50
	IF 陥落() == 0
		TIMES CUP:CHARA:恭順 , 0.50
		TIMES CUP:CHARA:恐怖 , 0.50
		TIMES CUP:CHARA:習得 , 0.50
	ENDIF
ENDIF
;-------------------------------------------------
;装備系（薬等）
;-------------------------------------------------
;媚薬
IF TEQUIP:CHARA:26
	TIMES CUP:CHARA:恭順 , 1.20
	TIMES CUP:CHARA:欲情 , 2.00
	TIMES CUP:CHARA:屈服 , 1.20
	TIMES CUP:CHARA:不快 , 0.75
ENDIF

;利尿剤
IF TEQUIP:CHARA:27
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:恥情 , 1.20
	TIMES CUP:CHARA:反感 , 1.50
	TIMES CUP:CHARA:不快 , 1.20
ENDIF

;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;恋慕
;IF TALENT:CHARA:3 && ASSIPLAY == 0
IF Affection(CHARA, CHARA:1)
	TIMES CUP:CHARA:恭順 , 1.50
	TIMES CUP:CHARA:屈服 , 2.00
	TIMES CUP:CHARA:反感 , 0.50
	TIMES CUP:CHARA:不快 , 0.50
;ELSEIF TALENT:CHARA:3 && ASSIPLAY > 0
;	TIMES CUP:CHARA:恭順 , 0.80
;	TIMES CUP:CHARA:反感 , 1.20
;	TIMES CUP:CHARA:不快 , 1.20
ENDIF

;淫乱
IF TALENT:CHARA:淫乱
	TIMES CUP:CHARA:恭順 , 1.20
	TIMES CUP:CHARA:屈服 , 1.20
	TIMES CUP:CHARA:反感 , 0.80
	TIMES CUP:CHARA:不快 , 0.80
	TIMES CUP:CHARA:抑鬱 , 0.40
ENDIF

;服従
IF TALENT:CHARA:服従
	TIMES CUP:CHARA:恭順 , 0.50
	TIMES CUP:CHARA:屈服 , 2.00
	TIMES CUP:CHARA:恐怖 , 1.50
	TIMES CUP:CHARA:反感 , 0.50
ENDIF

;親愛
;IF TALENT:CHARA:親愛 && ASSIPLAY == 0
IF Love(CHARA, CHARA:1)
	TIMES CUP:CHARA:恭順 , 2.00
	TIMES CUP:CHARA:屈服 , 3.00
	TIMES CUP:CHARA:反感 , 0.20
	TIMES CUP:CHARA:不快 , 0.20
	TIMES CUP:CHARA:抑鬱 , 0.50
;ELSEIF TALENT:CHARA:6 && ASSIPLAY > 0
;	TIMES CUP:CHARA:恭順 , 0.80
;	TIMES CUP:CHARA:反感 , 1.20
;	TIMES CUP:CHARA:不快 , 1.20
ENDIF

;娼婦
IF TALENT:CHARA:娼婦
	TIMES CUP:CHARA:恭順 , 1.50
	TIMES CUP:CHARA:屈服 , 1.50
	TIMES CUP:CHARA:反感 , 0.60
	TIMES CUP:CHARA:不快 , 0.60
	TIMES CUP:CHARA:抑鬱 , 0.30
ENDIF

;隷属
IF TALENT:CHARA:隷属
	TIMES CUP:CHARA:恭順 , 0.20
	TIMES CUP:CHARA:屈服 , 2.50
	TIMES CUP:CHARA:恐怖 , 3.00
	TIMES CUP:CHARA:反感 , 0.25
	TIMES CUP:CHARA:不快 , 0.25
	TIMES CUP:CHARA:抑鬱 , 0.25
ENDIF
;貞操
IF 貞操(CHARA, CHARA:1) == -1
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
	TIMES CUP:CHARA:不快 , 1.20
ENDIF
IF 貞操(CHARA, CHARA:1) == -2
	TIMES CUP:CHARA:恭順 , 0.50
	TIMES CUP:CHARA:反感 , 1.50
	TIMES CUP:CHARA:不快 , 1.50
ENDIF
;-------------------------------------------------
;素質
;-------------------------------------------------
;臆病
IF TALENT:CHARA:10
	TIMES CUP:CHARA:恐怖 , 1.20
	TIMES CUP:CHARA:反感 , 1.20
ENDIF
;反抗的（服従、隷属で無効）
IF TALENT:CHARA:11 && (TALENT:CHARA:5 == 0 && TALENT:CHARA:8 == 0)
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
ENDIF
;気丈
IF TALENT:CHARA:12
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:恐怖 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
	TIMES CUP:CHARA:抑鬱 , 1.20
ENDIF
;素直
IF TALENT:CHARA:13
	TIMES CUP:CHARA:恭順 , 1.20
	TIMES CUP:CHARA:反感 , 0.80
ENDIF
;大人しい
IF TALENT:CHARA:14
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:反感 , 0.80
ENDIF
;プライド高い
IF TALENT:CHARA:15
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:恐怖 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
ENDIF
;生意気
IF TALENT:CHARA:16
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
ENDIF
;プライド低い
IF TALENT:CHARA:17
	TIMES CUP:CHARA:屈服 , 1.20
	TIMES CUP:CHARA:恐怖 , 1.20
	TIMES CUP:CHARA:反感 , 0.80
ENDIF
;ツンデレ
IF TALENT:CHARA:18
	;陥落素質がある場合と無い場合で変化する
	IF 陥落(CHARA)
		TIMES CUP:CHARA:恭順 , 1.20
		TIMES CUP:CHARA:屈服 , 1.20
		TIMES CUP:CHARA:反感 , 0.80
	ELSE
		TIMES CUP:CHARA:恭順 , 0.80
		TIMES CUP:CHARA:屈服 , 0.80
		TIMES CUP:CHARA:反感 , 1.20
	ENDIF
ENDIF

;自制心
IF TALENT:CHARA:20
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:恐怖 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
ENDIF
;無関心
IF TALENT:CHARA:21
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:恐怖 , 0.80
	TIMES CUP:CHARA:反感 , 0.80
ENDIF
;感情乏しい
IF TALENT:CHARA:22
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:恥情 , 0.80
	TIMES CUP:CHARA:恐怖 , 0.80
	TIMES CUP:CHARA:反感 , 0.80
	TIMES CUP:CHARA:不快 , 0.80
	TIMES CUP:CHARA:抑鬱 , 0.80
ENDIF
;好奇心
SIF TALENT:CHARA:23
	TIMES CUP:CHARA:習得 , 1.20
;保守的
SIF TALENT:CHARA:24
	TIMES CUP:CHARA:習得 , 0.80
;楽観的
SIF TALENT:CHARA:25
	TIMES CUP:CHARA:抑鬱 , 0.80
;悲観的
SIF TALENT:CHARA:26
	TIMES CUP:CHARA:抑鬱 , 1.20
;目立ちたがり
SIF TALENT:CHARA:28
	TIMES CUP:CHARA:恭順 , 1.20

;抑圧
IF TALENT:CHARA:32
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
	TIMES CUP:CHARA:抑鬱 , 1.20
ENDIF
;解放
IF TALENT:CHARA:33
	TIMES CUP:CHARA:欲情 , 1.20
	TIMES CUP:CHARA:屈服 , 1.20
ENDIF
;抵抗
IF TALENT:CHARA:34
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
	TIMES CUP:CHARA:抑鬱 , 1.20
ENDIF

;痛みに弱い
SIF TALENT:CHARA:40
	TIMES CUP:CHARA:苦痛 , 1.20
;痛みに強い
SIF TALENT:CHARA:41
	TIMES CUP:CHARA:苦痛 , 0.80

;習得早い
SIF TALENT:CHARA:50
	TIMES CUP:CHARA:習得 , 1.20
;習得遅い
SIF TALENT:CHARA:51
	TIMES CUP:CHARA:習得 , 0.80

;献身的
SIF TALENT:CHARA:63
	TIMES CUP:CHARA:屈服 , 1.20

;快感に素直
SIF TALENT:CHARA:70
	TIMES CUP:CHARA:欲情 , 1.20
;快感の否定（淫乱、娼婦で無効）
SIF TALENT:CHARA:71 && (TALENT:CHARA:4 == 0 && TALENT:CHARA:7 == 0)
	TIMES CUP:CHARA:欲情 , 0.80
;即落ち
IF TALENT:CHARA:73
	TIMES CUP:CHARA:恭順 , 2.00
	TIMES CUP:CHARA:欲情 , 2.00
	TIMES CUP:CHARA:屈服 , 2.00
	TIMES CUP:CHARA:習得 , 2.00
	TIMES CUP:CHARA:恥情 , 2.00
	TIMES CUP:CHARA:恐怖 , 2.00
	TIMES CUP:CHARA:反感 , 0.50
	TIMES CUP:CHARA:不快 , 0.50
	TIMES CUP:CHARA:抑鬱 , 0.50
ENDIF
;自慰狂い
SIF TALENT:CHARA:74
	TIMES CUP:CHARA:欲情 , 1.20
;セックス狂い
SIF TALENT:CHARA:75
	TIMES CUP:CHARA:恭順 , 1.20
;尻穴狂い
SIF TALENT:CHARA:76
	TIMES CUP:CHARA:屈服 , 1.20
;淫乳
SIF TALENT:CHARA:77
	TIMES CUP:CHARA:恥情 , 1.20

;倒錯的
IF TALENT:CHARA:80
	TIMES CUP:CHARA:屈服 , 1.20
	TIMES CUP:CHARA:恥情 , 1.20
ENDIF
;男嫌い（女性のみ恋慕、親愛で無効）
IF HATE_MALE(TARGET,PLAYER)
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:習得 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
	TIMES CUP:CHARA:不快 , 1.20
ENDIF
;サド
IF TALENT:CHARA:83
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:恐怖 , 0.80
ENDIF
;マゾ
IF TALENT:CHARA:84
	TIMES CUP:CHARA:屈服 , 1.20
	TIMES CUP:CHARA:恐怖 , 1.20
	TIMES CUP:CHARA:抑鬱 , 0.80
ENDIF
;妄信
IF TALENT:CHARA:86
	TIMES CUP:CHARA:屈服 , 1.20
	TIMES CUP:CHARA:反感 , 0.80
ENDIF
;女嫌い（男性のみ恋慕、親愛で無効）
IF HATE_FEMALE(TARGET,PLAYER)
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:習得 , 0.80
	TIMES CUP:CHARA:反感 , 1.20
	TIMES CUP:CHARA:不快 , 1.20
ENDIF


;-------------------------------------------------
;その他
;-------------------------------------------------
;PainSeal
IF MARK:CHARA:苦痛刻印 == 3
	TIMES CUP:CHARA:苦痛 , 1.30
	TIMES CUP:CHARA:恐怖 , 1.30
ELSEIF MARK:CHARA:苦痛刻印 == 2
	TIMES CUP:CHARA:苦痛 , 1.20
	TIMES CUP:CHARA:恐怖 , 1.20
ELSEIF MARK:CHARA:苦痛刻印 == 1
	TIMES CUP:CHARA:苦痛 , 1.10
	TIMES CUP:CHARA:恐怖 , 1.10
ENDIF

;PleasureSeal
IF MARK:CHARA:快楽刻印 == 3
	TIMES CUP:CHARA:欲情 , 1.30
	TIMES CUP:CHARA:習得 , 1.30
ELSEIF MARK:CHARA:快楽刻印 == 2
	TIMES CUP:CHARA:欲情 , 1.20
	TIMES CUP:CHARA:習得 , 1.20
ELSEIF MARK:CHARA:快楽刻印 == 1
	TIMES CUP:CHARA:欲情 , 1.10
	TIMES CUP:CHARA:習得 , 1.10
ENDIF

;SubmissionSeal
IF MARK:CHARA:屈服刻印 == 3
	TIMES CUP:CHARA:恭順 , 1.30
	TIMES CUP:CHARA:屈服 , 1.30
ELSEIF MARK:CHARA:屈服刻印 == 2
	TIMES CUP:CHARA:恭順 , 1.20
	TIMES CUP:CHARA:屈服 , 1.20
ELSEIF MARK:CHARA:屈服刻印 == 1
	TIMES CUP:CHARA:恭順 , 1.10
	TIMES CUP:CHARA:屈服 , 1.10
ENDIF

;RejectionSeal
IF MARK:CHARA:反発刻印 == 3
	TIMES CUP:CHARA:恭順 , 0.10
	TIMES CUP:CHARA:反感 , 2.50
	TIMES CUP:CHARA:不快 , 2.50
ELSEIF MARK:CHARA:反発刻印 == 2
	TIMES CUP:CHARA:恭順 , 0.25
	TIMES CUP:CHARA:反感 , 1.75
	TIMES CUP:CHARA:不快 , 1.75
ELSEIF MARK:CHARA:反発刻印 == 1
	TIMES CUP:CHARA:恭順 , 0.50
	TIMES CUP:CHARA:反感 , 1.25
	TIMES CUP:CHARA:不快 , 1.25
ENDIF
;-------------------------------------------------
;難易度などによる上下の処理
;-------------------------------------------------
;EASY
IF FLAG:4 == 1
	TIMES CUP:CHARA:潤滑 , 1.20
	TIMES CUP:CHARA:恭順 , 1.20
	TIMES CUP:CHARA:欲情 , 1.20
	TIMES CUP:CHARA:屈服 , 1.20
	TIMES CUP:CHARA:習得 , 1.20
	TIMES CUP:CHARA:恥情 , 1.20
	TIMES CUP:CHARA:苦痛 , 1.20
	TIMES CUP:CHARA:恐怖 , 1.20
	TIMES CUP:CHARA:反感 , 0.90
	TIMES CUP:CHARA:不快 , 0.90
	TIMES CUP:CHARA:抑鬱 , 0.90
;NORMAL
ELSEIF FLAG:4 == 2
;	TIMES CUP:CHARA:潤滑 , 1.20
;	TIMES CUP:CHARA:恭順 , 1.20
;	TIMES CUP:CHARA:欲情 , 1.20
;	TIMES CUP:CHARA:屈服 , 1.20
;	TIMES CUP:CHARA:習得 , 1.20
;	TIMES CUP:CHARA:恥情 , 1.20
;	TIMES CUP:CHARA:苦痛 , 1.20
;	TIMES CUP:CHARA:恐怖 , 1.20
;	TIMES CUP:CHARA:反感 , 1.20
;	TIMES CUP:CHARA:不快 , 1.20
;	TIMES CUP:CHARA:抑鬱 , 1.20
;HARD
ELSEIF FLAG:4 >= 3
	TIMES CUP:CHARA:潤滑 , 0.80
	TIMES CUP:CHARA:恭順 , 0.80
	TIMES CUP:CHARA:欲情 , 0.80
	TIMES CUP:CHARA:屈服 , 0.80
	TIMES CUP:CHARA:習得 , 0.80
	TIMES CUP:CHARA:恥情 , 0.80
	TIMES CUP:CHARA:苦痛 , 0.80
	TIMES CUP:CHARA:恐怖 , 0.80
	TIMES CUP:CHARA:反感 , 1.60
	TIMES CUP:CHARA:不快 , 1.60
	TIMES CUP:CHARA:抑鬱 , 1.60
ENDIF

;-------------------------------------------------
;相性による上下の処理
;-------------------------------------------------
;R = NO:PLAYER
;IF RELATION:R != 0
;	CUP:CHARA:欲情 *= RELATION:R
;	CUP:CHARA:欲情 /= 100
;	CUP:CHARA:屈服 *= RELATION:R
;	CUP:CHARA:屈服 /= 100
;	CUP:CHARA:恥情 *= RELATION:R
;	CUP:CHARA:恥情 /= 100
;	CUP:CHARA:反感 *= 100
;	CUP:CHARA:反感 /= RELATION:R
;	CUP:CHARA:不快 *= 100
;	CUP:CHARA:不快 /= RELATION:R
;	CUP:CHARA:抑鬱 *= 100
;	CUP:CHARA:抑鬱 /= RELATION:R
;ENDIF

;-------------------------------------------------
;同じコマンドの連続実行による上下の処理
;-------------------------------------------------
IF SELECTCOM == PREVCOM
	;CUP:CHARA:快Ｃ,1,2は絶頂に絡むので先に処理してある
	CUP:CHARA:恭順 /= 2
	CUP:CHARA:欲情 /= 2
	CUP:CHARA:屈服 /= 2
	CUP:CHARA:習得 /= 2
	CUP:CHARA:恥情 /= 2
	CUP:CHARA:苦痛 /= 2
	CUP:CHARA:恐怖 /= 2
ENDIF

;-------------------------------------------------
;気力０による上下の処理
;-------------------------------------------------
IF BASE:CHARA:気力 <= 0
	;PRINTL ★気力０★
	;CUP:CHARA:快Ｃ,1,2は絶頂に絡むので先に処理してある
	CUP:CHARA:恭順 /= 2
	CUP:CHARA:欲情 /= 2
	CUP:CHARA:屈服 /= 2
	CUP:CHARA:恥情 /= 2
	CUP:CHARA:恐怖 /= 2
	CUP:CHARA:抑鬱 /= 2

	DOWNBASE:CHARA:体力 *= 2
	DOWNBASE:CHARA:体力 += 80
ENDIF
;-------------------------------------------------
;MasoEXP、ServicPlsEXPのチェック
;-------------------------------------------------
CALL EXP_GOT_CHECK, CHARA, CHARA:1
CALL EXP_GOT_CHECK, CHARA:1, CHARA
;-------------------------------------------------
;衣装による経験増加のチェック
;-------------------------------------------------
CALL CHECK_EXP(CHARA)
CALL CHECK_EXP(CHARA:1)

;-------------------------------------------------
;拡張・獣姦初体験の場合AbnormalEXP付与
;-------------------------------------------------
SIF TCVAR:(CHARA):獲得Ｖ拡張経験 || TCVAR:(CHARA):獲得Ａ拡張経験
	CALL ADDS_ABNORMAL_EXP, "Expansion first experience" , CHARA
SIF TCVAR:(CHARA:1):獲得Ｖ拡張経験 || TCVAR:(CHARA:1):獲得Ａ拡張経験
	CALL ADDS_ABNORMAL_EXP, "Expansion first experience" , CHARA:1
SIF TCVAR:(CHARA):獲得吸血経験
	CALL ADDS_ABNORMAL_EXP, "Bestiality" , CHARA
SIF TCVAR:(CHARA:1):獲得吸血経験
	CALL ADDS_ABNORMAL_EXP, "Bestiality" , CHARA:1

;-------------------------------------------------
;苦痛からくる体力・気力の減少
;-------------------------------------------------
LOCAL:3 = CUP:CHARA:苦痛/20
;ABL:マゾっ気をみる
SELECTCASE ABL:CHARA:マゾっ気
	CASE 0
		TIMES LOCAL:3, 1.00
	CASE 1
		TIMES LOCAL:3, 0.95
	CASE 2
		TIMES LOCAL:3, 0.90
	CASE 3
		TIMES LOCAL:3, 0.80
	CASE 4
		TIMES LOCAL:3, 0.65
	CASEELSE
		TIMES LOCAL:3, 0.50
ENDSELECT
;痛みに弱い
SIF TALENT:CHARA:40
	TIMES LOCAL:3, 1.20
;痛みに強い
SIF TALENT:CHARA:41
	TIMES LOCAL:3, 0.80

DOWNBASE:CHARA:体力 += LOCAL:3
DOWNBASE:CHARA:気力 += LOCAL:3

;-------------------------------------------------
;Stamina・気力の減少
;-------------------------------------------------
BASE:CHARA:体力 -= DOWNBASE:CHARA:体力
IF BASE:CHARA:体力 < 0
	BASE:CHARA:体力 = 0
ELSEIF BASE:CHARA:体力 > MAXBASE:CHARA:体力
	BASE:CHARA:体力 = MAXBASE:CHARA:体力
ENDIF
BASE:CHARA:気力 -= DOWNBASE:CHARA:気力
IF BASE:CHARA:気力 < 0
	BASE:CHARA:気力 = 0
ELSEIF BASE:CHARA:気力 > MAXBASE:CHARA:気力
	BASE:CHARA:気力 = MAXBASE:CHARA:気力
ENDIF


;-------------------------------------------------
;コマンド口上
;-------------------------------------------------
PRINTL
CALL KOJO_MESSAGE_COM
PRINTL
;-------------------------------------------------
;処女喪失チェック
;-------------------------------------------------
;主人
IF TCVAR:MASTER:獲得Ｖ経験 > 0 && (TALENT:MASTER:処女 || TALENT:MASTER:再生処女)
	TALENT:MASTER:処女 = 0
	TALENT:MASTER:再生処女 = 0
ENDIF
;助手
IF ASSI > -1 && TCVAR:ASSI:獲得Ｖ経験 > 0 && (TALENT:ASSI:処女 || TALENT:ASSI:再生処女)
	TALENT:ASSI:処女 = 0
	TALENT:ASSI:再生処女 = 0
ENDIF
;調教対象
IF TFLAG:19 && (TALENT:処女 || TALENT:再生処女)
	IF TALENT:処女
		IF TALENT:TARGET:3 && TFLAG:20
			PRINTFORML %CALLNAME:TARGET% seems to be happy to give %HIS_HER(TARGET)% virginity to %CALLNAME:MASTER%...
			;%CALLNAME:TARGET%は%CALLNAME:MASTER%に処女を捧げられた事に幸福を感じているようだ……
		ELSEIF TALENT:TARGET:6 && TFLAG:20
			PRINTFORML %CALLNAME:TARGET% seems to be very happy about giving %HIS_HER(TARGET)% first time to %CALLNAME:MASTER%...
			;%CALLNAME:TARGET%は%CALLNAME:MASTER%が初めての相手である事にこの上ない幸せを感じているようだ……
		ENDIF
		PRINTL
		;処女貫通履歴用
		SIF TEQUIP:TARGET:Ｖ挿入者 == MASTER
			SETBIT FLAG:(50000+NO:TARGET), 7

		;処女奪取人数カウント
		FLAG:処女奪取人数 += 1
	ENDIF
	TALENT:処女 = 0
	TALENT:再生処女 = 0
ENDIF
;-------------------------------------------------
;セックス時の挿入継続フラグ
;-------------------------------------------------
TFLAG:60 = 0
SIF (SELECTCOM == 60 || SELECTCOM == 61 || SELECTCOM == 62 || SELECTCOM == 63 || SELECTCOM == 64 || SELECTCOM == 65 || SELECTCOM == 66 || SELECTCOM == 67 || SELECTCOM == 68 || SELECTCOM == 69 || SELECTCOM == 70 || SELECTCOM == 71 || SELECTCOM == 154 || SELECTCOM == 74) && (TFLAG:2 == 0 || PALAM:CHARA:欲情 >= PALAMLV:4) && CFLAG:TARGET:106 == 0 && CHARA == TARGET
		TFLAG:60 = 1

;-------------------------------------------------
;絶頂表示
;-------------------------------------------------
FONTBOLD
SETCOLOR 0xFFFFFF
FOR LOCAL , 0 , 2 + (ASSI > 0)
	絶頂数 = 0
	SIF LOCAL == 0
		CHARA = MASTER
	SIF LOCAL == 1
		CHARA = TARGET
	SIF LOCAL == 2
		CHARA = ASSI
	SIF NOWEX:CHARA:0
		PRINTFORML \@ NOWEX:CHARA:0 == 5 ? Ultimate # \@\@ NOWEX:CHARA:0 == 4 ? Super strong # \@\@ NOWEX:CHARA:0 == 3 ? Really strong # \@\@ NOWEX:CHARA:0 == 2 ? Strong # \@Ｃ orgasm\@ CHARA == MASTER ? (Master) # \@\@ CHARA == ASSI ? (Assistant) # \@
	SIF NOWEX:CHARA:1
		PRINTFORML \@ NOWEX:CHARA:1 == 5 ? Ultimate # \@\@ NOWEX:CHARA:1 == 4 ? Super strong # \@\@ NOWEX:CHARA:1 == 3 ? Really strong # \@\@ NOWEX:CHARA:1 == 2 ? Strong # \@Ｖ orgasm\@ CHARA == MASTER ? (Master) # \@\@ CHARA == ASSI ? (Assistant) # \@
	SIF NOWEX:CHARA:2
		PRINTFORML \@ NOWEX:CHARA:2 == 5 ? Ultimate # \@\@ NOWEX:CHARA:2 == 4 ? Super strong # \@\@ NOWEX:CHARA:2 == 3 ? Really strong # \@\@ NOWEX:CHARA:2 == 2 ? Strong # \@Ａ orgasm\@ CHARA == MASTER ? (Master) # \@\@ CHARA == ASSI ? (Assistant) # \@
	SIF NOWEX:CHARA:3
		PRINTFORML \@ NOWEX:CHARA:3 == 5 ? Ultimate # \@\@ NOWEX:CHARA:3 == 4 ? Super strong # \@\@ NOWEX:CHARA:3 == 3 ? Really strong # \@\@ NOWEX:CHARA:3 == 2 ? Strong # \@Ｂ orgasm\@ CHARA == MASTER ? (Master) # \@\@ CHARA == ASSI ? (Assistant) # \@
	絶頂数 = (NOWEX:CHARA:0 > 0) + (NOWEX:CHARA:1 > 0) + (NOWEX:CHARA:2 > 0) + (NOWEX:CHARA:3 > 0)
	IF 絶頂数 == 4
		IF NOWEX:CHARA:0 >= 5 && NOWEX:CHARA:1 >= 5 && NOWEX:CHARA:2 >= 5 && NOWEX:CHARA:3 >= 5
			PRINTFORML 究 極 四 重 絶 頂\@ CHARA == MASTER ? (主人) # \@\@ CHARA == ASSI ? (助手) # \@
			絶頂数 = 4
			IF CHARA == TARGET
				FONTREGULAR
				RESETCOLOR
				PRINTFORML (それぞれ40倍の珠が得られます)
				FONTBOLD
				SETCOLOR 0xFFFFFF
			ENDIF
		ELSEIF NOWEX:CHARA:0 >= 4 && NOWEX:CHARA:1 >= 4 && NOWEX:CHARA:2 >= 4 && NOWEX:CHARA:3 >= 4
			PRINTFORML 最 強 四 重 絶 頂\@ CHARA == MASTER ? (主人) # \@\@ CHARA == ASSI ? (助手) # \@
			絶頂数 = 4
			IF CHARA == TARGET
				FONTREGULAR
				RESETCOLOR
				PRINTFORML (それぞれ32倍の珠が得られます)
				FONTBOLD
				SETCOLOR 0xFFFFFF
			ENDIF
		ELSEIF NOWEX:CHARA:0 >= 3 && NOWEX:CHARA:1 >= 3 && NOWEX:CHARA:2 >= 3 && NOWEX:CHARA:3 >= 3
			PRINTFORML 超 強 四 重 絶 頂\@ CHARA == MASTER ? (主人) # \@\@ CHARA == ASSI ? (助手) # \@
			絶頂数 = 4
			IF CHARA == TARGET
				FONTREGULAR
				RESETCOLOR
				PRINTFORML (それぞれ24倍の珠が得られます)
				FONTBOLD
				SETCOLOR 0xFFFFFF
			ENDIF
		ELSEIF NOWEX:CHARA:0 >= 2 && NOWEX:CHARA:1 >= 2 && NOWEX:CHARA:2 >= 2 && NOWEX:CHARA:3 >= 2
			PRINTFORML 強 四 重 絶 頂\@ CHARA == MASTER ? (主人) # \@\@ CHARA == ASSI ? (助手) # \@
			絶頂数 = 4
			IF CHARA == TARGET
				FONTREGULAR
				RESETCOLOR
				PRINTFORML (それぞれ16倍の珠が得られます)
				FONTBOLD
				SETCOLOR 0xFFFFFF
			ENDIF
		ELSE
			PRINTFORML 四 重 絶 頂\@ CHARA == MASTER ? (主人) # \@\@ CHARA == ASSI ? (助手) # \@
			絶頂数 = 4
			IF CHARA == TARGET
				FONTREGULAR
				RESETCOLOR
				PRINTFORML (それぞれ8倍の珠が得られます)
				FONTBOLD
				SETCOLOR 0xFFFFFF
			ENDIF
		ENDIF
	ELSEIF 絶頂数 > 1
		絶頂数 = 0
		IF NOWEX:CHARA:0
			PRINTFORM Ｃ
			絶頂数 ++
		ENDIF
		IF NOWEX:CHARA:1
			PRINTFORM \@絶頂数 ? ＆ # \@Ｖ
			絶頂数 ++
		ENDIF
		IF NOWEX:CHARA:2
			PRINTFORM \@絶頂数 ? ＆ # \@Ａ
			絶頂数 ++
		ENDIF
		IF NOWEX:CHARA:3
			PRINTFORM \@絶頂数 ? ＆ # \@Ｂ
			絶頂数 ++
		ENDIF
		PRINTFORML  orgasm \@ CHARA == MASTER ? (Master) # \@\@ CHARA == ASSI ? (Assistant) # \@
		;絶頂\@ CHARA == MASTER ? (主人) # \@\@ CHARA == ASSI ? (助手) # \@
		IF CHARA == TARGET
			FONTREGULAR
			RESETCOLOR
			PRINTFORML ({POWER(2,絶頂数-1)} times the experience will be gotten from this)
			;PRINTFORML (それぞれ{POWER(2,絶頂数-1)}倍の珠が得られます)
			FONTBOLD
			SETCOLOR 0xFFFFFF
		ENDIF
	ENDIF
	;噴乳表示;下のNOWEX:CHARA:噴乳はすべてNOWEX:CHARA:4だった
	IF NOWEX:CHARA:10
		PRINTFORM \@ NOWEX:CHARA:10 == 5 ? Ultimate # \@\@ NOWEX:CHARA:10 == 4 ? Super large # \@\@ NOWEX:CHARA:10 == 3 ? Really large # \@\@ NOWEX:CHARA:10 == 2 ? Large # \@ Milk spray
		;究極	最強	超大量	大量	噴乳
		SELECTCASE CHARA
			CASE MASTER
				PRINTFORM (Master)
				;PRINTFORM (主人)
			CASE TARGET
				PRINTFORM (%CALLNAME:CHARA%)
			CASE ASSI
				PRINTFORM (Assistant)
				;PRINTFORM (助手)
		ENDSELECT
;		IF NOWEX:CHARA:4 == 2
;			PRINTFORML %CALLNAME:CHARA%は乳首から大量の母乳を噴出した
;		ELSE
;			PRINTFORML %CALLNAME:CHARA%は乳首から母乳を垂れ流した
;		ENDIF
		PRINTL 
	ENDIF
	;ＴＳして女になっているキャラがＶ絶頂するとAbnormalEXP付与
	SIF NOWEX:CHARA:Ｖ絶頂 && EXP:CHARA:ＴＳ経験 % 2 == 1 && !IS_MALE(CHARA)
		CALL ADDS_ABNORMAL_EXP , "ＴＳ ＶCum" , CHARA
NEXT

CHARA = TARGET
;-------------------------------------------------
;射精処理
;-------------------------------------------------
SIF TFLAG:10
	CALL SAMEN_SHOOT_TARGET
SIF TCVAR:MASTER:射精
	CALL SAMEN_SHOOT,MASTER
SIF ASSI > -1 && TCVAR:ASSI:射精
	CALL SAMEN_SHOOT,ASSI
PRINTL
FONTREGULAR
RESETCOLOR

;-------------------------------------------------
;調教者の射精時の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_A
;-------------------------------------------------
;射精フラグはここで初期化
;-------------------------------------------------	
CFLAG:TARGET:106 = 0
;-------------------------------------------------
;触手の射精時の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_E
;-------------------------------------------------
;奴隷の絶頂時の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_B
;-------------------------------------------------	
;絶頂時の放尿処理
;-------------------------------------------------
CALL ORGASM_ADD_URINE, TARGET
;-------------------------------------------------
;調教後の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_C
;-------------------------------------------------
;パラメータ変動による口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_D
;-------------------------------------------------
;刻印取得のチェック
;-------------------------------------------------
CALL MARK_GOT_CHECK
;-------------------------------------------------
;刻印取得による口上
;-------------------------------------------------
CALL KOJO_MESSAGE_MARKCNG
;-------------------------------------------------
;刻印取得の処理
;-------------------------------------------------
CALL MARK_GOT_RESULT
;-------------------------------------------------
;従順上昇による[抵抗]の消滅チェック
;-------------------------------------------------
CALL JUJUN_UP_CHECK
DRAWLINE
;IF ASSIPLAY
;	TFLAG:50 = 1
;ELSE
;	TFLAG:50 = 0
;ENDIF
;現状ではMASTERとASSIの体力気力の減少はない
DOWNBASE:MASTER:体力 = 0
DOWNBASE:MASTER:気力 = 0
IF ASSI > 0
	DOWNBASE:ASSI:体力 = 0
	DOWNBASE:ASSI:気力 = 0
ENDIF
;Stamina・気力の減少
PRINT Stamina-
PRINTV DOWNBASE:CHARA:体力
PRINT  Willpower-
PRINTVL DOWNBASE:CHARA:気力

IF TFLAG:お掃除フェラ発生
	SIF TFLAG:お掃除フェラ発生 & (1)
		STAIN:PLAYER:ペニス = 2
	SIF TFLAG:お掃除フェラ発生 & (2 | 32)
		STAIN:(PLAYER != MASTER ? MASTER # ASSI):ペニス = 2
	SIF TFLAG:お掃除フェラ発生 & (4 | 512)
		STAIN:MASTER:ペニス = 2
	SIF TFLAG:お掃除フェラ発生 & (8 | 128)
		STAIN:ASSI:ペニス = 2
	SIF TFLAG:お掃除フェラ発生 & (16 | 64 | 256)
		STAIN:TARGET:ペニス = 2
	TFLAG:お掃除フェラ発生 = 0
ENDIF

;-------------------------------------------------
;数値変動の表示
;-------------------------------------------------
;相性
;R = NO:PLAYER
LOCAL = LIMIT(100 + (GET_RELATION(CHARA, CHARA:1) - 100)/2 , 50, 150)
SIF LOCAL != 100
	PRINTFORML ＜Compatibility %TOSTR(LOCAL, "0'.'00")%＞
;同じコマンドの連続実行
SIF SELECTCOM == PREVCOM
	PRINTL ＜Execution of the same command as last time＞
;今回のコマンドを「前回のコマンド」とする
ARRAYSHIFT PREVCOM, 1, SELECTCOM
;PREVCOM = SELECTCOM
;前回の調教者の取得
TFLAG:前回の調教者 = PLAYER
;気力０
SIF BASE:CHARA:気力 <= 0
	PRINTL ★Willpower０★
;-------------------------------------------------
;調教ソースの表示
;-------------------------------------------------
CALL SHOW_SOURCE, CHARA
;-------------------------------------------------
;ソースの表示(調教者)
;-------------------------------------------------
LOCAL:1 = 0
FOR LOCAL, 0, 100
	SIF PALAM:(CHARA:1):LOCAL + PALAM:(CHARA:1):LOCAL == 0
		CONTINUE
	LOCAL:1 = 1
	BREAK
NEXT
IF LOCAL:1
	CALL SHOW_SOURCE, CHARA:1
	;-------------------------------------------------
	;数値変動の表示
	;-------------------------------------------------
	;相性
	;R = NO:PLAYER
	LOCAL = LIMIT(100 + (GET_RELATION(CHARA:1, CHARA) - 100)/2 , 50, 150)
	SIF LOCAL != 100
		PRINTFORML ＜Compatibility %TOSTR(LOCAL, "0'.'00")%＞
	;同じコマンドの連続実行
;	SIF SELECTCOM == PREVCOM
;		PRINTL ＜同一コマンド連続実行＞
	;気力０
	SIF BASE:(CHARA:1):気力 <= 0
		PRINTL ★Willpower０★
		;気力
ENDIF

;-------------------------------------------------
;射精後の再装填処理
;-------------------------------------------------
IF PCOUNT == 2
	REPEAT CHARANUM
		SIF CFLAG:COUNT:9 > 0
			CFLAG:COUNT:9 -= 1
	REND
ENDIF
;-------------------------------------------------
;パラメータの上昇＆表示（DOWNもここで）
;-------------------------------------------------
;UPCHECK
CALL UPCHECK_A, CHARA
CALL UPCHECK_A, CHARA:1
;-------------------------------------------------
;EXP・MAG等の表示
;-------------------------------------------------
;CALL SHOW_ADD_EXP, TARGET
;CALL SHOW_ADD_EXP, MASTER
;CALL SHOW_ADD_EXP, ASSI
;CALL SHOW_ABNORMAL_EXP, TARGET
;CALL SHOW_ABNORMAL_EXP, MASTER
;CALL SHOW_ABNORMAL_EXP, ASSI
CALL SHOW_EXTRA, TARGET
CALL SHOW_EXTRA, MASTER
CALL SHOW_EXTRA, ASSI
;WAIT
;-------------------------------------------------
;調教者のSOURCEを0に
;-------------------------------------------------
;REPEAT 4
;	SOURCE:PLAYER:COUNT = 0
;REND
;-------------------------------------------------
;調教ソースの表示（DOWNもここで）
;-------------------------------------------------
@SHOW_SOURCE, ARG
;PRINTL 　
SIF ARG < 0
	RETURN 0
LOCAL:1 = 0
FOR LOCAL,0,VARSIZE("SOURCE")
	SIF SOURCE:ARG:LOCAL == 0
		CONTINUE
	LOCAL:1 = 1
	BREAK
NEXT
IF LOCAL:1
	DRAWLINE
;	DRAWLINE
	PRINTFORML Source (%CALLNAME:ARG%)
	FOR LOCAL,0,VARSIZE("SOURCE")
		SIF SOURCE:ARG:LOCAL == 0
			CONTINUE
		PRINTFORM %SOURCENAME_E(LOCAL)%({SOURCE:ARG:LOCAL})
	NEXT
	PRINTL 
ENDIF

;SIF SOURCE:ARG:快Ｃ > 0
;	PRINTFORM ＣPleasure({SOURCE:ARG:快Ｃ})
;SIF SOURCE:ARG:快Ｖ > 0
;	PRINTFORM ＶPleasure({SOURCE:ARG:快Ｖ})
;SIF SOURCE:ARG:快Ａ > 0
;	PRINTFORM ＡPleasure({SOURCE:ARG:快Ａ})
;SIF SOURCE:ARG:快Ｂ > 0
;	PRINTFORM ＢPleasure({SOURCE:ARG:快Ｂ})
;SIF SOURCE:ARG:情愛 > 0
;	PRINTFORM Affection({SOURCE:ARG:情愛})
;SIF SOURCE:ARG:性行動 > 0
;	PRINTFORM Sexuality({SOURCE:ARG:性行動})
;SIF SOURCE:ARG:達成 > 0
;	PRINTFORM Accomplishment({SOURCE:ARG:達成})
;SIF SOURCE:ARG:痛み > 0
;	PRINTFORM Pain({SOURCE:ARG:痛み})
;SIF SOURCE:ARG:恐れ > 0
;	PRINTFORM Fear({SOURCE:ARG:恐れ})
;SIF SOURCE:ARG:中毒充足 > 0
;	PRINTFORM Indulgence({SOURCE:ARG:中毒充足})
;SIF SOURCE:ARG:液体 > 0
;	PRINTFORM Lubrication({SOURCE:ARG:液体})
;SIF SOURCE:ARG:欲情 > 0
;	PRINTFORM Desire({SOURCE:ARG:欲情})
;SIF SOURCE:ARG:恭順 > 0
;	PRINTFORM Submission({SOURCE:ARG:恭順})
;SIF SOURCE:ARG:露出 > 0
;	PRINTFORM Exposure({SOURCE:ARG:露出})
;SIF SOURCE:ARG:屈従 > 0
;	PRINTFORM Subservience({SOURCE:ARG:屈従})
;SIF SOURCE:ARG:不潔 > 0
;	PRINTFORM Filth({SOURCE:ARG:不潔})
;SIF SOURCE:ARG:鬱屈 > 0
;	PRINTFORM Depression({SOURCE:ARG:鬱屈})
;SIF SOURCE:ARG:逸脱 > 0
;	PRINTFORM Deviation({SOURCE:ARG:逸脱})
;SIF SOURCE:ARG:反感 > 0
;	PRINTFORM Antipathy({SOURCE:ARG:反感})
;PRINTL


;-------------------------------------------------
;UPCHECK措置
;-------------------------------------------------
@UPCHECK_A, ARG
#DIM PALAMLV_B, 1
#DIM PALAMLV_A, 1
#DIM 元PALAM, 1
#DIM 結果PALAM, 1
#DIM 増加PALAM, 1
#DIM 減少PALAM, 1
#LOCALSSIZE 1
SIF ARG < 0
	RETURN 0
LOCAL:1 = 0
FOR LOCAL,0,VARSIZE("PALAM")
	SIF CUP:ARG:LOCAL + CDOWN:ARG:LOCAL == 0
		CONTINUE
	LOCAL:1 = 1
	BREAK
NEXT
;ＮＴＲ機能による淫乱度の増減処理
IF FLAG:ＮＴＲ機能
	IF (ARG == TARGET && FAVORITE_1(ARG) != PLAYER) || (ARG == PLAYER && FAVORITE_1(ARG) != TARGET)
		FOR LOCAL , 0 , 10
			IF LOCAL == 9 || CUP:ARG:欲情 < PALAMLV:LOCAL
				CFLAG:ARG:淫乱度 += LOCAL*2
				BREAK
			ENDIF
		NEXT
	ELSE
		;浮気草の露
		SIF CFLAG:117 == 1
			CFLAG:ARG:淫乱度 -= 500
		CFLAG:ARG:淫乱度 -= 1
	ENDIF
ENDIF
IF LOCAL:1
	DRAWLINE
	PRINTFORML ＰＡＬＡＭ(%CALLNAME:ARG%)
	;表示設定Ｃ
	IF FLAG:PALAM表示設定 == 2
		FOR LOCAL,0,VARSIZE("PALAM")
			SIF CUP:ARG:LOCAL + CDOWN:ARG:LOCAL == 0
				CONTINUE
			元PALAM = PALAM:ARG:LOCAL - PALAMLV:GETPALAMLV(PALAM:ARG:LOCAL, 17)
			減少PALAM = 0
			増加PALAM = CUP:ARG:LOCAL
			;レベルアップを判定
			;快感は特別
			PALAMLV_B = GETPALAMLV(PALAM:ARG:LOCAL, 17)
			IF LOCAL < 4 && CUP:ARG:LOCAL + PALAM:ARG:LOCAL >= 10000
				PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				結果PALAM = PALAM:ARG:LOCAL
				減少PALAM = CDOWN:ARG:LOCAL
			ELSEIF CUP:ARG:LOCAL + PALAM:ARG:LOCAL >=  PALAMLV:(GETPALAMLV(PALAM:ARG:LOCAL, 17) + 1)
				PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				PALAMLV_A = GETPALAMLV(PALAM:ARG:LOCAL, 17)
				結果PALAM = PALAM:ARG:LOCAL - PALAMLV:PALAMLV_A
				増加PALAM = PALAM:ARG:LOCAL - 元PALAM
				減少PALAM = PALAM:ARG:LOCAL - 結果PALAM 
			ELSE
				PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				結果PALAM = 元PALAM + CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				PALAMLV_A = PALAMLV_B
				減少PALAM = CDOWN:ARG:LOCAL
			ENDIF
			LOCALS = %PALAMNAME_E(LOCAL)%
			IF LOCAL > 4
				IF (PALAMNAME:LOCAL == "LUBRIC" && PALAMLV_A >= 5) || PALAMLV_A >= 17
					LOCALS += "(MAX)"
				ELSEIF PALAMLV_A == PALAMLV_B
					LOCALS += "(Lv" + @"{PALAMLV_A}"+ ")"
				ELSE
					LOCALS += "(Lv" + @"{PALAMLV_B}"+ "→" + @"{PALAMLV_A}" + ")"
				ENDIF
			ENDIF
			PRINTFORM %LOCALS,14,LEFT% 
			PRINTFORM {元PALAM,8,RIGHT}    
			PRINTFORM + {増加PALAM,8,RIGHT}    
			IF 減少PALAM > 0
				PRINTFORM - {減少PALAM,8,RIGHT}    
			ELSE
				PRINTFORM %" "*14%
			ENDIF
			PRINTFORM ={結果PALAM,8,RIGHT}
			;PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
			IF (PALAMNAME:LOCAL == "LUBRIC" && PALAMLV_A >= 5) || PALAMLV_A >= 17
			ELSEIF LOCAL < 4 && CDOWN:ARG:LOCAL > 0
				FONTBOLD
				SETCOLOR 0xFFAAFF
				PRINTFORM 　　Ecstasy
				CALL HEARTB, NOWEX:ARG:LOCAL
				RESETCOLOR
				FONTREGULAR
			ELSE
				PRINTFORM 　　NEXT({PALAMLV:(PALAMLV_A+1) - PALAMLV:PALAMLV_A})
			ENDIF
			PRINTL 
			CUP:ARG:LOCAL = 0
			CDOWN:ARG:LOCAL = 0
		NEXT
	;表示設定ＡＢ
	ELSE
		FOR LOCAL,0,VARSIZE("PALAM")
			SIF CUP:ARG:LOCAL + CDOWN:ARG:LOCAL == 0
				CONTINUE
			元PALAM = PALAM:ARG:LOCAL
			減少PALAM = 0
			増加PALAM = CUP:ARG:LOCAL
			;レベルアップを判定
			;快感は特別
			PALAMLV_B = GETPALAMLV(PALAM:ARG:LOCAL, 17)
			IF LOCAL < 4 && CUP:ARG:LOCAL + PALAM:ARG:LOCAL >= 10000
				PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				結果PALAM = PALAM:ARG:LOCAL
				減少PALAM = CDOWN:ARG:LOCAL
			ELSEIF CUP:ARG:LOCAL + PALAM:ARG:LOCAL >=  PALAMLV:(GETPALAMLV(PALAM:ARG:LOCAL, 17) + 1)
				PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				PALAMLV_A = GETPALAMLV(PALAM:ARG:LOCAL, 17)
				結果PALAM = PALAM:ARG:LOCAL
				減少PALAM = 元PALAM + 増加PALAM - 結果PALAM 
			ELSE
				PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				結果PALAM = 元PALAM + CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
				PALAMLV_A = PALAMLV_B
				減少PALAM = CDOWN:ARG:LOCAL
			ENDIF
			LOCALS = %PALAMNAME_E(LOCAL)%
			IF LOCAL > 4
				IF (PALAMNAME:LOCAL == "LUBRIC" && PALAMLV_A >= 5) || PALAMLV_A >= 17
					LOCALS += "(MAX)"
				ELSEIF PALAMLV_A == PALAMLV_B
					LOCALS += "(Lv" + @"{PALAMLV_A}"+ ")"
				ELSE
					LOCALS += "(Lv" + @"{PALAMLV_B}"+ "→" + @"{PALAMLV_A}" + ")"
				ENDIF
			ENDIF
			PRINTFORM %LOCALS,14,LEFT% 
			PRINTFORM {元PALAM,8,RIGHT}    
			PRINTFORM + {増加PALAM,8,RIGHT}    
			IF 減少PALAM > 0
				PRINTFORM - {減少PALAM,8,RIGHT}    
			ELSE
				PRINTFORM %" "*14%
			ENDIF
			PRINTFORM ={結果PALAM,8,RIGHT}
			;PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
			IF (PALAMNAME:LOCAL == "LUBRIC" && PALAMLV_A >= 5) || PALAMLV_A >= 17
			ELSEIF LOCAL < 4 && CDOWN:ARG:LOCAL > 0
				FONTBOLD
				SETCOLOR 0xFFAAFF
				PRINTFORM 　　Ecstasy
				CALL HEARTB, NOWEX:ARG:LOCAL
				RESETCOLOR
				FONTREGULAR
			ELSE
				PRINTFORM 　　NEXT({PALAMLV:(PALAMLV_A+1)})
			ENDIF
			PRINTL 
			CUP:ARG:LOCAL = 0
			CDOWN:ARG:LOCAL = 0
		NEXT
	ENDIF
ENDIF

;-------------------------------------------------
;珠獲得表示
;-------------------------------------------------
@SHOW_JUEL_CHECK, ARG, ARGS = "表示"
#LOCALSIZE 1
FOR LOCAL, 0 , 101
	IF GOTJUEL:ARG:LOCAL
		SIF  ARGS == "表示"
			PRINTFORML %PALAMNAME_E(LOCAL)% Orbs×{GOTJUEL:ARG:LOCAL}
		JUEL:ARG:LOCAL += GOTJUEL:ARG:LOCAL
		GOTJUEL:ARG:LOCAL = 0
	ENDIF
NEXT
;-------------------------------------------------
;その他の表示
;-------------------------------------------------
@SHOW_EXTRA, ARG
SIF ARG < 0
	RETURN 0
SIF TCVAR:ARG:獲得忠誠度 == 0 && TCVAR:ARG:獲得依存度 == 0 && MATCH(TCVAR:ARG:0,0,0,100) == 100
	RETURN 0
DRAWLINE
PRINTFORML ＥＸＴＲＡ(%CALLNAME:ARG%)
CALL SHOW_DEPENDENCE, ARG
CALL SHOW_GET_MAG, ARG
CALL SHOW_ADD_EXP, ARG
CALL SHOW_ABNORMAL_EXP, ARG
;===============================
;獲得MAG表示
;==============================
@SHOW_GET_MAG, ARG
SIF ARG < 0
	RETURN 0
SIF TCVAR:ARG:獲得ＭＡＧ
	PRINTFORML %"ＭＡＧ",12,LEFT% {BASE:ARG:ＭＡＧ - TCVAR:ARG:獲得ＭＡＧ,16,RIGHT}      \@TCVAR:ARG:獲得ＭＡＧ > 0 ? + # - \@{ABS(TCVAR:ARG:獲得ＭＡＧ),16,RIGHT} = {BASE:ARG:ＭＡＧ,16,RIGHT}
TCVAR:ARG:獲得ＭＡＧ = 0

@SHOW_DEPENDENCE, ARG
SIF ARG < 0
	RETURN 0
;今のところターゲットしか動かないので
IF ARG == TARGET
	IF TCVAR:ARG:獲得依存度 && TALENT:MASTER:覚
		PRINTFORML %"Dependency",12,LEFT% {CFLAG:ARG:依存度-TCVAR:ARG:獲得依存度,16,RIGHT}      \@TCVAR:ARG:獲得依存度>0?+#-\@{TCVAR:ARG:獲得依存度,16,RIGHT} = {CFLAG:ARG:依存度,16,RIGHT}
	ELSE
		PRINTFORM %"Dependency",12,LEFT% 
		IF TCVAR:ARG:獲得依存度 > 0
			PRINTFORML %"Increase",16,RIGHT%
		ELSEIF TCVAR:ARG:獲得依存度 < 0
			PRINTFORML %"Decrease",16,RIGHT%
		ELSE
			PRINTFORML %"No change",16,RIGHT%
		ENDIF
	ENDIF
ENDIF
TCVAR:ARG:獲得依存度 = 0
SIF TCVAR:ARG:獲得忠誠度
	PRINTFORML %"Loyalty",12,LEFT% {BASE:ARG:忠誠度-TCVAR:ARG:獲得忠誠度,16,RIGHT}      \@TCVAR:ARG:獲得忠誠度>0?+#-\@{TCVAR:ARG:獲得忠誠度,16,RIGHT} = {BASE:ARG:忠誠度,16,RIGHT}
TCVAR:ARG:獲得忠誠度 = 0
;-------------------------------------------------
;獲得ＥＸＰの表示・加算
;-------------------------------------------------
@SHOW_ADD_EXP, ARG , ARGS = "表示"
#LOCALSIZE 2
SIF ARG < 0
	RETURN 0
LOCAL:1 = 0
FOR LOCAL, 0, VARSIZE("EXP")
	SIF TCVAR:ARG:LOCAL == 0
		CONTINUE
	LOCAL:1 = 1
	BREAK
NEXT
IF LOCAL:1
	FOR LOCAL,0,VARSIZE("EXP")
		SIF TCVAR:ARG:LOCAL == 0
			CONTINUE
		;AbnormalEXPは弾く
		SIF LOCAL == 50
			CONTINUE
		SIF ARGS == "表示"
			PRINTFORML %EXPNAME_E(LOCAL),12, LEFT% {EXP:ARG:LOCAL,16,RIGHT}      \@TCVAR:ARG:LOCAL > 0 ?+#-\@{ABS(TCVAR:ARG:LOCAL),16,RIGHT} = {EXP:ARG:LOCAL + TCVAR:ARG:LOCAL,16,RIGHT}
		;PALAM:ARG:LOCAL += CUP:ARG:LOCAL - CDOWN:ARG:LOCAL
		;拡張初体験の場合ここでAbnormalEXP付与
		SIF GROUPMATCH(EXPNAME:LOCAL , "Ｖ拡張経験" , "Ａ拡張経験")
			CALL ADDS_ABNORMAL_EXP, "Expansion first experience" , ARG
		;獣姦初体験の場合ここでAbnormalEXP付与
		SIF EXPNAME:LOCAL == "獣姦経験"
			CALL ADDS_ABNORMAL_EXP, "Bestiality" , ARG
		;ふたなり・TSして男になったキャラの射精の場合ここでAbnormalEXP付与
		SIF EXPNAME:LOCAL == "射精経験" && (!IS_MALE(ARG) || EXP:ARG:ＴＳ経験 % 2 == 1)
			CALL ADDS_ABNORMAL_EXP, "Ejaculation" , ARG
		EXP:ARG:LOCAL += TCVAR:ARG:LOCAL
		TCVAR:ARG:LOCAL = 0
	NEXT
ENDIF

;-------------------------------------------------
;AbnormalEXP付与関数
;TRAIN_FUNCTIONに置きたいところだけど、上記関数と場所わけるべきじゃないよなぁということで
;両方まとめてSOURCEか、FANCTIONかどっちかだと思います
;-------------------------------------------------
@ADDS_ABNORMAL_EXP, ARGS, ARG = -1
#LOCALSIZE 1
;TCVAR:50は獲得異常経験
CALL TRANSLATE_ABNORMAL_EXP(ARGS)
ARGS = %RESULTS%
SIF ARG == -1
	ARG = TARGET
LOCAL = NUM_ABNORMAL_EXP(ARGS)
IF LOCAL == -1
	SETCOLOR COLOR("red")
	PRINTFORML AbnormalEXP付与関数の指定が間違っています(指定されたARGS：%ARGS%)
	PRINTW 申し訳ありませんが、このメッセージが出た状況を報告してください
	RESETCOLOR
	TWAIT 1, 1
	WAIT
ENDIF
SIF !GETBIT(CFLAG:ARG:異常経験記録, LOCAL)
	SETBIT TCVAR:ARG:獲得異常経験 , LOCAL

;-------------------------------------------------
;AbnormalEXP表示
;-------------------------------------------------
@SHOW_ABNORMAL_EXP, ARG, テキストあり = 1
#DIM テキストあり
#LOCALSIZE 2
SIF ARG < 0
	RETURN 0
SIF !TCVAR:ARG:50
	RETURN 0
DRAWLINE
IF テキストあり
	SETCOLOR COLOR("red")
	PRINTFORML AbnormalEXP aquired(%CALLNAME:ARG%)
;獲得
	RESETCOLOR
ENDIF
FOR LOCAL, 0, 64
	SIF !GETBIT(TCVAR:ARG:50, LOCAL)
		CONTINUE
	LOCAL:1 = RANK_ABNORMAL_EXP( , LOCAL)
	SIF テキストあり
		PRINTFORML 【＋%TOFULL(TOSTR(LOCAL:1))%】   %NAME_ABNORMAL_EXP(LOCAL)%
	EXP:ARG:異常経験 += LOCAL:1
	SETBIT CFLAG:ARG:異常経験記録 , LOCAL
NEXT
TCVAR:ARG:50 = 0
IF テキストあり
	TWAIT 1, 1
	WAIT
ENDIF
;-------------------------------------------------
;AbnormalEXPに関する式中関数群
;@NAME_ABNORMAL_EXP(ARG , ARGS)　：ARG番にあたる異常経験名を返す
;@NUM_ABNORAML_EXP(ARGS)　　　　 ：指定されたAbnormalEXP(ARGS)の番号を返す
;@RANK_ABNORMAL_EXP(ARGS , ARG)　：指定されたAbnormalEXP(ARGSもしくはARG)を経験した場合に獲得するAbnormalEXPの値を返す
;-------------------------------------------------
@NAME_ABNORMAL_EXP(ARG = -1 , ARGS = "")
#FUNCTIONS
#LOCALSSIZE 1
#DIMS 異常経験名 , 64
IF 異常経験名 == ""
	LOCALS += "Lost virginity（Cowgirl）"
	LOCALS += "_Lost virginity（Vibrator）"
	LOCALS += "_Lost virginity（Tentacles）"
	LOCALS += "_Lost virginity（３Ｐ）"
	LOCALS += "_Lost virginity（Gang rape）"
	LOCALS += "_Lost virginity（Eel bath）"
	LOCALS += "_Lost virginity（Wooden horse）"
	LOCALS += "_Lost virginity（Prostitution）"
	LOCALS += "_Lost virginity（Filming）"
	LOCALS += "_Lost virginity（Same sex）"
	LOCALS += "_Lost virginity（Fairy onahole）"
	LOCALS += "_Take Virginity（Same Sex）"
	LOCALS += "_Public masturbation"
	LOCALS += "_Expansion first experience"
	LOCALS += "_Outdoor urination"
	LOCALS += "_Electrode"
	LOCALS += "_Insect bath"
	LOCALS += "_Eel bath"
	LOCALS += "_Tentacle first experience"
	LOCALS += "_Bestiality"
	LOCALS += "_Ejaculation"
	LOCALS += "_ＴＳ ＶCum"
	LOCALS += "_Mammary gland development"
	LOCALS += "_Milk Geyser"
	LOCALS += "_Pain seal LV3"
	LOCALS += "_Pain seal LV3（Sadist）"
	LOCALS += "_Pain seal LV3（Needle Mastery）"
	LOCALS += "_Enema first experience"
	LOCALS += "_Incest（Father）"
	LOCALS += "_Incest（Mother）"
	LOCALS += "_Incest（Brother）"
	LOCALS += "_Incest（Sister）"
	LOCALS += "_Incest（Daughter）"
	LOCALS += "_Incest（Son）"
	LOCALS += "_ＴＳ"
	LOCALS += "_Drinking urine"
	LOCALS += "_Lost virginity（Random passerby）"
	LOCALS += "_Lost virginity（Public toilet）"
	LOCALS += "_Lost virginity（Rape）"
	LOCALS += "_Lost virginity（ＮＴＲ）"

	SPLIT LOCALS , "_" , 異常経験名
ENDIF
IF ARGS == ""
	RETURNF 異常経験名:ARG
ELSE
	RETURNF TOSTR(FINDELEMENT(異常経験名 , ARGS , , , 1))
ENDIF

@NUM_ABNORMAL_EXP(ARGS)
#FUNCTION
RETURNF TOINT(NAME_ABNORMAL_EXP(, ARGS))


;AbnormalEXP毎の加算数値
@RANK_ABNORMAL_EXP(ARGS = "" , ARG = -1)
#FUNCTION
#LOCALSIZE 1
LOCALS = \@ ARGS != "" ? %ARGS% # %NAME_ABNORMAL_EXP(ARG)% \@
SELECTCASE LOCALS
	;可読性の為、あえて同じ数値でも複数行に分けて書いてみる
	CASE "処女喪失(同性+助手+騎乗位)" , "処女喪失(同性+助手+騎乗位する)"
		RETURNF 3
	CASE "Lost virginity（Cowgirl）" , "Lost virginity（Tentacles）" , "Lost virginity（３Ｐ）" , "Lost virginity（Gang rape）" , "Lost virginity（Random passerby）" , "Lost virginity（Eel bath）" , "Lost virginity（Public toilet）" , "Lost virginity（Rape）", "Lost virginity（ＮＴＲ）"
		RETURNF 2
	CASE "Lost virginity（Wooden horse）" , "Insect bath" , "Pain seal LV3（Sadist）" , "Pain seal LV3（Needle Mastery）"
		RETURNF 2
	CASE "Eel bath" , "処女喪失(騎乗位する)"
		RETURNF 2
	CASE "Lost virginity（Vibrator）" , "Lost virginity（Filming）" , "Take Virginity（Same Sex）" , "Lost virginity（Same sex）" , "Public masturbation"
		RETURNF 1
	CASE "Expansion first experience" , "Outdoor urination" , "Electrode" , "Tentacle first experience" , "Bestiality" , "Ejaculation" , "Mammary gland development" , "Milk Geyser"
		RETURNF 1
	CASE "Pain seal LV3" , "Enema first experience" , "Lost virginity（Fairy onahole）" , "ＴＳ ＶCum" , "ＴＳ" , "Drinking urine"
		RETURNF 1
	CASE "Incest（Father）" , "Incest（Mother）" , "Incest（Brother）" , "Incest（Sister）" , "Incest（Daughter）" , "Incest（Son）"
		RETURNF 1
	CASEELSE
		SETCOLOR COLOR("red")
		PRINTFORML %LOCALS%なんて異常経験名設定されて無いです
		PRINTL AbnormalEXP獲得の表示関数の指定が間違っています
		PRINTL 申し訳ありませんが、このメッセージが出た状況を報告してください
		RESETCOLOR
ENDSELECT

