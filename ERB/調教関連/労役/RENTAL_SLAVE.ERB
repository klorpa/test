;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#
;
;	Module		:RENTAL_SLAVE.ERB
;	Facility	:ストリップ劇場での労役に関する関数群です。
;
;	Licence		:ライセンスフリー
;
;	Modification Data:
;
;	Edit	Date			Author					Reason
;	001		20XX/XX/XX		----					新規作成
;	002		2011/09/08		黒天					処女(再生処女)喪失処理を関数を呼ぶように修正
;	003		2013/11/24		ひみつ					リスト表示数設定
;	004		2017/06/23		kuni					キャラ表示でINPUT_CHARA_LISTを使用するように変更
;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#


;奴隷レンタルの処理
;期日に応じて奴隷を顧客に貸し出します。より従順で献身的な奴隷が好まれ、レンタル金額が高くなります。
;特殊レンタルの処理を追加、ARGが真の時実行でARGの数値の日数だけ無報酬でレンタルされる
@RENTAL_SLAVE(ARG, ARG:1)
;使用する変数の初期化
A = 0
B = 0
S = 0
V = 0
C = 0
D = 0


CALL INPUT_CHARA_LIST("Please pick a character for part-time work", "CASTING_RENTAL_SLAVE")
IF RESULT == 1000
	RETURN 0
ENDIF

A = RESULT
;レンタル期間の選択
;服従は初期は1日と3日のみ。総レンタル日数が5日以上で5日、10日以上で10日が開放
;隷属は全開放
;特殊は指定された日数になる
IF ARG
	B = ARG
ELSE
	PRINTL レンタル期間を選択してください
	SIF BASE:A:0 > 500
		PRINTL [0]   -   １日
	SIF BASE:A:0 > 800
		PRINTL [1]   -   ３日
	SIF BASE:A:0 > 1000 && (CFLAG:A:レンタルされた総日数 >= 5 || TALENT:A:8)
		PRINTL [2]   -   ５日
	SIF BASE:A:0 > 1500 && (CFLAG:A:レンタルされた総日数 >= 10 || TALENT:A:8)
		PRINTL [3]   - １０日
	PRINTL [100] -   Return
	$INPUT_LOOP_2
	INPUT
	IF RESULT == 0 && BASE:A:0 > 500
		B = 1
	ELSEIF RESULT == 1 && BASE:A:0 > 800
		B = 3
	ELSEIF RESULT == 2 && BASE:A:0 > 1000 && (CFLAG:A:レンタルされた総日数 >= 5 || TALENT:A:8)
		B = 5
	ELSEIF RESULT == 3 && BASE:A:0 > 1500 && (CFLAG:A:レンタルされた総日数 >= 10 || TALENT:A:8)
		B = 10
	ELSEIF RESULT == 100
		RETURN 0
	ELSE
		GOTO INPUT_LOOP_2
	ENDIF
ENDIF

;避妊の選択、コンドームは安価だが報酬が下がる。しない場合は妊娠の確立が上がる。避妊結界は報酬は下がらないが、高価。
;PRINTL 避妊の有無と方法を選択してください
;PRINTL [0]   - 避妊しない
;SIF MONEY > B * 5 * 100
;	PRINTFORML [1]   - Condom(￥-{B*500}、レンタル額ペナルティ）
;SIF MONEY > B * 2000
;	PRINTFORML [2]   - Contraceptive barrier(￥-{B*2000}）
;PRINTL [100] -   Return
;$INPUT_LOOP_3
;INPUT
;IF RESULT == 0
;	D = 0
;ELSEIF RESULT == 1 && MONEY > B * 500
;	D = B * 500
;ELSEIF RESULT == 2 && MONEY > B * 2000
;	D = B * 2000
;	;当日分の避妊結界処理
;	IF CFLAG:A:108
;		D -= 2000
;		SIF D == 0
;			D = -1
;	ENDIF
;ELSEIF RESULT == 100
;	RETURN 0
;ELSE
;	GOTO INPUT_LOOP_3
;ENDIF


;レンタル金額の計算
;ABLによる基礎値計算
V = 0
;ABL:従順をみる
IF ABL:A:0 == 0
	V = 1
ELSEIF ABL:A:0 == 1
	V = 2
ELSEIF ABL:A:0 == 2
	V = 2
ELSEIF ABL:A:0 == 3
	V = 3
ELSEIF ABL:A:0 == 4
	V = 3
ELSEIF ABL:A:0 == 5
	V = 4
ELSEIF ABL:A:0 == 6
	V = 5
ELSEIF ABL:A:0 == 7
	V = 6
ELSEIF ABL:A:0 == 8
	V = 7
ELSEIF ABL:A:0 == 9
	V = 8
ELSE
	V = 10
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(0)%{ABL:A:0}LV +{V}
S += V


;ABL:欲望をみる
IF ABL:A:1 == 0
	V = 0
ELSEIF ABL:A:1 == 1
	V = 1
ELSEIF ABL:A:1 == 2
	V = 1
ELSEIF ABL:A:1 == 3
	V = 2
ELSEIF ABL:A:1 == 4
	V = 2
ELSEIF ABL:A:1 == 5
	V = 3
ELSEIF ABL:A:1 == 6
	V = 4
ELSEIF ABL:A:1 == 7
	V = 5
ELSEIF ABL:A:1 == 8
	V = 6
ELSEIF ABL:A:1 == 9
	V = 7
ELSE
	V = 8
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(1)%{ABL:A:1}LV +{V}
S += V


;ABL:技巧をみる
IF ABL:A:2 == 0
	V = 0
ELSEIF ABL:A:2 == 1
	V = 1
ELSEIF ABL:A:2 == 2
	V = 1
ELSEIF ABL:A:2 == 3
	V = 1
ELSEIF ABL:A:2 == 4
	V = 2
ELSEIF ABL:A:2 == 5
	V = 2
ELSEIF ABL:A:2 == 6
	V = 3
ELSEIF ABL:A:2 == 7
	V = 3
ELSEIF ABL:A:2 == 8
	V = 4
ELSEIF ABL:A:2 == 9
	V = 5
ELSE
	V = 6
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(2)%{ABL:A:2}LV +{V}
S += V


;ABL:Ｃ感覚をみる
IF ABL:A:3 == 0
	V = 0
ELSEIF ABL:A:3 == 1
	V = 1
ELSEIF ABL:A:3 == 2
	V = 1
ELSEIF ABL:A:3 == 3
	V = 1
ELSEIF ABL:A:3 == 4
	V = 2
ELSEIF ABL:A:3 == 5
	V = 2
ELSEIF ABL:A:3 == 6
	V = 3
ELSEIF ABL:A:3 == 7
	V = 3
ELSEIF ABL:A:3 == 8
	V = 4
ELSEIF ABL:A:3 == 9
	V = 4
ELSE
	V = 5
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(3)%{ABL:A:3}LV +{V}
S += V


;ABL:Ｖ感覚をみる
IF ABL:A:4 == 0
	V = 0
ELSEIF ABL:A:4 == 1
	V = 1
ELSEIF ABL:A:4 == 2
	V = 1
ELSEIF ABL:A:4 == 3
	V = 1
ELSEIF ABL:A:4 == 4
	V = 2
ELSEIF ABL:A:4 == 5
	V = 2
ELSEIF ABL:A:4 == 6
	V = 3
ELSEIF ABL:A:4 == 7
	V = 3
ELSEIF ABL:A:4 == 8
	V = 4
ELSEIF ABL:A:4 == 9
	V = 4
ELSE
	V = 5
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(4)%{ABL:A:4}LV +{V}
S += V


;ABL:Ａ感覚をみる
IF ABL:A:5 == 0
	V = 0
ELSEIF ABL:A:5 == 1
	V = 1
ELSEIF ABL:A:5 == 2
	V = 1
ELSEIF ABL:A:5 == 3
	V = 1
ELSEIF ABL:A:5 == 4
	V = 2
ELSEIF ABL:A:5 == 5
	V = 2
ELSEIF ABL:A:5 == 6
	V = 3
ELSEIF ABL:A:5 == 7
	V = 3
ELSEIF ABL:A:5 == 8
	V = 4
ELSEIF ABL:A:5 == 9
	V = 4
ELSE
	V = 5
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(5)%{ABL:A:5}LV +{V}
S += V


;ABL:Ｂ感覚をみる
IF ABL:A:6 == 0
	V = 0
ELSEIF ABL:A:6 == 1
	V = 1
ELSEIF ABL:A:6 == 2
	V = 1
ELSEIF ABL:A:6 == 3
	V = 1
ELSEIF ABL:A:6 == 4
	V = 2
ELSEIF ABL:A:6 == 5
	V = 2
ELSEIF ABL:A:6 == 6
	V = 3
ELSEIF ABL:A:6 == 7
	V = 3
ELSEIF ABL:A:6 == 8
	V = 4
ELSEIF ABL:A:6 == 9
	V = 4
ELSE
	V = 5
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(6)%{ABL:A:6}LV +{V}
S += V


;ABL:奉仕精神をみる
IF ABL:A:7 == 0
	V = 0
ELSEIF ABL:A:7 == 1
	V = 1
ELSEIF ABL:A:7 == 2
	V = 2
ELSEIF ABL:A:7 == 3
	V = 2
ELSEIF ABL:A:7 == 4
	V = 3
ELSEIF ABL:A:7 == 5
	V = 3
ELSEIF ABL:A:7 == 6
	V = 4
ELSEIF ABL:A:7 == 7
	V = 5
ELSEIF ABL:A:7 == 8
	V = 6
ELSEIF ABL:A:7 == 9
	V = 7
ELSE
	V = 8
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(7)%{ABL:A:7}LV +{V}
S += V


;ABL:露出癖をみる
IF ABL:A:8 == 0
	V = 0
ELSEIF ABL:A:8 == 1
	V = 1
ELSEIF ABL:A:8 == 2
	V = 1
ELSEIF ABL:A:8 == 3
	V = 1
ELSEIF ABL:A:8 == 4
	V = 2
ELSEIF ABL:A:8 == 5
	V = 2
ELSEIF ABL:A:8 == 6
	V = 3
ELSEIF ABL:A:8 == 7
	V = 3
ELSEIF ABL:A:8 == 8
	V = 4
ELSEIF ABL:A:8 == 9
	V = 4
ELSE
	V = 5
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(8)%{ABL:A:8}LV +{V}
S += V


;ABL:マゾっ気をみる
IF ABL:A:9 == 0
	V = 0
ELSEIF ABL:A:9 == 1
	V = 1
ELSEIF ABL:A:9 == 2
	V = 2
ELSEIF ABL:A:9 == 3
	V = 3
ELSEIF ABL:A:9 == 4
	V = 4
ELSEIF ABL:A:9 == 5
	V = 4
ELSEIF ABL:A:9 == 6
	V = 5
ELSEIF ABL:A:9 == 7
	V = 5
ELSEIF ABL:A:9 == 8
	V = 5
ELSEIF ABL:A:9 == 9
	V = 5
ELSE
	V = 6
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(9)%{ABL:A:9}LV +{V}
S += V


;ABL:サドっ気をみる
IF ABL:A:10 == 0
	V = 0
ELSEIF ABL:A:10 == 1
	V = 1
ELSEIF ABL:A:10 == 2
	V = 1
ELSEIF ABL:A:10 == 3
	V = 1
ELSEIF ABL:A:10 == 4
	V = 2
ELSEIF ABL:A:10 == 5
	V = 2
ELSEIF ABL:A:10 == 6
	V = 3
ELSEIF ABL:A:10 == 7
	V = 3
ELSEIF ABL:A:10 == 8
	V = 4
ELSEIF ABL:A:10 == 9
	V = 4
ELSE
	V = 5
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(10)%{ABL:A:10}LV +{V}
S += V


;ABL:精液中毒をみる
IF ABL:A:16 == 0
	V = 0
ELSEIF ABL:A:16 == 1
	V = 1
ELSEIF ABL:A:16 == 2
	V = 1
ELSEIF ABL:A:16 == 3
	V = 2
ELSEIF ABL:A:16 == 4
	V = 2
ELSEIF ABL:A:16 == 5
	V = 3
ELSEIF ABL:A:16 == 6
	V = 3
ELSEIF ABL:A:16 == 7
	V = 4
ELSEIF ABL:A:16 == 8
	V = 5
ELSEIF ABL:A:16 == 9
	V = 6
ELSE
	V = 7
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(16)%{ABL:A:16}LV +{V}
S += V


;ABL:セックス中毒をみる
IF ABL:A:18 == 0
	V = 0
ELSEIF ABL:A:18 == 1
	V = 1
ELSEIF ABL:A:18 == 2
	V = 2
ELSEIF ABL:A:18 == 3
	V = 2
ELSEIF ABL:A:18 == 4
	V = 3
ELSEIF ABL:A:18 == 5
	V = 3
ELSEIF ABL:A:18 == 6
	V = 4
ELSEIF ABL:A:18 == 7
	V = 5
ELSEIF ABL:A:18 == 8
	V = 6
ELSEIF ABL:A:18 == 9
	V = 6
ELSE
	V = 7
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME_E(18)%{ABL:A:18}LV +{V}
S += V


V = 100
;素質による売却額補正値計算
;TALENT:処女をみる
IF TALENT:A:0
	C = 100
	V += 100
	PRINTFORML %TALENTNAME_E(0)% ＋{C}％
ENDIF
;TALENT:再生処女をみる
IF TALENT:A:1
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(1)% ＋{C}％
ENDIF
;素質による増減
;陥落素質
;恋慕
IF TALENT:A:3
	C = 50
	V -= 50
	PRINTFORML %TALENTNAME_E(3)% ‐{C}％
ENDIF
;淫乱
IF TALENT:A:4
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(4)% ＋{C}％
ENDIF
;服従
IF TALENT:A:5
	C = 50
	V += 50
	PRINTFORML %TALENTNAME_E(5)% ＋{C}％
ENDIF
;親愛
IF TALENT:A:6
	C = 80
	V -= 80
	PRINTFORML %TALENTNAME_E(6)% ‐{C}％
ENDIF
;娼婦
IF TALENT:A:7
	C = 60
	V += 60
	PRINTFORML %TALENTNAME_E(7)% ＋{C}％
ENDIF
;隷属
IF TALENT:A:8
	C = 100
	V += 100
	PRINTFORML %TALENTNAME_E(8)% ＋{C}％
ENDIF



;その他素質
;臆病
IF TALENT:A:10
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(10)% ‐{C}％
ENDIF
;反抗的
IF TALENT:A:11
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(11)% ＋{C}％
ENDIF
;気丈
IF TALENT:A:12
	C = 40
	V += 40
	PRINTFORML %TALENTNAME_E(12)% ＋{C}％
ENDIF
;素直
IF TALENT:A:13
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(13)% ‐{C}％
ENDIF
;大人しい
IF TALENT:A:14
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(14)% ‐{C}％
ENDIF
;プライド高い
IF TALENT:A:15
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(15)% ＋{C}％
ENDIF
;生意気
IF TALENT:A:16
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(16)% ＋{C}％
ENDIF
;プライド低い
IF TALENT:A:17
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(17)% ‐{C}％
ENDIF
;ツンデレ
IF TALENT:A:18
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(18)% ＋{C}％
ENDIF
;自制心
IF TALENT:A:20
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(20)% ＋{C}％
ENDIF
;無関心
IF TALENT:A:21
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(21)% ‐{C}％
ENDIF
;感情乏しい
IF TALENT:A:22
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(22)% ‐{C}％
ENDIF
;好奇心
IF TALENT:A:23
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(23)% ＋{C}％
ENDIF
;保守的
IF TALENT:A:24
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(24)% ＋{C}％
ENDIF
;一線越えない
IF TALENT:A:27
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(27)% ＋{C}％
ENDIF
;目立ちたがり
IF TALENT:A:28
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(28)% ＋{C}％
ENDIF
;貞操観念
IF TALENT:A:30
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(30)% ＋{C}％
ENDIF
;貞操無頓着
IF TALENT:A:31
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(31)% ‐{C}％
ENDIF
;解放
IF TALENT:A:33
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(33)% ＋{C}％
ENDIF
;恥じらい
IF TALENT:A:35
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(35)% ＋{C}％
ENDIF
;恥薄い
IF TALENT:A:36
	C = 10
	V -= 10
	PRINTFORML %TALENTNAME_E(36)% ‐{C}％
ENDIF
;痛みに弱い
IF TALENT:A:40
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(40)% ‐{C}％
ENDIF
;痛みに強い
IF TALENT:A:41
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(41)% ＋{C}％
ENDIF
;濡れやすい
IF TALENT:A:42
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(42)% ＋{C}％
ENDIF
;濡れにくい
IF TALENT:A:43
	C = 10
	V -= 10
	PRINTFORML %TALENTNAME_E(43)% ‐{C}％
ENDIF
;習得早い
IF TALENT:A:50
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(50)% ＋{C}％
ENDIF
;習得遅い
IF TALENT:A:51
	C = 10
	V -= 10
	PRINTFORML %TALENTNAME_E(51)% ‐{C}％
ENDIF
;舌使い
IF TALENT:A:52
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(52)% ＋{C}％
ENDIF
;薬毒耐性
IF TALENT:A:56
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(56)% ‐{C}％
ENDIF
;おもらし癖
IF TALENT:A:57
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(57)% ＋{C}％
ENDIF
;自慰しやすい
IF TALENT:A:60
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(60)% ＋{C}％
ENDIF
;汚臭鈍感
IF TALENT:A:61
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(61)% ‐{C}％
ENDIF
;汚臭敏感
IF TALENT:A:62
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(62)% ＋{C}％
ENDIF
;献身的
IF TALENT:A:63
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(63)% ＋{C}％
ENDIF
;快感に素直
IF TALENT:A:70
	C = 30
	V -= 30
	PRINTFORML %TALENTNAME_E(70)% ‐{C}％
ENDIF
;快感の否定
IF TALENT:A:71
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(71)% ＋{C}％
ENDIF
;即落ち
IF TALENT:A:73
	C = 50
	V -= 50
	PRINTFORML %TALENTNAME_E(73)% ‐{C}％
ENDIF
;自慰狂い
IF TALENT:A:74
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(74)% ＋{C}％
ENDIF
;セックス狂
IF TALENT:A:75
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(75)% ＋{C}％
ENDIF
;尻穴狂い
IF TALENT:A:76
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(76)% ＋{C}％
ENDIF
;淫乳
IF TALENT:A:77
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(77)% ＋{C}％
ENDIF
;倒錯的
IF TALENT:A:80
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(80)% ＋{C}％
ENDIF
;男嫌い
IF TALENT:A:82
	C = 10
	V -= 10
	PRINTFORML %TALENTNAME_E(82)% ‐{C}％
ENDIF
;サド
IF TALENT:A:83
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(83)% ＋{C}％
ENDIF
;マゾ
IF TALENT:A:84
	C = 40
	V += 40
	PRINTFORML %TALENTNAME_E(84)% ＋{C}％
ENDIF
;妄信
IF TALENT:A:86
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(86)% ＋{C}％
ENDIF
;女嫌い
IF TALENT:A:88
	C = 10
	V -= 10
	PRINTFORML %TALENTNAME_E(88)% ‐{C}％
ENDIF
;小悪魔
IF TALENT:A:87
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(87)% ＋{C}％
ENDIF
;妖狐
IF TALENT:A:91
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(91)% ＋{C}％
ENDIF
;魅力
IF TALENT:A:92
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(92)% ＋{C}％
ENDIF
;謎の魅力
IF TALENT:A:94
	C = 100
	V += 100
	PRINTFORML %TALENTNAME_E(94)% ＋{C}％
ENDIF
;ＣInsensitive（感覚が4以上なら無効）
IF TALENT:A:101 && ABL:A:3 < 4
	C = 30
	V -= 30
	PRINTFORML %TALENTNAME_E(101)% ‐{C}％
ENDIF
;ＣSensitive（感覚が3未満なら無効）
IF TALENT:A:102 && ABL:A:3 >= 3
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(102)% ＋{C}％
ENDIF
;ＶInsensitive（感覚が4以上なら無効）
IF TALENT:A:103 && ABL:A:4 < 4
	C = 30
	V -= 30
	PRINTFORML %TALENTNAME_E(103)% ‐{C}％
ENDIF
;ＶSensitive（感覚が3未満なら無効）
IF TALENT:A:104 && ABL:A:4 >= 3
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(104)% ＋{C}％
ENDIF
;ＡInsensitive（感覚が4以上なら無効）
IF TALENT:A:105 && ABL:A:5 < 4
	C = 30
	V -= 30
	PRINTFORML %TALENTNAME_E(105)% ‐{C}％
ENDIF
;ＡSensitive（感覚が3未満なら無効）
IF TALENT:A:106 && ABL:A:5 >= 3
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(106)% ＋{C}％
ENDIF
;ＢInsensitive（感覚が4以上なら無効）
IF TALENT:A:107 && ABL:A:6 < 4
	C = 30
	V -= 30
	PRINTFORML %TALENTNAME_E(107)% ‐{C}％
ENDIF
;ＢSensitive（感覚が3未満なら無効）
IF TALENT:A:108 && ABL:A:6 >= 3
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(108)% ＋{C}％
ENDIF
;貧乳
IF TALENT:A:109
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(109)% ‐{C}％
ENDIF
;絶壁
IF TALENT:A:110
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(110)% ＋{C}％
ENDIF
;巨乳
IF TALENT:A:111
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(111)% ＋{C}％
ENDIF
;爆乳
IF TALENT:A:112
	C = 10
	V += 10
	PRINTFORML %TALENTNAME_E(112)% ＋{C}％
ENDIF
;回復早い
IF TALENT:A:130
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(130)% ＋{C}％
ENDIF
;回復遅い
IF TALENT:A:131
	C = 20
	V -= 20
	PRINTFORML %TALENTNAME_E(131)% ‐{C}％
ENDIF
;吸血鬼
IF TALENT:A:132
	C = 30
	V += 30
	PRINTFORML %TALENTNAME_E(132)% ＋{C}％
ENDIF
;動物耳
IF TALENT:A:143
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(143)% ＋{C}％
ENDIF
;人気
IF TALENT:A:145
	C = 50
	V += 50
	PRINTFORML %TALENTNAME_E(145)% ＋{C}％
ENDIF
;蓬莱人
IF TALENT:A:147
	C = 70
	V += 70
	PRINTFORML %TALENTNAME_E(147)% ＋{C}％
ENDIF
;母乳体質
IF TALENT:A:149
	C = 20
	V += 20
	PRINTFORML %TALENTNAME_E(149)% ＋{C}％
ENDIF

;補正値が0以下の場合は1にする
SIF V <= 0
	V = 1

PRINTFORML Total Bonus {V}％

;補正値の適用
S *= V / 100


;崩壊,狂気,妊娠は報酬をかなり低くする（従順によって、80％まで回復）
IF TALENT:A:9 || TALENT:A:141 || TALENT:A:153
PRINTL 
	IF TALENT:A:9
		S *= ABL:A:0
		TIMES S , 0.08
		Z = ABL:A:0
		Z *= 8
		PRINTFORML %TALENTNAME_E(9)% ×{Z}％
	ELSEIF TALENT:A:141
		S *= ABL:A:0
		TIMES S , 0.08
		Z = ABL:A:0
		Z *= 8
		PRINTFORML %TALENTNAME_E(141)% ×{Z}％
	ELSEIF TALENT:A:153
		S *= ABL:A:0
		TIMES S , 0.08
		Z = ABL:A:0
		Z *= 8
		PRINTFORML %TALENTNAME_E(153)% ×{Z}％
	ENDIF
PRINTL 
ENDIF


;レンタル日数による補正
IF B == 1
	TIMES S , 0.60
ELSEIF B == 3
	TIMES S , 3.00
ELSEIF B == 5
	TIMES S , 5.40
ELSEIF B == 10
	TIMES S , 11.00
ENDIF

;コンドームの場合は、レンタル額にペナルティ補正がかかる
SIF D/B == 500
	TIMES S , 0.80


;難易度処理
;EASY
IF FLAG:4 == 1
	PRINTFORML Difficulty:EASY ×120％
	TIMES S , 1.20
;NORMAL
ELSEIF FLAG:4 == 2
	TIMES S , 1.00
;HARD
ELSEIF FLAG:4 == 3
	PRINTFORML Difficulty:HARD ×80％
	TIMES S , 0.80
ENDIF

S *= 2

;引継ぎキャラ
IF CFLAG:A:引継ぎ回数 > 0 && FLAG:5 < 9 && S > 0 && CHECK_TIMELIMIT(0,DAY < 51,1)
	PRINTFORML Carried-over character： × 0.01
	S /= 100
	SIF S < 6
		S = 6
ENDIF
;レンタルを実行するか？
;特殊実行の場合はARG:1の要求ハードルを超えてなければならない
IF ARG
	IF S > ARG:1
		PRINTFORML 奴隷のレンタル額は{S}魔貨相当になります
	ELSE
		PRINTFORML 奴隷のレンタル額は{S}魔貨相当になりますが、
		PRINTFORMW クライアントはこの奴隷では満足できないようなので中止します
		RETURN 0
	ENDIF
ELSEIF S > 0
	PRINTFORML レンタル額は{S}魔貨になります
ELSE
	PRINTFORMW レンタル額が0魔貨を下回ったので、中止します
	RETURN 0
ENDIF
PRINTFORML Will %CALLNAME:A% be lent to work here?
;をレンタルしますか？
;---- EDIT INPUT_YN追加対応(2011/02/03) MOD START -------------------------
CALL INPUT_YN,"実行する","やめる"
;---- EDIT INPUT_YN追加対応(2011/02/03) MOD END ---------------------------
IF RESULT == 0
	PRINTFORML %CALLNAME:A%をレンタルしました
	IF D > 0
		PRINTFORML 避妊具の費用として、￥{D}を使いました
		MONEY -= D
	ENDIF
	CFLAG:A:レンタルされた総日数 += B
	CFLAG:A:労役フラグ = 3
	CFLAG:A:13 = B
	CFLAG:A:14 = B
	CFLAG:A:15 = S
	;未調教陥落フラグを折る
	CFLAG:A:被調教回数 += 1
	;特殊レンタルは値段を0に
	SIF ARG
		CFLAG:A:15 = 0
	CFLAG:A:16 = D
	FOR LOCAL, 0, 4
		SIF TARGET:LOCAL == A
			TARGET:LOCAL = -1
		SIF LOCAL == 3
			CONTINUE
		SIF ASSI:LOCAL == A
			ASSI:LOCAL = -1
	NEXT
;	SIF A == TARGET
;		TARGET = -1
;	SIF A == ASSI
;		ASSI = -1
	SIF CPOS(A) > 0
		CALL REMOVE_POSITION,CPOS(A)
	;成否をみるためにRETURN 1させる
	RETURN 1
;---- EDIT INPUT_YN追加対応(2011/02/03) MOD START -------------------------
ELSE
	RETURN 0
;---- EDIT INPUT_YN追加対応(2011/02/03) MOD END ---------------------------
ENDIF

@CASTING_RENTAL_SLAVE
SIF COUNT == MASTER
	RETURN 0
SIF CFLAG:COUNT:売却可能 < 1
	RETURN 0
SIF CFLAG:COUNT:労役フラグ > 0
	RETURN 0
SIF (ABL:COUNT:従順 + ABL:COUNT:奉仕精神 + ABL:COUNT:欲望 + TALENT:COUNT:服従*3 + TALENT:COUNT:隷属*6) < 6
	RETURN 0
SIF BASE:COUNT:0 <= 500
	RETURN 0
SIF CFLAG:COUNT:この場に居ないフラグ == 1
	RETURN 0
RETURN 1

;レンタルの結果は返却時に処理
@RETURN_SLAVE,ARG
CFLAG:ARG:13 -= 1
SIF CFLAG:ARG:13 > 0
	RETURN 0

CUSTOMDRAWLINE ･
PRINTFORML %CALLNAME:ARG%の貸出結果：
PRINTL 

PRINTFORML 貸し出されていた%CALLNAME:ARG%が帰ってきた

;補完してたフラグを変数に代入
B = CFLAG:ARG:14
V = CFLAG:ARG:15
H = CFLAG:ARG:16

;体力の減少
;一日
SIF  B == 1
	BASE:ARG:0 -= 500
;三日
SIF  B == 3
	BASE:ARG:0 -= 800
;五日
SIF  B == 5
	BASE:ARG:0 -= 1000
;十日
SIF  B == 10
	BASE:ARG:0 -= 1500

;ストレス値の付加
CFLAG:ARG:10 += B

;経験、珠の加算処理
D = 0
E = 0
F = 0
G = 0
;セックス系
;VとAのプレイ差
;オトコはAのみ
IF TALENT:ARG:140
	D = ABL:ARG:5
	E = 0
	F = B
ELSEIF ABL:ARG:4 > ABL:ARG:5
	D = ABL:ARG:4-ABL:ARG:5
	E = (B+D/2)*3
	F = (B-D/2)*3
ELSE
	D = ABL:ARG:5-ABL:ARG:4
	E = (B-D/2)*3
	F = (B+D/2)*3
ENDIF
;奴隷が処女の場合
IF EXP:ARG:0 == 0 && TALENT:ARG:0
	E += 3
	G = 20
ENDIF
SIF E < 0
	E = 0
SIF F < 0
	F = 0
EXP:ARG:0 += E
EXP:ARG:1 += F
EXP:ARG:2 += (E+F)/3
EXP:ARG:キス経験 += MAX(E, 3*B)
;ふたなりかオトコ
SIF TALENT:ARG:139 || TALENT:ARG:140
	EXP:ARG:3 += (E+F)/3
EXP:ARG:4 += (E+F)
;CreampieEXP
IF H == 0
	EXP:ARG:5 += E
	CFLAG:ARG:105 += E/B
ENDIF
JUEL:ARG:1 += E*50
JUEL:ARG:2 += F*50
JUEL:ARG:6 += (E+F)*30
JUEL:ARG:8 += (E+F)*50
JUEL:ARG:100 += (E+F+G)*100/MAX(1,ABL:ARG:0)

;奉仕系
EXP:ARG:20 += B*5
EXP:ARG:22 += B*5
JUEL:ARG:5 += B*10
JUEL:ARG:8 += B*30
JUEL:ARG:100 += B*50/MAX(1,ABL:ARG:0)

;ＳＭ系
IF ABL:ARG:9 >= ABL:ARG:10
	EXP:ARG:30 += B
	JUEL:ARG:10 += B*5
ENDIF
SIF ABL:ARG:10 > ABL:ARG:9
	EXP:ARG:32 += B
JUEL:ARG:8 += B*4
JUEL:ARG:100 += B*10/MAX(1,ABL:ARG:0)


;イベント口上の表示
T = TARGET
TARGET = ARG
TFLAG:13 = 17
CALL KOJO_MESSAGE_EVENT
TARGET = T


PRINTFORML 【%CALLNAME:ARG%の経験と珠】

;経験表示は一括で行う
PRINTFORML KissEXP＋{MAX(E, 3*B)}
SIF E > 0
	PRINTFORML %EXPNAME_E(0)%＋{E}
SIF F > 0
	PRINTFORML %EXPNAME_E(1)%＋{F}
SIF E > 0 || F > 0
	PRINTFORML %EXPNAME_E(2)%＋{(E+F)/3}
SIF TALENT:ARG:139 || TALENT:ARG:140
	PRINTFORML %EXPNAME_E(3)%＋{(E+F)/3}
PRINTFORML %EXPNAME_E(4)%＋{(E+F)}
SIF H == 0 && E > 0
	PRINTFORML %EXPNAME_E(5)%＋{E}
PRINTFORML %EXPNAME_E(20)%＋{B*5}
PRINTFORML %EXPNAME_E(22)%＋{B*5}
SIF ABL:ARG:9 >= ABL:ARG:10
	PRINTFORML %EXPNAME_E(30)%＋{B}
SIF ABL:ARG:10 > ABL:ARG:9
	PRINTFORML %EXPNAME_E(32)%＋{B}
;処女/再生処女喪失
CALL 処女喪失, ARG
CALL 処女喪失イベント, ARG
;珠表示も同様
SIF E > 0
	PRINTFORML %PALAMNAME_E(1)%の珠＋{E*50}
SIF F > 0
	PRINTFORML %PALAMNAME_E(2)%の珠＋{F*50}
PRINTFORML %PALAMNAME_E(5)%の珠＋{B*5}
PRINTFORML %PALAMNAME_E(6)%の珠＋{B*30}
PRINTFORML %PALAMNAME_E(8)%の珠＋{B*50+B*30+B*4}
SIF ABL:ARG:9 >= ABL:ARG:10
	PRINTFORML %PALAMNAME_E(10)%の珠＋{B*5}
PRINTFORML %PALAMNAME_E(100)%の珠＋{((E+F+G)*100+B*60)/MAX(1,ABL:ARG:0)}

;非戦闘員は経験値獲得
IF TALENT:ARG:非戦闘員
	PRINTFORML EXP： +{V*(1+BASE:ARG:LV/5)}
	BASE:ARG:ＥＸＰ += V*(1+BASE:ARG:LV/5)
	;レベルアップ判定
	CALL CHECK_LEVEL_UP,ARG
	;IF TALENT:ARG:非戦闘員 && BASE:ARG:ＥＸＰ >= MAXBASE:ARG:ＥＸＰ
	;	PRINTFORML LEVEL UP!
	;	BASE:ARG:LV += 1
	;	CALL SYNC_STATUS,ARG
	;ENDIF
ENDIF
;ペルソナ使いは装着中のペルソナの経験値獲得
IF TALENT:ARG:ペルソナ使い
	CALL INCREASE_PERSONA_EXP, ARG, V / 10, -1 ,1
	SIF RESULT > 0
		PRINTFORML ペルソナ【\@EQUIP:ARG:装備ペルソナ ? %CSVNAME(DITEMTYPE:(EQUIP:ARG:装備ペルソナ):ペルソナ("NO"), 0)% # %CSVNAME(ABL:ARG:初期ペルソナ, 0)%\@】　EXP：+{RESULT}
ENDIF

;ＮＴＲ進行
IF GETBIT(FLAG:ＮＴＲ機能 , 3)
	;専有奴隷の首輪
	IF (CFLAG:ARG:その他 == 1116 || CFLAG:ARG:その他2 == 1116 || CFLAG:ARG:その他3 == 1116)
		GOTO SKIP_NTR
	ENDIF
	SIF TALENT:ARG:ＮＴＲ == 3
		LOCAL:20 = 30
	SIF TALENT:ARG:15 || TALENT:ARG:16
		LOCAL:21 += 10
	SIF TALENT:ARG:84
		LOCAL:21 += 10
	SIF CFLAG:ARG:現ＮＴＲ進行度 > 10
		LOCAL:22 = 30
	LOCAL:23 = CFLAG:ARG:放置日数
	SIF LOCAL:23 > 20
		LOCAL:23 = 20
	SIF (CFLAG:ARG:その他 == 1117 || CFLAG:ARG:その他2 == 1117 || CFLAG:ARG:その他3 == 1117)
		PRINTFORMW %CALLNAME:ARG%は何とも云えない甘い匂いを纏っている……
;10%の確率でＮＴＲ好きフラグ
	IF RAND:100 < (10 + LOCAL:23)  ||  RAND:100 < LOCAL:20 || (CFLAG:ARG:その他 == 1117 || CFLAG:ARG:その他2 == 1117 || CFLAG:ARG:その他3 == 1117) || TALENT:ARG:73 == 1
		PRINTFORML
		PRINTFORML レンタル先の客は寝取り趣味で有名だったようだ……
		PRINTFORML ・
		PRINTFORML ・・
		PRINTFORMW ・・・
		LOCAL = ((E+F+G)*100+B*60)/MAX(1,ABL:ARG:0/2) * (2-CFLAG:ARG:構ったフラグ) + CFLAG:ARG:放置日数*10
		IF RAND:2 == 0
			CFLAG:ARG:(2092) += LOCAL
		ELSE
			CFLAG:ARG:(2091) -= LOCAL
		ENDIF
		CFLAG:ARG:淫乱度 +=  LOCAL / 4

		IF RAND:100 < (10 + LOCAL:23) || RAND:100 < LOCAL:20 || (CFLAG:ARG:その他 == 1117 || CFLAG:ARG:その他2 == 1117 || CFLAG:ARG:その他3 == 1117) || TALENT:ARG:73 == 1

			IF RAND:110 < 10 + LOCAL:23 + LOCAL:21 + LOCAL:22 || TALENT:ARG:ＮＴＲ == 3 
				IF CFLAG:ARG:隷ＮＴＲ進行度 < 2 && !TALENT:ARG:ＮＴＲ == 3
					CFLAG:ARG:隷ＮＴＲ進行度 = 2
				ENDIF
				IF CFLAG:ARG:108 == 1
					IF B == 1
					CFLAG:ARG:108 -= 1
						PRINTFORMW %CALLNAME:ARG%の子宮内避妊結界が解除されてしまったようだ……
					ENDIF
				ENDIF

				IF RAND:100 < CFLAG:ARG:現ＮＴＲ進行度 * 500 + B
					IF CFLAG:ARG:109 == 0
						CFLAG:ARG:109 += 1
						PRINTFORMW %CALLNAME:ARG%はレンタル先の客に排卵誘発剤を飲まされた……
					ENDIF
				ENDIF

				CFLAG:ARG:淫乱度+= 30 + CFLAG:ARG:現ＮＴＲ進行度*10

				CFLAG:ARG:105 += E/B
   				IF TALENT:ARG:73 == 1
					PRINTFORMW %CALLNAME:ARG%はレンタル先の客にずいぶんと調教されてきたようだ……
				ELSE
					PRINTFORMW %CALLNAME:ARG%はレンタル先の客にずいぶんと調教されてきたようだ……
				ENDIF
				
				LOCAL = ((E+F+G)*100+B*60)/MAX(1,ABL:ARG:0/2) * (2-CFLAG:ARG:構ったフラグ) + CFLAG:ARG:放置日数*10
				IF RAND:2 == 0
					CFLAG:ARG:(2092) += LOCAL
				ELSE
					CFLAG:ARG:(2091) -= LOCAL
				ENDIF

			ELSEIF CFLAG:ARG:隷ＮＴＲ進行度 == 0 
				CFLAG:ARG:隷ＮＴＲ進行度 ++
				CFLAG:ARG:淫乱度+= 30 + CFLAG:ARG:現ＮＴＲ進行度*10
				LOCAL = ((E+F+G)*100+B*60)/MAX(1,ABL:ARG:0/2) * (2-CFLAG:ARG:構ったフラグ) + CFLAG:ARG:放置日数*10
					PRINTFORML %CALLNAME:ARG%に見覚えの無い仕草が増えたようだ……
				IF RAND:2 == 0
					CFLAG:ARG:(2092) += LOCAL
				ELSE
					CFLAG:ARG:(2091) -= LOCAL
				ENDIF

			ELSEIF CFLAG:ARG:隷ＮＴＲ進行度 > 0 
				CFLAG:ARG:淫乱度+= 30 + CFLAG:ARG:現ＮＴＲ進行度*10
				LOCAL = ((E+F+G)*100+B*60)/MAX(1,ABL:ARG:0/2) * (2-CFLAG:ARG:構ったフラグ) + CFLAG:ARG:放置日数*10
					PRINTFORML %CALLNAME:ARG%に見覚えの無い仕草が増えたようだ……
				IF RAND:2 == 0
					CFLAG:ARG:(2092) += LOCAL
				ELSE
					CFLAG:ARG:(2091) -= LOCAL
				ENDIF

			ENDIF
		ELSE
			PRINTFORML %CALLNAME:ARG%に特に変わった様子はないようだ
		ENDIF

	ENDIF


	PRINTFORML
ENDIF
$SKIP_NTR

;最後に金額の加算,特殊レンタルの場合は0なので飛ばす
IF V > 0
	PRINTFORMW %CALLNAME:ARG%のレンタル額として{V}魔貨を得ました
	MONEY:1 += V
	CALL 帳簿閲覧_労役, ARG, V, 0, 4

ENDIF

;フラグのリセット
CFLAG:ARG:12 = 0
CFLAG:ARG:13 = 0
CFLAG:ARG:14 = 0
CFLAG:ARG:15 = 0

CALL 気絶処理,ARG

CFLAG:ARG:労役フラグ = 0

RETURN 1



