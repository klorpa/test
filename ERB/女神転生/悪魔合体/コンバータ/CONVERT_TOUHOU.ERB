@CONVERT_TOUHOU, ARG , ARG:1 , ARG:2 , ARG:3 = -1
;ARG ,悪魔１
;ARG:1　悪魔２
;ARG:2　悪魔３
;ARG:3　元々のRESULT
;

;LOCAL ：悪魔１種族
;LOCAL:1 ：悪魔２種族
;LOCAL:2 ：悪魔３種族
;LOCAL:3 ：悪魔種族
;LOCAL:4 ：悪魔LV

#LOCALSSIZE 5

;合体処理をもう一度行う
;合体結果の種族を検索
IF ARG:2 > 0
	LOCAL = ABL:(ARG:0):種族
	LOCAL:1 = ABL:(ARG:1):種族
	LOCAL:2 = ABL:(ARG:2):種族
	;バブルソートもどき
	SIF LOCAL > LOCAL:1
		SWAP LOCAL , LOCAL:1
	SIF LOCAL:1 > LOCAL:2
		SWAP LOCAL:1 , LOCAL:2
	SIF LOCAL > LOCAL:1
		SWAP LOCAL , LOCAL:1
	CALL SEARCH_RACE, LOCAL , LOCAL:1
	SIF RESULT == 13
		RESULT = LOCAL
	CALL SEARCH_RACE, MIN(RESULT , LOCAL:2), MAX(RESULT , LOCAL:2)
	IF RESULT == 13
		RETURN ARG:3
	ELSE
	
	ENDIF
ELSE
	CALL SEARCH_RACE,MIN(ABL:ARG:種族,ABL:(ARG:1):種族),MAX(ABL:ARG:種族,ABL:(ARG:1):種族)
	SIF RESULT == 13
		RETURN ARG:3
ENDIF
;その種族の悪魔をリスト化 Ｄあたりにリストを入れる
;女専用種族を男で作ろうとする場合、オトコ専用種族に変換する。
IF RESULT == 1 && TALENT:ARG:オトコ
	RESULT = 15
ELSEIF RESULT == 2 && TALENT:ARG:オトコ
	RESULT = 16
ENDIF
LOCAL:3 = RESULT
	;合体不可の組み合わせなら0を返す
SIF LOCAL:3 == 0
	RETURN 0

;作成したリストから二体の平均レベルに合わせて悪魔を選ぶ
IF ARG:2 > 0
	;平均に足すレベル
	IF EQUIP:MASTER:Paracelsus == 0
		LOCAL:4 = (CSVBASE(NO:ARG,GETNUM(BASE,"LV"),0) + CSVBASE(NO:(ARG:1),GETNUM(BASE,"LV"),0) + CSVBASE(NO:(ARG:2),GETNUM(BASE,"LV"),0))/3 + FUSION_PLUS_LV(3,1)
	ELSE
		LOCAL:4 = (BASE:ARG:LV + BASE:(ARG:1):LV + BASE:(ARG:2):LV)/3 + FUSION_PLUS_LV(3,1)
	ENDIF
ELSE
	;平均に足すレベル
	IF EQUIP:MASTER:Paracelsus == 0
		LOCAL:4 = (CSVBASE(NO:ARG,GETNUM(BASE,"LV"),0) + CSVBASE(NO:(ARG:1),GETNUM(BASE,"LV"),0))/2 + FUSION_PLUS_LV(2,1)
	ELSE
		LOCAL:4 = (BASE:ARG:LV + BASE:(ARG:1):LV)/2 + FUSION_PLUS_LV(2,1)
	ENDIF
ENDIF

;デバッグ用
;PRINTFORML 種族 ＝ {LOCAL:3}
;PRINTFORML 元キャラレベル ＝ {LOCAL:4}

SELECTCASE LOCAL:3
	;地母神
	CASE 1
		;4821	紫 56
		SIF LOCAL:4 >= CSVBASE(4821,GETNUM(BASE,"LV"),0)
			RETURN 4821
		;映姫　ＬＶ４８くらい
		SIF LOCAL:4 >= CSVBASE(4835,GETNUM(BASE,"LV"),0)
			RETURN 4835
		;神奈子　ＬＶ４３くらい
		SIF LOCAL:4 >= CSVBASE(4842,GETNUM(BASE,"LV"),0)
			RETURN 4842
		;4838 雛　ＬＶ３４くらい
		SIF LOCAL:4 >= CSVBASE(4838,GETNUM(BASE,"LV"),0)
			RETURN 4838
		;パルスィ　ＬＶ２７くらい
		SIF LOCAL:4 >= CSVBASE(4858,GETNUM(BASE,"LV"),0)
			RETURN 4858
		;静葉　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4836,GETNUM(BASE,"LV"),0)
			RETURN 4836
		;穣子　ＬＶ１７くらい
		SIF LOCAL:4 >= CSVBASE(4837,GETNUM(BASE,"LV"),0)
			RETURN 4837
		;幽谷響子　ＬＶ１０くらい
		RETURN 4877
	;Megami
	CASE 2
		;4853	依姫　ＬＶ５４
		SIF LOCAL:4 >= CSVBASE(4853,GETNUM(BASE,"LV"),0)
			RETURN 4853
		;4852	豊姫　ＬＶ５０
		SIF LOCAL:4 >= CSVBASE(4852,GETNUM(BASE,"LV"),0)
			RETURN 4852
		;4828	永琳　ＬＶ47
		SIF LOCAL:4 >= CSVBASE(4828,GETNUM(BASE,"LV"),0)
			RETURN 4828
		;4851	天子　ＬＶ43
		SIF LOCAL:4 >= CSVBASE(4851,GETNUM(BASE,"LV"),0)
			RETURN 4851
		;4829	輝夜　ＬＶ39
		SIF LOCAL:4 >= CSVBASE(4829,GETNUM(BASE,"LV"),0)
			RETURN 4829
		;4850	衣玖　ＬＶ35
		SIF LOCAL:4 >= CSVBASE(4850,GETNUM(BASE,"LV"),0)
			RETURN 4850
		;5801	わかさぎ姫　LV20
		RETURN 5801
	;Tyrant
	CASE 3
		;フランドール　ＬＶ５０くらい
		SIF LOCAL:4 >= CSVBASE(4810,GETNUM(BASE,"LV"),0)
			RETURN 4810
		;レミリア　ＬＶ４６くらい
		SIF LOCAL:4 >= CSVBASE(4809,GETNUM(BASE,"LV"),0)
			RETURN 4809
		;諏訪子　ＬＶ４２くらい
		SIF LOCAL:4 >= CSVBASE(4843,GETNUM(BASE,"LV"),0)
			RETURN 4843
		;アリス　ＬＶ３８くらい
		SIF LOCAL:4 >= CSVBASE(4813,GETNUM(BASE,"LV"),0)
			RETURN 4813
		;霍青娥　ＬＶ34くらい
		SIF LOCAL:4 >= CSVBASE(4879,GETNUM(BASE,"LV"),0)
			RETURN 4879
		;こいし　ＬＶ31くらい
		SIF LOCAL:4 >= CSVBASE(4863,GETNUM(BASE,"LV"),0)
			RETURN 4863
		;4860_さとり　ＬＶ28くらい
		SIF LOCAL:4 >= CSVBASE(4860,GETNUM(BASE,"LV"),0)
			RETURN 4860
		;小町　ＬＶ24くらい
		SIF LOCAL:4 >= CSVBASE(4834,GETNUM(BASE,"LV"),0)
			RETURN 4834
		;リリーブラック
		RETURN 4855
	;Divine
	CASE 4
		;5816_純狐　ＬＶ50
		SIF LOCAL:4 >= CSVBASE(5816,GETNUM(BASE,"LV"),0)
			RETURN 5816
		;5809_こころ　ＬＶ42
		SIF LOCAL:4 >= CSVBASE(5809,GETNUM(BASE,"LV"),0)
			RETURN 5809
		;5804_弁々　ＬＶ36
		SIF LOCAL:4 >= CSVBASE(5804,GETNUM(BASE,"LV"),0)
			RETURN 5804
		;5805_八橋　ＬＶ28
		SIF LOCAL:4 >= CSVBASE(5805,GETNUM(BASE,"LV"),0)
			RETURN 5805
		;5813_ドレミー　ＬＶ24
		SIF LOCAL:4 >= CSVBASE(5813,GETNUM(BASE,"LV"),0)
			RETURN 5813
		;5812_鈴瑚　ＬＶ12
		SIF LOCAL:4 >= CSVBASE(5812,GETNUM(BASE,"LV"),0)
			RETURN 5812
		;5811_清蘭　ＬＶ7
		SIF LOCAL:4 >= CSVBASE(5811,GETNUM(BASE,"LV"),0)
			RETURN 5811
	;Yoma
	CASE 5
		;幽香　ＬＶ４６くらい
		SIF LOCAL:4 >= CSVBASE(4833,GETNUM(BASE,"LV"),0)
			RETURN 4833
		;4827_鈴仙　ＬＶ３４くらい
		SIF LOCAL:4 >= CSVBASE(4827,GETNUM(BASE,"LV"),0)
			RETURN 4827
		;慧音　ＬＶ３０くらい
		SIF LOCAL:4 >= CSVBASE(4825,GETNUM(BASE,"LV"),0)
			RETURN 4825
		;メイリン　ＬＶ２６くらい
		SIF LOCAL:4 >= CSVBASE(4805,GETNUM(BASE,"LV"),0)
			RETURN 4805
		;ルーミア　ＬＶ１４くらい
		SIF LOCAL:4 >= CSVBASE(4802,GETNUM(BASE,"LV"),0)
			RETURN 4802
		;小悪魔
		RETURN 4806
	;Fairy
	CASE 6
		;5815_クラウンピース　ＬＶ42
		SIF LOCAL:4 >= CSVBASE(5815,GETNUM(BASE,"LV"),0)
			RETURN 5815
		;チルノ　ＬＶ２４くらい
		SIF LOCAL:4 >= CSVBASE(4804,GETNUM(BASE,"LV"),0)
			RETURN 4804
		;リリーホワイト　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4814,GETNUM(BASE,"LV"),0)
			RETURN 4814
		;大妖精　ＬＶ１８
		SIF LOCAL:4 >= CSVBASE(4803,GETNUM(BASE,"LV"),0)
			RETURN 4803
		;ルナ　ＬＶ１５
		SIF LOCAL:4 >= CSVBASE(4845,GETNUM(BASE,"LV"),0)
			RETURN 4845
		;スター　ＬＶ１２
		SIF LOCAL:4 >= CSVBASE(4846,GETNUM(BASE,"LV"),0)
			RETURN 4846
		;サニー　ＬＶ１０
		RETURN 4844
	;Brute
	CASE 7
		;4859_勇儀　ＬＶ５１くらい
		SIF LOCAL:4 >= CSVBASE(4859,GETNUM(BASE,"LV"),0)
			RETURN 4859
		;萃香　ＬＶ４７くらい
		SIF LOCAL:4 >= CSVBASE(4822,GETNUM(BASE,"LV"),0)
			RETURN 4822
		;4876	華扇　ＬＶ３７くらい
		SIF LOCAL:4 >= CSVBASE(4876,GETNUM(BASE,"LV"),0)
			RETURN 4876
		;パチュリー　ＬＶ３０くらい
		SIF LOCAL:4 >= CSVBASE(4807,GETNUM(BASE,"LV"),0)
			RETURN 4807
		;レティ　ＬＶ２５くらい
		SIF LOCAL:4 >= CSVBASE(4811,GETNUM(BASE,"LV"),0)
			RETURN 4811
		;4869_一輪　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4869,GETNUM(BASE,"LV"),0)
			RETURN 4869
		;にとり　ＬＶ１７くらい
		SIF LOCAL:4 >= CSVBASE(4839,GETNUM(BASE,"LV"),0)
			RETURN 4839
		;小傘　ＬＶ11くらい
		RETURN 4868
	;竜王
	;魔獣枠パンパンじゃないですか！
	CASE 8
		;5807_針妙丸　ＬＶ44
		SIF LOCAL:4 >= CSVBASE(5807,GETNUM(BASE,"LV"),0)
			RETURN 5807
		;5803_影狼　ＬＶ34
		SIF LOCAL:4 >= CSVBASE(5803,GETNUM(BASE,"LV"),0)
			RETURN 5803
		;5802_蛮奇　ＬＶ27
			RETURN 5802
	;Beast
	CASE 9
		;4820_藍　ＬＶ50くらい
		SIF LOCAL:4 >= CSVBASE(4820,GETNUM(BASE,"LV"),0)
			RETURN 4820
		;4872	星　ＬＶ４６くらい
		SIF LOCAL:4 >= CSVBASE(4872,GETNUM(BASE,"LV"),0)
			RETURN 4872
		;4874_ぬえ　ＬＶ４２くらい
		SIF LOCAL:4 >= CSVBASE(4874,GETNUM(BASE,"LV"),0)
			RETURN 4874
		;椛　ＬＶ38くらい
		SIF LOCAL:4 >= CSVBASE(4840,GETNUM(BASE,"LV"),0)
			RETURN 4840
		;4867_ナズーリン　ＬＶ３４くらい
		SIF LOCAL:4 >= CSVBASE(4867,GETNUM(BASE,"LV"),0)
			RETURN 4867
		;マミゾウ　ＬＶ30くらい
		SIF LOCAL:4 >= CSVBASE(4883,GETNUM(BASE,"LV"),0)
			RETURN 4883
		;お燐　ＬＶ２６くらい
		SIF LOCAL:4 >= CSVBASE(4861,GETNUM(BASE,"LV"),0)
			RETURN 4861
		;4812_橙　ＬＶ23くらい
		SIF LOCAL:4 >= CSVBASE(4812,GETNUM(BASE,"LV"),0)
			RETURN 4812
		;てゐ　ＬＶ１９くらい
		SIF LOCAL:4 >= CSVBASE(4826,GETNUM(BASE,"LV"),0)
			RETURN 4826
		;ヤマメ　ＬＶ15くらい
		SIF LOCAL:4 >= CSVBASE(4857,GETNUM(BASE,"LV"),0)
			RETURN 4857
	;リグル　ＬＶ１１くらい
	RETURN 4823
	;Flight
	CASE 10
		;空　ＬＶ５２くらい
		SIF LOCAL:4 >= CSVBASE(4862,GETNUM(BASE,"LV"),0)
			RETURN 4862
		;4830_妹紅　ＬＶ４８くらい
		SIF LOCAL:4 >= CSVBASE(4830,GETNUM(BASE,"LV"),0)
			RETURN 4830
		;文　ＬＶ４３くらい
		SIF LOCAL:4 >= CSVBASE(4831,GETNUM(BASE,"LV"),0)
			RETURN 4831
		;4875_はたて　ＬＶ３８くらい
		SIF LOCAL:4 >= CSVBASE(4875,GETNUM(BASE,"LV"),0)
			RETURN 4875
		;ミスティア　ＬＶ16くらい
		SIF LOCAL:4 >= CSVBASE(4824,GETNUM(BASE,"LV"),0)
			RETURN 4824
		;4864_朱鷺子　ＬＶ11くらい
		RETURN 4864
	;Foul
	CASE 11
		;4819_幽々子　ＬＶ５１くらい
		SIF LOCAL:4 >= CSVBASE(4819,GETNUM(BASE,"LV"),0)
			RETURN 4819
		;4881_布都　ＬＶ４３くらい
		SIF LOCAL:4 >= CSVBASE(4881,GETNUM(BASE,"LV"),0)
			RETURN 4881
		;妖夢　ＬＶ３９くらい
		SIF LOCAL:4 >= CSVBASE(4818,GETNUM(BASE,"LV"),0)
			RETURN 4818
		;4880_屠自古　ＬＶ３３くらい
		SIF LOCAL:4 >= CSVBASE(4880,GETNUM(BASE,"LV"),0)
			RETURN 4880
		;芳香　ＬＶ２９くらい
		SIF LOCAL:4 >= CSVBASE(4878,GETNUM(BASE,"LV"),0)
			RETURN 4878
		;ムラサ　ＬＶ２５くらい
		SIF LOCAL:4 >= CSVBASE(4871,GETNUM(BASE,"LV"),0)
			RETURN 4871
		;ルナサ　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4817,GETNUM(BASE,"LV"),0)
			RETURN 4817
		;メルラン　ＬＶ１８くらい
		SIF LOCAL:4 >= CSVBASE(4816,GETNUM(BASE,"LV"),0)
			RETURN 4816
		;リリカ　ＬＶ１５くらい
		SIF LOCAL:4 >= CSVBASE(4815,GETNUM(BASE,"LV"),0)
			RETURN 4815
		;メディスン　ＬＶ１１くらい
		SIF LOCAL:4 >= CSVBASE(4832,GETNUM(BASE,"LV"),0)
			RETURN 4832
		;キスメ　ＬＶ8くらい
		RETURN 4856
	;CASE 13	
	;Kishin
	CASE 15
		;5814_サグメ　ＬＶ38
		SIF LOCAL:4 >= CSVBASE(5814,GETNUM(BASE,"LV"),0)
			RETURN 5814
		;5806_正邪　ＬＶ30
			RETURN 5806
	;Deity
	;CASE 16

ENDSELECT


;コンバート先がない場合、そのまま返す
RETURN ARG:3

;=====================================================
;Zoma×地霊殿タッグ＋友人　＝　博麗霊夢
;=====================================================
;魔理沙
@FUSION_SPECIAL_4402_4801,ARG,ARG:1
RETURN 4800
;すいか
@FUSION_SPECIAL_4402_4822,ARG,ARG:1
RETURN 4800
;文
@FUSION_SPECIAL_4402_4831,ARG,ARG:1
RETURN 4800
;紫

;=====================================================
;Zoma×地霊殿タッグ＋友人　＝　霧雨魔理沙
;=====================================================
;霊夢
@FUSION_SPECIAL_4402_4800,ARG,ARG:1
RETURN 4801
;パチュリー
@FUSION_SPECIAL_4402_4807,ARG,ARG:1
RETURN 4801
;アリス
@FUSION_SPECIAL_4402_4813,ARG,ARG:1
RETURN 4801
;にとり
@FUSION_SPECIAL_4402_4839,ARG,ARG:1
RETURN 4801

;=====================================================
;Zoma×紅魔郷‐パチェ　＝　十六夜咲夜
;=====================================================
;ルーミア
@FUSION_SPECIAL_4402_4802,ARG,ARG:1
RETURN 4808
;チルノ
@FUSION_SPECIAL_4402_4804,ARG,ARG:1
RETURN 4808
;めいりん
@FUSION_SPECIAL_4402_4805,ARG,ARG:1
RETURN 4808
;レミリア
@FUSION_SPECIAL_4402_4809,ARG,ARG:1
RETURN 4808
;フランドール
@FUSION_SPECIAL_4402_4810,ARG,ARG:1
RETURN 4808

;=====================================================
;Zoma×風神録連中　＝　東風谷早苗
;=====================================================
;秋静葉
@FUSION_SPECIAL_4402_4836,ARG,ARG:1
RETURN 4841
;秋穣子
@FUSION_SPECIAL_4402_4837,ARG,ARG:1
RETURN 4841
;鍵山雛
@FUSION_SPECIAL_4402_4838,ARG,ARG:1
RETURN 4841
;犬走椛
@FUSION_SPECIAL_4402_4840,ARG,ARG:1
RETURN 4841
;八坂神奈子
@FUSION_SPECIAL_4402_4842,ARG,ARG:1
RETURN 4841
;洩矢諏訪子
@FUSION_SPECIAL_4402_4843,ARG,ARG:1
RETURN 4841

;=====================================================
;Zoma×聖蓮船連中＋マミゾウ　＝　Chara4873_白蓮
;=====================================================
;ナズーリン
@FUSION_SPECIAL_4402_4867,ARG,ARG:1
RETURN 4873
;多々良小傘
@FUSION_SPECIAL_4402_4868,ARG,ARG:1
RETURN 4873
;雲居一輪
@FUSION_SPECIAL_4402_4869,ARG,ARG:1
RETURN 4873
;ムラサ
@FUSION_SPECIAL_4402_4871,ARG,ARG:1
RETURN 4873
;星
@FUSION_SPECIAL_4402_4872,ARG,ARG:1
RETURN 4873
;ぬえ
@FUSION_SPECIAL_4402_4874,ARG,ARG:1
RETURN 4873
;マミゾウ
@FUSION_SPECIAL_4402_4883,ARG,ARG:1
RETURN 4873
;=====================================================
;Zoma×神霊廟連中‐マミゾウ　＝　豊聡耳神子
;=====================================================
;芳香
@FUSION_SPECIAL_4402_4878,ARG,ARG:1
RETURN 4882
;青娥
@FUSION_SPECIAL_4402_4879,ARG,ARG:1
RETURN 4882
;屠自古
@FUSION_SPECIAL_4402_4880,ARG,ARG:1
RETURN 4882
;布都
@FUSION_SPECIAL_4402_4881,ARG,ARG:1
RETURN 4882


;=====================================================
;造魔×針妙丸or妹紅or華扇　＝　菫子
;=====================================================
;妹紅
@FUSION_SPECIAL_4402_4830,ARG,ARG:1
RETURN 5810
;針妙丸
@FUSION_SPECIAL_4402_5807,ARG,ARG:1
RETURN 5810
;華扇
@FUSION_SPECIAL_4402_4876,ARG,ARG:1
RETURN 5810

;=====================================================
;弁々＊八橋＝　雷鼓
;=====================================================
@FUSION_SPECIAL_5804_5805,ARG,ARG:1
RETURN 5808

;=====================================================
;クラウンピース＊純狐＝　ヘカーティア
;=====================================================
@FUSION_SPECIAL_5815_5816,ARG,ARG:1
RETURN 5817

