@KENO
#LOCALSIZE 10
#LOCALSSIZE 10
#DIM SPOT,64
#DIM PICKED,64
#DIM HIT,1
#DIM BET,1
#DIM WIN, 1
#DIM LINE, 1
#DIM MODE,1
#DIM LAST_PICK,1
#DIM PICKED_RESULT,64
MODE = 0
REDRAW 2
VARSET SPOT
VARSET PICKED
PRINTL ドーリー:
PRINTL 「イェーイ！ キノだぜぇーい
PRINTL 　昨日やってもキノ 今日やってもキノ
PRINTW 　バカヤロウ！ ここはワラうところだぜぇー」
PRINTL 「イェイ どうするんだーい」
$INPUT_START
CALL INPUT_SELECT(1, "ゲームスタート", 2, "アドバイスを聞く", 3, "画面がずれる", 9, "外に出る")
IF RESULT > 1
	PRINTL ドーリー:
	IF RESULT == 2
		PRINTL 「ＫＥＮＯは１から６４の数の中から
		PRINTL 　１プレイで１６の数が選ばれるのさぁ
		PRINTW 　それを予想して賭けてくれよぉ」
		PRINTL 「賭けられる数は１から１６まで
		PRINTW 　いくつ選んでも自由だぜぇ」
		PRINTL 「ナンバーボードの数字をクリックするか
		PRINTL 　数字を直接入力すれば、選んだ数が水色になる
		PRINTW 　キャンセルも同じようにしてくれよぉ」
		PRINTL 「数を選ぶと、右のオッズ表が出るんだ
		PRINTL 　"１　x４"と出たら、選んだ数が１つ
		PRINTW 　当たると、コインは４倍って事だぁ」
		PRINTL 「選び終わったら、[70] ＢＥＴ
		PRINTL 　コインを賭けてくれぇ」
		PRINTW 　ＭＡＸ１００枚賭けられるぜぇ」
		PRINTL 「[80]ＥＲＡＳＥは選んだのを全部消す
		PRINTW 　始めっから選び直したい時に使え」
;		PRINTL 「[90]ＲＥＳＵＬＴは今までの結果
;		PRINTL 　アカは多い、アオは少ない、ミドリは
;		PRINTW 　普通の出方、よく見て選んでくれぇ」
		PRINTL 「賭けたら[0]でスタート！
		PRINTL 　やめたい時は、[99]
		PRINTW 　当たりのＭＡＸは９９９９９９枚だぁっ！」
	ELSEIF RESULT == 3
		PRINTW 「EMUERAの描画に使ってるGDI+の問題で、色をつけるとずれるんだぜぇ」
		PRINTL 「ウィンドウの上部にあるコンフィグをえらんで、表示タブを選んで
		PRINTW 　描画をGDI+からGDIにすればずれなくなるぜぇ」
	ELSEIF RESULT  == 9
		PRINTL 「ＫＥＮＯと書いてキノ！ ケノって
		PRINTL 　読むなら、勝手にしな
		PRINTW 　じゃあ、またなぁー」
		RETURN 1
	ENDIF
	PRINTL ドーリー:
	PRINTL 「イェイ どうするんだーい」
	GOTO INPUT_START
ENDIF
DRAWLINE
FONTSTYLE 3
PRINTL ＫＥＮＯ
FONTSTYLE 0
DRAWLINE
LINE = LINECOUNT
WHILE 1
	CLEARLINE LINECOUNT - LINE
	;HIT数の計算
	HIT = 0
	FOR LOCAL,0,64
		SIF PICKED:LOCAL && SPOT:LOCAL
			HIT++
	NEXT
	FOR LOCAL, 0, 23
		SELECTCASE LOCAL
			CASE 0, 14
				PRINTFORM ┌─┬─┬─┬─┬─┬─┬─┬─┐
			CASE 1, 3 , 5, 7
				FOR LOCAL:1, LOCAL/2*8, LOCAL/2*8+8
					PRINT │
					IF SPOT:(LOCAL:1) && PICKED:(LOCAL:1)
						;ライム
						SETCOLOR 0x00ff00
						FONTSTYLE 8
					ELSEIF SPOT:(LOCAL:1)
						SETCOLOR COLOR("aqua")
						FONTSTYLE 8
					ELSEIF PICKED:(LOCAL:1)
						SETCOLOR COLOR("red")
					ELSE
						RESETCOLOR
					ENDIF
					IF !MODE
						PRINTBUTTON @"{LOCAL:1+1,2}", LOCAL:1+1
					ELSE
						PRINTFORM {LOCAL:1+1,2}
					ENDIF
					FONTSTYLE 0
					RESETCOLOR
				NEXT
				PRINT │
			CASE 15, 17 , 19, 21
				FOR LOCAL:1, (LOCAL/2-3)*8, (LOCAL/2-3)*8+8
					PRINT │
					IF SPOT:(LOCAL:1) && PICKED:(LOCAL:1)
						;ライム
						SETCOLOR 0x00ff00
						FONTSTYLE 8
					ELSEIF SPOT:(LOCAL:1)
						SETCOLOR COLOR("aqua")
						FONTSTYLE 8
					ELSEIF PICKED:(LOCAL:1)
						SETCOLOR COLOR("red")
					ELSE
						RESETCOLOR
					ENDIF
					IF !MODE
						PRINTBUTTON @"{LOCAL:1+1,2}", LOCAL:1+1
					ELSE
						PRINTFORM {LOCAL:1+1,2}
					ENDIF
					RESETCOLOR
					FONTSTYLE 0
				NEXT
				PRINT │
			CASE 2, 4, 6, 16, 18, 20
				PRINT ├─┼─┼─┼─┼─┼─┼─┼─┤
			CASE 8, 22
				PRINT └─┴─┴─┴─┴─┴─┴─┴─┘
			CASE 9
				PRINTFORM  ┌────┬────┬────┐ 
			CASE 10
				PRINTFORM  │　
				SETCOLOR COLOR("aqua")
				PRINT SPOT
				PRINTD 　│ 
				SETCOLOR COLOR("red")
				PRINT PICKED
				PRINTD  │ 
				SETCOLOR 0x00ff00
				PRINT CATCH
				RESETCOLOR
				PRINT 　│ 
			CASE 11
				PRINTFORM  ├────┼────┼────┤ 
			CASE 12
				PRINTFORM  │　%TOFULL(@"{MATCH(SPOT, 1)}"),4%　│　%TOFULL(@"{LIMIT(MODE-1, 0, 16)}"),4%　│　%TOFULL(@"{HIT}"),4%　│ 
			CASE 13
				PRINTFORM  └────┴────┴────┘ 
		ENDSELECT
		SELECTCASE LOCAL
			CASE 0,6
				PRINTFORML ┌────┬─────┐
			CASE 1
				PRINTL │BET 　　│COINS 　　│
			CASE 3
				PRINTFORML │{BET,8}│{MONEY:3,10}│
			CASE 4, 22
				PRINTL └────┴─────┘
			CASE 5
				PRINTL 
			CASE 7 
				PRINTL │CATCH 　│OOS 　　　│
			CASE 2, 8
				PRINTL ├────┼─────┤
			CASE IS < 22
				IF LOCAL == 21
					SIF HIT >= 12
						SETCOLOR COLOR("aqua")
					PRINTFORMD │ 
					PRINT １２up
					PRINTD  │
					PRINTFORM %"x"+@"{KENO_RESULT(MATCH(SPOT,1),12)}",10%
					PRINTDL │
				ELSE
					SIF HIT == LOCAL - 9
						SETCOLOR COLOR("aqua")
					PRINTFORMD │ 
					PRINTFORM %TOFULL(@"{LOCAL-9}"),4%   
					PRINTD │
					PRINTFORM %"x"+@"{KENO_RESULT(MATCH(SPOT,1),LOCAL-9)}",10%
					PRINTDL │
				ENDIF
				RESETCOLOR
		ENDSELECT
	NEXT
	IF !MODE
		SIF BET == 0 || BET >= MONEY:3 || !MATCH(SPOT,1)
			SETCOLOR COLOR("gray")
		PRINTL [ 0] ＳＴＡＲＴ
		RESETCOLOR
		PRINTL [70] ＢＥＴ
		PRINTL [80] ＥＲＡＳＥ
		PRINTL [99] ＥＸＩＴ
		RESETCOLOR
	ELSE
		
	ENDIF
	;セレクトモード
	IF !MODE
		INPUT
		SELECTCASE RESULT
			CASE 0
				IF BET > 0 && BET < MONEY:3 && MATCH(SPOT,1)
					MODE = 1
					MONEY:3 -= BET
					FLAG:ジャックポット += BET
				ENDIF
			CASE IS < 65
				SPOT:(RESULT-1) = MATCH(SPOT,1) < 16 && SPOT:(RESULT-1) == 0 ? 1 # 0
			CASE 70
				PRINTL ＞賭けるコインの枚数を入力してください
				CALL INPUT_MANY(0, MIN(MONEY:3, 100))
				BET = RESULT
			CASE 80
				VARSET SPOT
			CASE 99
				REDRAW 1
				RETURN 0
		ENDSELECT
	ELSE
		IF MODE == 1
			CALL MESSAGE_BL(1, "ＫＥＮＯ ＳＴＡＲＴ!!")
			PRINTL 
		ELSE
			IF SPOT:LAST_PICK
				SETCOLOR COLOR("aqua")
				CALL MESSAGE_BL(2, "ＰＩＣＫ "+TOFULL(@"{LAST_PICK+1}"), "ＣＡＴＣＨ!!")
				RESETCOLOR
			ELSE
				CALL MESSAGE_BL(1, TOFULL("ＰＩＣＫ ")+TOFULL(@"{LAST_PICK+1}"))
				PRINTL 
			ENDIF
		ENDIF
		REDRAW 2
		TWAIT 3000, 1
		DO 
			LAST_PICK = RAND:64 
		LOOP PICKED:LAST_PICK
		PICKED:LAST_PICK = 1
		PICKED_RESULT:LAST_PICK += 1
		IF MODE++ == 17
			CLEARLINE 4
			LOCAL = MIN(KENO_RESULT(MATCH(SPOT, 1), HIT) * BET, 999999)
			IF LOCAL > 0
				SETCOLOR COLOR("aqua")
				CALL MESSAGE_BL(2, "Ｃｏｎｇｒａｔｕｌａｔｉｏｎｓ！" ,@"ＧＥＴ %TOFULL(@"{LOCAL}")%ＣＯＩＮＳ！")
			ELSE
				CALL MESSAGE_BL(1, "ＧＥＴ ＮＯ ＣＯＩＮ")
				PRINTL 
			ENDIF
			REDRAW 2
			WAIT
			VARSET PICKED
			MONEY:3 += LOCAL
			MODE = 0
		ENDIF
	ENDIF
WEND
RESTART
;払い戻しテーブル
@KENO_RESULT, ARG, ARG:1
#FUNCTION
SELECTCASE ARG
	CASE 1
		SELECTCASE ARG:1
			CASE 0
				RETURNF 0
			CASE 1
				RETURNF 4
		ENDSELECT
	CASE 2
		SELECTCASE ARG:1
			CASE IS < 2
				RETURNF 0
			CASE 2
				RETURNF 20
		ENDSELECT
	CASE 3
		SELECTCASE ARG:1
			CASE IS < 2
				RETURNF 0
			CASE 2
				RETURNF 3
			CASE 3
				RETURNF 30
		ENDSELECT
	CASE 4
		SELECTCASE ARG:1
			CASE IS < 3
				RETURNF 0
			CASE 3
				RETURNF 10
			CASE 4
				RETURNF 200
		ENDSELECT
	CASE 5
		SELECTCASE ARG:1
			CASE IS < 3
				RETURNF 0
			CASE 3
				RETURNF 3
			CASE 4
				RETURNF 30
			CASE 5
				RETURNF 500
		ENDSELECT
	CASE 6
		SELECTCASE ARG:1
			CASE IS < 4
				RETURNF 0
			CASE 4
				RETURNF 10
			CASE 5
				RETURNF 200
			CASE 6
				RETURNF 2000
		ENDSELECT
	CASE 7
		SELECTCASE ARG:1
			CASE IS < 4
				RETURNF 0
			CASE 4
				RETURNF 3
			CASE 5
				RETURNF 50
			CASE 6
				RETURNF 500
			CASE 7
				RETURNF 5000
		ENDSELECT
	CASE 8
		SELECTCASE ARG:1
			CASE IS < 5
				RETURNF 0
			CASE 5
				RETURNF 50
			CASE 6
				RETURNF 200
			CASE 7
				RETURNF 2000
			CASE 8
				RETURNF 20000
		ENDSELECT
	CASE 9
		SELECTCASE ARG:1
			CASE IS < 5
				RETURNF 0
			CASE 5
				RETURNF 10
			CASE 6
				RETURNF 50
			CASE 7
				RETURNF 500
			CASE 8
				RETURNF 5000
			CASE 9
				RETURNF 50000
		ENDSELECT
	CASE 10
		SELECTCASE ARG:1
			CASE IS < 5
				RETURNF 0
			CASE 5
				RETURNF 5
			CASE 6
				RETURNF 20
			CASE 7
				RETURNF 200
			CASE 8
				RETURNF 2000
			CASE 9
				RETURNF 20000
			CASE 10
				RETURNF 100000
		ENDSELECT
	CASE 11
		SELECTCASE ARG:1
			CASE IS < 6
				RETURNF 0
			CASE 6
				RETURNF 5
			CASE 7
				RETURNF 100
			CASE 8
				RETURNF 1000
			CASE 9
				RETURNF 10000
			CASE 10,11
				RETURNF 100000
		ENDSELECT
	CASE 12
		SELECTCASE ARG:1
			CASE IS < 6
				RETURNF 0
			CASE 6
				RETURNF 5
			CASE 7
				RETURNF 30
			CASE 8
				RETURNF 300
			CASE 9
				RETURNF 3000
			CASE 10
				RETURNF 30000
			CASE 11,12
				RETURNF 100000
		ENDSELECT
	CASE 13
		SELECTCASE ARG:1
			CASE IS < 6
				RETURNF 0
			CASE 6
				RETURNF 5
			CASE 7
				RETURNF 10
			CASE 8
				RETURNF 100
			CASE 9
				RETURNF 1000
			CASE 10
				RETURNF 10000
			CASE 11,12,13
				RETURNF 100000
		ENDSELECT
	CASE 14
		SELECTCASE ARG:1
			CASE IS < 6
				RETURNF 0
			CASE 6
				RETURNF 3
			CASE 7
				RETURNF 10
			CASE 8
				RETURNF 50
			CASE 9
				RETURNF 500
			CASE 10
				RETURNF 5000
			CASE 11
				RETURNF 50000
			CASE 12,13,14
				RETURNF 100000
		ENDSELECT
	CASE 15
		SELECTCASE ARG:1
			CASE 0
				RETURNF 30
			CASE IS < 7
				RETURNF 0
			CASE 7
				RETURNF 3
			CASE 8
				RETURNF 30
			CASE 9
				RETURNF 100
			CASE 10
				RETURNF 1000
			CASE 11
				RETURNF 10000
			CASE 12,13,14,15
				RETURNF 100000
		ENDSELECT
	CASE 16
		SELECTCASE ARG:1
			CASE 0
				RETURNF 50
			CASE IS < 7
				RETURNF 0
			CASE 7
				RETURNF 3
			CASE 8
				RETURNF 20
			CASE 9
				RETURNF 50
			CASE 10
				RETURNF 500
			CASE 11
				RETURNF 5000
			CASE 12,13,14,15,16
				RETURNF 100000
		ENDSELECT
ENDSELECT
RETURNF 0

