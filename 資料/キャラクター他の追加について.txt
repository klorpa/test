;==================================================================
;キャラクター・アイテム・スキル・ダンジョン・口上等、
;ファイルを追加する際の指針について説明します。
:==================================================================
・キャラクター、スキル、ダンジョン・闘技場イベントは、新しいデータを記述したファイル(キャラクターならCSV、それ以外はERB
　をそれぞれのフォルダに格納するだけで追加できます。ただし、登録番号などが他のデータと重複しないように気をつけてください
・アイテムを追加するには、装備品か使用アイテムかによって対応したERBファイルを格納し、
　ITEM.CSVに新たに値段と名称を追加する必要があります。

・口上テンプレートはeratohoAのものを使わせていただいていますが、Emueraの機能などを利用して改変しているため、
　テンプレート内のX1、X2を書き換えるだけで動作はするはずです。




□キャラクターの追加について(CharaX.CSV)
・他バリアントに見られるABL、TALENTについてはほぼ同様の仕様であると思われるので割愛します。

#BASE

ＨＰ:ダメージに耐える能力を表します。攻撃を受ける事で減り、0になると瀕死状態になります。現状では、主人が瀕死状態になるとゲームオーバーです。
	 また、物理攻撃系のスキルを使用する際に消費します。
	 実際には仲魔・敵になる際再計算されるのでＣＳＶで定義する必要はありません。
	 計算式は(LV＋力/２＋耐力)×(４＋(LV＋耐力)/10)＋５、ボスであれば　×　(5+(強化ランク-100)/5)されます。
	 また、スキル・○分の活泉を所持していると○内の数字×10％増加します。一番効果の大きいものが優先され、累積はしません。
ＭＰ:魔法系のスキルを使用するのに消費します。
	 ＨＰと同様、ＣＳＶで定義する必要はありません。
	 計算式は(LV＋知恵/２＋(魔力×３/２))×２、ボスであれば　×　(2+(強化ランク-100)/5)されます。
	 また、スキル・○分の魔脈を所持しているとＨＰと同様増加します。

※基本能力
LV:戦闘に関する全体的な能力です。ほぼ全ての戦闘能力に影響します。
　 ＥＸＰが十分に貯まると上昇し、同時に他の基本能力一つを上げる事が出来ます。
力:物理攻撃の威力とＨＰに影響します
知恵:物理攻撃の回避率・魔法の威力・命中・回避・状態異常の付与率・防御率・銃の攻撃力・ＭＰに影響します
魔力:魔法の威力・命中・回避・ＭＰに影響します。
耐力:防御力・物理攻撃の威力・ＨＰに影響します。
速さ:戦闘での行動順、物理攻撃の命中・回避・銃の攻撃力に影響します
運:色々なことに影響します。

原則として、基本能力値の合計は18+LV*1.5±5の範囲に収まるようにしてください。
あくまでも原則なので、それを越えても下回ってもよほどの事がない限りは大丈夫です。

※戦闘能力
攻撃力、防御力・命中、回避、魔法威力、魔法効果、銃命中、銃攻撃
これらの値は基本能力や装備品から再計算されるので、ＣＳＶに記述する必要はありません。

攻撃力 = (LV×２＋力×２)　、　悪魔は更に＋(力＋耐力)/２
命中 = ((LV＋運)/４+LV×３/２+速さ)、悪魔は更に＋LV/２
防御 = (LV×２+耐力×２)、悪魔は更に＋(力＋耐力)/２
回避 = (運＊２)/４+LV×３/２+速さ）、悪魔は更に＋LV/２
魔法威力 = (LV＋魔力×３＋知恵)
魔法効果 = (LV＋知恵×３＋運)



※相性
剣撃〜サイコ
それぞれの相性(他のＲＰＧでいう属性)で攻撃された際、実際のダメージが*この数値/100されます。状態異常になる確立も同様の乗算がなされます。
また、999に設定した相性の攻撃は反射するようになります。

※その他
ＥＸＰ・ＭＡＧ・￥　：敵として現れ。倒した場合に、ここに記述した値×LVをそれぞれ入手することができます。
		　　　ＥＸＰとＭＡＧは戦闘に参加した味方の人数で割られます。
		　　　また、ボスとして登場した悪魔は、入手する経験値が*(5+LV/10)されます。
		　　　ボスとして作成した悪魔も、基本的に経験値・ＭＡＧ・￥は雑魚として出現した場合の数値を入力してください。
		　　　○○で出現する××はＭＡＧ多くもらえるとかそういうことをしたい場合は、ＥＲＢでこの数値を弄くるようにした方が無難です。
		　　　また、キャラクターが次のレベルに上がるのに必要な経験値は5*(LV)(LV+1)(LV+2)/3となっています
CP：抗体ポイント。パーティに悪魔を呼び出してダンジョンを歩いた際、その悪魔のLV*CPのＭＡＧを消費しなければなりません。
	CSVで設定するのはその倍率です。

#ABL
・スキル1〜20
最初から習得しているスキルを設定できます。設定したいスキルの番号についてはERB\スキル関連内のファイルから探してください。
20個まで設定していますが、このバリアントでは8個目までしか使用しません。
・習得スキル1-20
・習得LV1-20
レベルアップ時に習得するスキルの番号と、習得できるレベルを設定できます。必ずセットで設定してください。

・種族
主に合体時に参照されます。STR.CSVを参考に、キャラクターのイメージに合ったものを設定してください。
また、人間キャラは原則として46、人間キャラでもペルソナ使いは47を設定してください。


・会話タイプ
戦闘中の交渉、及び調教時に呼び出される汎用口上に関わります。どのようなものがあるかはEX.CSVに記述しています。
尚、汎用口上は悪魔であることを前提に作成しているので、原則として人間には設定しない事をオススメします。

・属性LD、属性LC
今の所意味はありません
設定として、属性LDの場合 1 = LIGHT = 善人、2 = NEWTRAL = 中立、3 = DARK = 悪人
属性LCの場合1 = LAW = 秩序寄りの性格、2 = NEWTRAL = 中庸的な性格、3 = CHAOS = 混沌的な性格
となっています。
DEVIL-COOPが実装された場合、敵の弱点を突いた攻撃者と同じ属性のキャラクターが追撃に参加します。

#TALENT
・サマナー
主人以外にも設定できるようになりました。

・友愛〜ゾンビ
口上や交渉で使用する予定のものです。他の素質と同様、イメージで設定してくださって構いません。

・肉体部位系
一部のスキルの継承条件に使用されます。また、一部の調教コマンドにも影響を与える予定です。

・剣撃〜サイコ
それぞれの継承タイプのスキルを、合体時に継承できるかどうかを表す素質です。

#CFLAG

・合体条件有り
	このフラグがCSVでONになっているキャラクターは、FLAG:(10000+キャラ登録番号)が1になっていないと合体で作る事が出来ません。
	ボスとして撃破しないと作成できない悪魔や、敵専用として使いたい悪魔などに使ってください。
・特殊合体のみ
	このフラグがCSVでONになっているキャラクターは、通常合体によってリストに現れなくなります。
	特殊合体は@FUSION_SPECIAL_X1_Y1 (X1・Y1は共に悪魔のキャラ番号)を作成することで可能になります。
・全書召喚不可
	このフラグがCSVでONになっているキャラクターは、全書から呼び出すことができません。
・上記の合体条件有りor特殊合体のみ + 全書召喚不可を定義することで絶対に仲間にすることができない悪魔を定義することができます。


・服装
	帽子・服・下衣・全身服・手・下着（上）・下着（下）・全身下着・靴下・靴・上着・その他
	の箇所にそれぞれ服装を設定できます。
	ITEM.CSVに記述してある数字から6000を引いたものがその衣装の管理ナンバーです。
	フラグ,服,107　のように設定してください。←はブラウスを服の箇所に初期衣装として設定します。
	
・初期ペルソナ
	ペルソナ使いの場合、定義が必要です。
	ここに入力した数値とおなじキャラ番号を持つ悪魔が初期ペルソナとなります。

□キャラクターの口上の追加について
	　調教時などの口上は特定のキャラクター専用の口上→無い場合会話タイプによる汎用口上
	という順番で読み込み、表示するようになっています。
	　特定のキャラクター専用の口上はEVENT_KX_ALL (Xはキャラクター登録番号)
	　会話タイプによる汎用口上はEVENT_PUBX_ALL (Xは会話タイプ番号)
	となっており、特定キャラの口上は付属のテンプレート(EVENT_KX1_ALL)内のX1、X2をキャラ番号に変更すれば使用できます。
	汎用口上はテンプレートを作成していませんが、PUB304の304を違う会話タイプ番号に変更すれば使用出来ると思います。
	
□テスト戦闘について
	デバッグモードフラグが立っている状態でコロシアムを選択すると戦闘テストを行えます
	詳しい仕様はreadme集の戦闘テスト.txtを参照してください
	細かい調整をする場合は利用してもいいかもしれません

□ダンジョンの追加について
現状、一つのダンジョンに0〜24の25個までのマップを設定できます。マップのサイズは0-19の20×20が最大です。
ダンジョン内でのイベントの制御には、原則としてDB:ダンジョン番号:Xを使用してください。

マップタイルは

	0＝壁、進入不可。視界を遮る。
	1=床、何もないタイル。
	2=扉、進入した方向にもう１マス強制的に移動させる。視界を遮る。
	3=宝。タイルを設定するだけではなく、進入・調査時のイベントとしてGET_TREASURE等を呼び出さなければならない。
	4=イベント。宝と同様、イベントを設定しなければ何も起きない。
	5=罠。同上。
	6,7=昇り・下り階段。同上。
	8=出口。同上。
	9=特殊タイル。関数TILE_MARK_{ダンジョン番号}_{MAP番号}_{Ｘ座標}_{Ｙ座標}で設定した文字が表示される。

の９種類を設定できます。

進入時のイベントを処理する際、RETURN 0でイベントを終了するとイベント後エンカウントします。エンカウントさせたくない場合RETURN 1でイベントを終了させてください。

以下、ぱっと見ただけでは挙動が分かりにくい関数を説明します。

	□マップ作成時
		@SET_TILE,ARG,ARG:1,ARG:2,ARG:3,ARG:4
		ARG:2 == ARG:3であった場合、座標(ARG,ARG:1)のタイルにARG:4をセットします。

		@SET_TILES,ARG,ARG:1,ARG:2,ARG:3,ARG:4,ARGS
		ARGSには＝、＜、＜＝、＞、＞＝を入力できます。
		ARG:2 ARGS ARG:3　の式が成り立つ場合、座標(ARG,ARG:1)のタイルにARG:4をセットします。


	□宝箱に設定するもの
		@GET_TREASURE,ARG,ARG:1,ARG:2,ARG:3
		宝箱を発見します。続くINPUTに[0]開けるを入力した場合、ARG番のアイテムをARG:1個入手し、
		またDB:(ARG:2):(ARG:3)が1になります。

		@GET_TREASURE_MONEY,ARG,ARG:1,ARG:2,ARG:3
		お金の入った箱を発見します。ARG == 0であれば￥、ARG == 1であれば魔貨を入手します。
		それ以外はGET_TREASUREと同様です。

	□出口
		@DUNGEON_EXIT
		ダンジョンを脱出するかどうかを尋ねてくるイベントを呼び出します。
	
	□階段
		@DUNGEON_UPSTAIRS,ARG,ARG:1,ARG:2
		@DUNGEON_DOWNSTAIRS,ARG,ARG:1,ARG:2
		それぞれ昇り・下り階段の処理を呼び出します。続くINPUTに[0]Yesを入力すると、
		ARG番のマップの座標(ARG:1,ARG:2)に移動し、フロアを作成しなおし、オートマッピング処理を行います。
		
	□移動に関する事
		
		@DUNGEON_WORP,ARG,ARG:1,ARG:2
		ARG番のマップの座標(ARG:1,ARG:2)に移動し、フロアを作成しなおし、オートマッピング処理を行います。
		その後そのタイルへの進入時のイベントを呼び出します。
		
	□戦闘に関すること
		@SET_ENEMY,ARG,ARG:1,ARG:2,ARG:3
		登録番号ARGのキャラクターをARG:1のポジションに敵としてセットします。その際、ARG:2に応じてステータスが強化されます。
		ARG:2が100以上の場合ボス扱いとなり、ＨＰが５倍以上、ＭＰが２倍以上、入手経験値が（５+レベル/10）倍になり、バッドステータスから回復しやすくなり、また一部のバッドステータスを受け付けなくなります。
		また、強化ランク1-99と100-199は計算が分かれています。例として、強化ランク100の敵はボス扱いですが、ＨＰが５倍、ＭＰが２倍になっている以外には能力は強化されません。
		ARG:3に１を入力してセットされた敵は、倒れてもポジションから外されません。

		また、上記の関数で定義された悪魔はキャラクター登録されており、一番登録番号が大きい奴隷になっています。
		なので、(CHARANUM-1)を用いて、追加で能力に変化を加えられます。
		基本能力やＬＶ等の操作に加え、CFLAG:ＨＰ補正/ＭＰ補正を定義すれば、その数値と同じぶんだけ補正を与えられます　
		ただし、これらの操作後にCALL SYNC_STATUS,(CHARANUM-1)、CALL HEALTH_CHARA,(CHARANUM-1)を行なわなければ
		変化が反映されないので注意してください。
		CFLAG:速度補正、CFLAG:行動回数、速さの補正と行動回数の補正です。強さを調整するのにどうぞ
		ちなみに、複数行動する場合、行動するたび速度にマイナス補正がかかるので覚えておいてもいいかもしれません
		CSTR:思考パターン、@SET_ACTION_CFLAG:思考パターン,キャラ番号(普通はARG)において、定義されたAIに従って行動するようになります。
		具体的には…@SET_ACTION_あたりでGREPしてみるといいでしょう。
		なお、思考パターンフラグの値は基本的にキャラ番号と同じ番号を用いてるのでそれに従うといいでしょう。
		

	□戦闘中のイベントについて
		戦闘開始時、ターン終了時、誰かの行動終了時にそれぞれイベントを呼び出すことが出来ます。
		@EVENT_BATTLE_START{ダンジョン番号}、@EVENT_BATTLE_TURNEND{ダンジョン番号}、@EVENT_BATTLE_ACTEND{ダンジョン番号}の三つです。
		これらの関数を作成しておくと、そのダンジョンの探索時にそれぞれのタイミングでメッセージを表示させたり出来ます。
		関数内で何の条件も付けずに処理を行わせると、全ての雑魚戦ですら発生するようになってしまうので、戦闘開始前にフラグを立て、そのフラグを条件に発生させるようにすると良いでしょう。
		また、@EVENT_BATTLE_ACTEND{ダンジョン番号}内でRETURN -1 するとターンを強制的に終わらせます。戦闘中に段階変身するボスとか良いかもしれません。
		@EVENT_BATTLE_TURNEND{ダンジョン番号}、@EVENT_BATTLE_ACTEND{ダンジョン番号}内で勝敗フラグを弄くれば、特殊な勝利/敗北条件を設定できるでしょう。


□ダンジョンメーカーについて
	デバッグモードをONにして、探索を選ぶとダンジョンメーカーを選択できます。
	ダンジョンメーカーはダンジョンのMAPをEmuera上で作成し、またその作成したMAPをERBに記述できる形に出力するものです。
	ERBに直接記述していくより、楽に、バグが少なく作成出来ると思うので、これでアウトラインを作ってから、細かい点を書き加えていくといいかも知れません。
	詳しい仕様はreadme集のダンジョンメーカーフォルダを参照してください。
